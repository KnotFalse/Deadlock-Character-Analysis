var xu=Object.defineProperty;var Eo=r=>{throw TypeError(r)};var Su=(r,e,t)=>e in r?xu(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var st=(r,e,t)=>Su(r,typeof e!="symbol"?e+"":e,t),Vn=(r,e,t)=>e.has(r)||Eo("Cannot "+t);var $=(r,e,t)=>(Vn(r,e,"read from private field"),t?t.call(r):e.get(r)),we=(r,e,t)=>e.has(r)?Eo("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),ut=(r,e,t,n)=>(Vn(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),ze=(r,e,t)=>(Vn(r,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();const Tu="5";var ya;typeof window<"u"&&((ya=window.__svelte??(window.__svelte={})).v??(ya.v=new Set)).add(Tu);let fr=!1,Cu=!1;function Ru(){fr=!0}Ru();const Dn=1,Ln=2,ba=4,ku=8,Du=16,Lu=2,Nu=4,Fu=8,Gu=1,Iu=2,pe=Symbol(),Mu="http://www.w3.org/1999/xhtml",_a=!1;var Ui=Array.isArray,Pu=Array.prototype.indexOf,wa=Array.from,Ea=Object.defineProperty,ln=Object.getOwnPropertyDescriptor,Aa=Object.getOwnPropertyDescriptors,$u=Object.prototype,Ou=Array.prototype,Bi=Object.getPrototypeOf;const St=()=>{};function Uu(r){return r()}function dn(r){for(var e=0;e<r.length;e++)r[e]()}function xa(){var r,e,t=new Promise((n,i)=>{r=n,e=i});return{promise:t,resolve:r,reject:e}}function Ao(r,e){if(Array.isArray(r))return r;if(!(Symbol.iterator in r))return Array.from(r);const t=[];for(const n of r)if(t.push(n),t.length===e)break;return t}const me=2,zi=4,Nn=8,pt=16,vt=32,gr=64,Hi=128,ce=1024,Le=2048,at=4096,Ie=8192,ct=16384,ji=32768,$r=65536,xo=1<<17,Bu=1<<18,Fn=1<<19,Sa=1<<20,$e=256,fn=512,gn=32768,ci=1<<21,Wi=1<<22,Pt=1<<23,dt=Symbol("$state"),zu=Symbol("legacy props"),Hu=Symbol(""),qt=new class extends Error{constructor(){super(...arguments);st(this,"name","StaleReactionError");st(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Ta(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function ju(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Wu(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Vu(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ku(r){throw new Error("https://svelte.dev/e/effect_orphan")}function Yu(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function qu(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function Xu(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Zu(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ju(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Qu(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let el=!1;function Ca(r){return r===this.v}function Ra(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function ka(r){return!Ra(r,this.v)}let ie=null;function pn(r){ie=r}function pr(r,e=!1,t){ie={p:ie,i:!1,c:null,e:null,s:r,x:null,l:fr&&!e?{s:null,u:null,$:[]}:null}}function vr(r){var e=ie,t=e.e;if(t!==null){e.e=null;for(var n of t)Ha(n)}return e.i=!0,ie=e.p,{}}function mr(){return!fr||ie!==null&&ie.l===null}let Gt=[];function Da(){var r=Gt;Gt=[],dn(r)}function Gn(r){if(Gt.length===0&&!Gr){var e=Gt;queueMicrotask(()=>{e===Gt&&Da()})}Gt.push(r)}function tl(){for(;Gt.length>0;)Da()}function rl(r){var e=W;if(e===null)return H.f|=Pt,r;if(e.f&ji)vn(r,e);else{if(!(e.f&Hi))throw r;e.b.error(r)}}function vn(r,e){for(;e!==null;){if(e.f&Hi)try{e.b.error(r);return}catch(t){r=t}e=e.parent}throw r}const en=new Set;let V=null,Fr=null,le=null,So=new Set,Qe=[],In=null,di=!1,Gr=!1;var tr,rr,It,Mt,zr,nr,ir,ve,fi,Nt,La,Na;const Rn=class Rn{constructor(){we(this,ve);st(this,"committed",!1);st(this,"current",new Map);st(this,"previous",new Map);we(this,tr,new Set);we(this,rr,new Set);we(this,It,0);we(this,Mt,0);we(this,zr,null);we(this,nr,[]);we(this,ir,[]);st(this,"skipped_effects",new Set);st(this,"is_fork",!1)}process(e){Qe=[],Fr=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const n of e)ze(this,ve,fi).call(this,n,t);this.is_fork||ze(this,ve,La).call(this),$(this,Mt)>0||this.is_fork?(ze(this,ve,Nt).call(this,t.effects),ze(this,ve,Nt).call(this,t.render_effects),ze(this,ve,Nt).call(this,t.block_effects)):(Fr=this,V=null,To(t.render_effects),To(t.effects),Fr=null),le=null}capture(e,t){this.previous.has(e)||this.previous.set(e,t),this.current.set(e,e.v),le==null||le.set(e,e.v)}activate(){V=this}deactivate(){V=null,le=null}flush(){if(this.activate(),Qe.length>0){if(Fa(),V!==null&&V!==this)return}else $(this,It)===0&&this.process([]);this.deactivate();for(const e of So)if(So.delete(e),e(),V!==null)break}discard(){for(const e of $(this,rr))e(this);$(this,rr).clear()}increment(e){ut(this,It,$(this,It)+1),e&&ut(this,Mt,$(this,Mt)+1)}decrement(e){ut(this,It,$(this,It)-1),e&&ut(this,Mt,$(this,Mt)-1),this.revive()}revive(){for(const e of $(this,nr))de(e,Le),zt(e);for(const e of $(this,ir))de(e,at),zt(e);ut(this,nr,[]),ut(this,ir,[]),this.flush()}oncommit(e){$(this,tr).add(e)}ondiscard(e){$(this,rr).add(e)}settled(){return($(this,zr)??ut(this,zr,xa())).promise}static ensure(){if(V===null){const e=V=new Rn;en.add(V),Gr||Rn.enqueue(()=>{V===e&&e.flush()})}return V}static enqueue(e){Gn(e)}apply(){}};tr=new WeakMap,rr=new WeakMap,It=new WeakMap,Mt=new WeakMap,zr=new WeakMap,nr=new WeakMap,ir=new WeakMap,ve=new WeakSet,fi=function(e,t){var h;e.f^=ce;for(var n=e.first;n!==null;){var i=n.f,o=(i&(vt|gr))!==0,a=o&&(i&ce)!==0,s=a||(i&Ie)!==0||this.skipped_effects.has(n);if(n.f&Hi&&((h=n.b)!=null&&h.is_pending())&&(t={parent:t,effect:n,effects:[],render_effects:[],block_effects:[]}),!s&&n.fn!==null){o?n.f^=ce:i&zi?t.effects.push(n):yr(n)&&(n.f&pt&&t.block_effects.push(n),ar(n));var u=n.first;if(u!==null){n=u;continue}}var l=n.parent;for(n=n.next;n===null&&l!==null;)l===t.effect&&(ze(this,ve,Nt).call(this,t.effects),ze(this,ve,Nt).call(this,t.render_effects),ze(this,ve,Nt).call(this,t.block_effects),t=t.parent),n=l.next,l=l.parent}},Nt=function(e){for(const t of e)(t.f&Le?$(this,nr):$(this,ir)).push(t),de(t,ce)},La=function(){if($(this,Mt)===0){for(const e of $(this,tr))e();$(this,tr).clear()}$(this,It)===0&&ze(this,ve,Na).call(this)},Na=function(){var i,o;if(en.size>1){this.previous.clear();var e=le,t=!0,n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const a of en){if(a===this){t=!1;continue}const s=[];for(const[l,h]of this.current){if(a.current.has(l))if(t&&h!==a.current.get(l))a.current.set(l,h);else continue;s.push(l)}if(s.length===0)continue;const u=[...a.current.keys()].filter(l=>!this.current.has(l));if(u.length>0){const l=new Set,h=new Map;for(const c of s)Ga(c,u,l,h);if(Qe.length>0){V=a,a.apply();for(const c of Qe)ze(i=a,ve,fi).call(i,c,n);Qe=[],a.deactivate()}}}V=null,le=e}this.committed=!0,en.delete(this),(o=$(this,zr))==null||o.resolve()};let mn=Rn;function nl(r){var e=Gr;Gr=!0;try{for(var t;;){if(tl(),Qe.length===0&&(V==null||V.flush(),Qe.length===0))return In=null,t;Fa()}}finally{Gr=e}}function Fa(){var r=Zt;di=!0;try{var e=0;for(Do(!0);Qe.length>0;){var t=mn.ensure();if(e++>1e3){var n,i;il()}t.process(Qe),Tt.clear()}}finally{di=!1,Do(r),In=null}}function il(){try{Yu()}catch(r){vn(r,In)}}let je=null;function To(r){var e=r.length;if(e!==0){for(var t=0;t<e;){var n=r[t++];if(!(n.f&(ct|Ie))&&yr(n)&&(je=new Set,ar(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?Ya(n):n.fn=null),(je==null?void 0:je.size)>0)){Tt.clear();for(const i of je){if(i.f&(ct|Ie))continue;const o=[i];let a=i.parent;for(;a!==null;)je.has(a)&&(je.delete(a),o.push(a)),a=a.parent;for(let s=o.length-1;s>=0;s--){const u=o[s];u.f&(ct|Ie)||ar(u)}}je.clear()}}je=null}}function Ga(r,e,t,n){if(!t.has(r)&&(t.add(r),r.reactions!==null))for(const i of r.reactions){const o=i.f;o&me?Ga(i,e,t,n):o&(Wi|pt)&&!(o&Le)&&Ia(i,e,n)&&(de(i,Le),zt(i))}}function Ia(r,e,t){const n=t.get(r);if(n!==void 0)return n;if(r.deps!==null)for(const i of r.deps){if(e.includes(i))return!0;if(i.f&me&&Ia(i,e,t))return t.set(i,!0),!0}return t.set(r,!1),!1}function zt(r){for(var e=In=r;e.parent!==null;){e=e.parent;var t=e.f;if(di&&e===W&&t&pt)return;if(t&(gr|vt)){if(!(t&ce))return;e.f^=ce}}Qe.push(e)}function ol(r,e,t){const n=mr()?Mn:Vi;if(e.length===0){t(r.map(n));return}var i=V,o=W,a=al();Promise.all(e.map(s=>sl(s))).then(s=>{a();try{t([...r.map(n),...s])}catch(u){o.f&ct||vn(u,o)}i==null||i.deactivate(),gi()}).catch(s=>{vn(s,o)})}function al(){var r=W,e=H,t=ie,n=V;return function(){Ct(r),it(e),pn(t),n==null||n.activate()}}function gi(){Ct(null),it(null),pn(null)}function Mn(r){var e=me|Le,t=H!==null&&H.f&me?H:null;return W===null||t!==null&&t.f&$e?e|=$e:W.f|=Fn,{ctx:ie,deps:null,effects:null,equals:Ca,f:e,fn:r,reactions:null,rv:0,v:pe,wv:0,parent:t??W,ac:null}}function sl(r,e){let t=W;t===null&&ju();var n=t.b,i=void 0,o=Or(pe),a=!H,s=new Map;return yl(()=>{var d;var u=xa();i=u.promise;try{Promise.resolve(r()).then(u.resolve,u.reject).then(()=>{l===V&&l.committed&&l.deactivate(),gi()})}catch(f){u.reject(f),gi()}var l=V;if(a){var h=!n.is_pending();n.update_pending_count(1),l.increment(h),(d=s.get(l))==null||d.reject(qt),s.delete(l),s.set(l,u)}const c=(f,g=void 0)=>{if(l.activate(),g)g!==qt&&(o.f|=Pt,or(o,g));else{o.f&Pt&&(o.f^=Pt),or(o,f);for(const[p,v]of s){if(s.delete(p),p===l)break;v.reject(qt)}}a&&(n.update_pending_count(-1),l.decrement(h))};u.promise.then(c,f=>c(null,f||"unknown"))}),$n(()=>{for(const u of s.values())u.reject(qt)}),new Promise(u=>{function l(h){function c(){h===i?u(o):l(i)}h.then(c,c)}l(i)})}function Co(r){const e=Mn(r);return Ja(e),e}function Vi(r){const e=Mn(r);return e.equals=ka,e}function Ma(r){var e=r.effects;if(e!==null){r.effects=null;for(var t=0;t<e.length;t+=1)rt(e[t])}}function ul(r){for(var e=r.parent;e!==null;){if(!(e.f&me))return e;e=e.parent}return null}function Ki(r){var e,t=W;Ct(ul(r));try{r.f&=~gn,Ma(r),e=rs(r)}finally{Ct(t)}return e}function Pa(r){var e=Ki(r);if(r.equals(e)||(r.v=e,r.wv=es()),!jt)if(le!==null)le.set(r,r.v);else{var t=(xt||r.f&$e)&&r.deps!==null?at:ce;de(r,t)}}let pi=new Set;const Tt=new Map;let $a=!1;function Or(r,e){var t={f:0,v:r,reactions:null,equals:Ca,rv:0,wv:0};return t}function _t(r,e){const t=Or(r);return Ja(t),t}function $t(r,e=!1,t=!0){var i;const n=Or(r);return e||(n.equals=ka),fr&&t&&ie!==null&&ie.l!==null&&((i=ie.l).s??(i.s=[])).push(n),n}function Ae(r,e,t=!1){H!==null&&(!et||H.f&xo)&&mr()&&H.f&(me|pt|Wi|xo)&&!(Ce!=null&&Ce.includes(r))&&Ju();let n=t?Xt(e):e;return or(r,n)}function or(r,e){if(!r.equals(e)){var t=r.v;jt?Tt.set(r,e):Tt.set(r,t),r.v=e;var n=mn.ensure();n.capture(r,t),r.f&me&&(r.f&Le&&Ki(r),de(r,r.f&$e?at:ce)),r.wv=es(),Oa(r,Le),mr()&&W!==null&&W.f&ce&&!(W.f&(vt|gr))&&(Pe===null?Al([r]):Pe.push(r)),!n.is_fork&&pi.size>0&&!$a&&ll()}return e}function ll(){$a=!1;const r=Array.from(pi);for(const e of r)e.f&ce&&de(e,at),yr(e)&&ar(e);pi.clear()}function Kn(r){Ae(r,r.v+1)}function Oa(r,e){var t=r.reactions;if(t!==null)for(var n=mr(),i=t.length,o=0;o<i;o++){var a=t[o],s=a.f;if(!(!n&&a===W)){var u=(s&Le)===0;u&&de(a,e),s&me?s&gn||(a.f|=gn,Oa(a,at)):u&&(s&pt&&je!==null&&je.add(a),zt(a))}}}function Xt(r){if(typeof r!="object"||r===null||dt in r)return r;const e=Bi(r);if(e!==$u&&e!==Ou)return r;var t=new Map,n=Ui(r),i=_t(0),o=Ot,a=s=>{if(Ot===o)return s();var u=H,l=Ot;it(null),No(o);var h=s();return it(u),No(l),h};return n&&t.set("length",_t(r.length)),new Proxy(r,{defineProperty(s,u,l){(!("value"in l)||l.configurable===!1||l.enumerable===!1||l.writable===!1)&&Xu();var h=t.get(u);return h===void 0?h=a(()=>{var c=_t(l.value);return t.set(u,c),c}):Ae(h,l.value,!0),!0},deleteProperty(s,u){var l=t.get(u);if(l===void 0){if(u in s){const h=a(()=>_t(pe));t.set(u,h),Kn(i)}}else Ae(l,pe),Kn(i);return!0},get(s,u,l){var f;if(u===dt)return r;var h=t.get(u),c=u in s;if(h===void 0&&(!c||(f=ln(s,u))!=null&&f.writable)&&(h=a(()=>{var g=Xt(c?s[u]:pe),p=_t(g);return p}),t.set(u,h)),h!==void 0){var d=x(h);return d===pe?void 0:d}return Reflect.get(s,u,l)},getOwnPropertyDescriptor(s,u){var l=Reflect.getOwnPropertyDescriptor(s,u);if(l&&"value"in l){var h=t.get(u);h&&(l.value=x(h))}else if(l===void 0){var c=t.get(u),d=c==null?void 0:c.v;if(c!==void 0&&d!==pe)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return l},has(s,u){var d;if(u===dt)return!0;var l=t.get(u),h=l!==void 0&&l.v!==pe||Reflect.has(s,u);if(l!==void 0||W!==null&&(!h||(d=ln(s,u))!=null&&d.writable)){l===void 0&&(l=a(()=>{var f=h?Xt(s[u]):pe,g=_t(f);return g}),t.set(u,l));var c=x(l);if(c===pe)return!1}return h},set(s,u,l,h){var b;var c=t.get(u),d=u in s;if(n&&u==="length")for(var f=l;f<c.v;f+=1){var g=t.get(f+"");g!==void 0?Ae(g,pe):f in s&&(g=a(()=>_t(pe)),t.set(f+"",g))}if(c===void 0)(!d||(b=ln(s,u))!=null&&b.writable)&&(c=a(()=>_t(void 0)),Ae(c,Xt(l)),t.set(u,c));else{d=c.v!==pe;var p=a(()=>Xt(l));Ae(c,p)}var v=Reflect.getOwnPropertyDescriptor(s,u);if(v!=null&&v.set&&v.set.call(h,l),!d){if(n&&typeof u=="string"){var y=t.get("length"),m=Number(u);Number.isInteger(m)&&m>=y.v&&Ae(y,m+1)}Kn(i)}return!0},ownKeys(s){x(i);var u=Reflect.ownKeys(s).filter(c=>{var d=t.get(c);return d===void 0||d.v!==pe});for(var[l,h]of t)h.v!==pe&&!(l in s)&&u.push(l);return u},setPrototypeOf(){Zu()}})}function Ro(r){try{if(r!==null&&typeof r=="object"&&dt in r)return r[dt]}catch{}return r}function hl(r,e){return Object.is(Ro(r),Ro(e))}var cl,dl,fl;function Ur(r=""){return document.createTextNode(r)}function yn(r){return dl.call(r)}function Wr(r){return fl.call(r)}function F(r,e){return yn(r)}function Et(r,e=!1){{var t=yn(r);return t instanceof Comment&&t.data===""?Wr(t):t}}function M(r,e=1,t=!1){let n=r;for(;e--;)n=Wr(n);return n}function gl(r){r.textContent=""}function Ua(){return!1}let ko=!1;function pl(){ko||(ko=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function Pn(r){var e=H,t=W;it(null),Ct(null);try{return r()}finally{it(e),Ct(t)}}function Ba(r,e,t,n=t){r.addEventListener(e,()=>Pn(t));const i=r.__on_r;i?r.__on_r=()=>{i(),n(!0)}:r.__on_r=()=>n(!0),pl()}function za(r){W===null&&H===null&&Ku(),H!==null&&H.f&$e&&W===null&&Vu(),jt&&Wu()}function vl(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function mt(r,e,t,n=!0){var i=W;i!==null&&i.f&Ie&&(r|=Ie);var o={ctx:ie,deps:null,nodes_start:null,nodes_end:null,f:r|Le,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{ar(o),o.f|=ji}catch(u){throw rt(o),u}else e!==null&&zt(o);if(n){var a=o;if(t&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&!(a.f&Fn)&&(a=a.first,r&pt&&r&$r&&a!==null&&(a.f|=$r)),a!==null&&(a.parent=i,i!==null&&vl(a,i),H!==null&&H.f&me&&!(r&gr))){var s=H;(s.effects??(s.effects=[])).push(a)}}return o}function $n(r){const e=mt(Nn,null,!1);return de(e,ce),e.teardown=r,e}function vi(r){za();var e=W.f,t=!H&&(e&vt)!==0&&(e&ji)===0;if(t){var n=ie;(n.e??(n.e=[])).push(r)}else return Ha(r)}function Ha(r){return mt(zi|Sa,r,!1)}function ml(r){return za(),mt(Nn|Sa,r,!0)}function ja(r){return mt(zi,r,!1)}function mi(r,e){var t=ie,n={effect:null,ran:!1,deps:r};t.l.$.push(n),n.effect=On(()=>{r(),!n.ran&&(n.ran=!0,Ye(e))})}function Wa(){var r=ie;On(()=>{for(var e of r.l.$){e.deps();var t=e.effect;t.f&ce&&de(t,at),yr(t)&&ar(t),e.ran=!1}})}function yl(r){return mt(Wi|Fn,r,!0)}function On(r,e=0){return mt(Nn|e,r,!0)}function te(r,e=[],t=[]){ol(e,t,n=>{mt(Nn,()=>r(...n.map(x)),!0)})}function Yi(r,e=0){var t=mt(pt|e,r,!0);return t}function bn(r,e=!0){return mt(vt|Fn,r,!0,e)}function Va(r){var e=r.teardown;if(e!==null){const t=jt,n=H;Lo(!0),it(null);try{e.call(null)}finally{Lo(t),it(n)}}}function Ka(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){const i=t.ac;i!==null&&Pn(()=>{i.abort(qt)});var n=t.next;t.f&gr?t.parent=null:rt(t,e),t=n}}function bl(r){for(var e=r.first;e!==null;){var t=e.next;e.f&vt||rt(e),e=t}}function rt(r,e=!0){var t=!1;(e||r.f&Bu)&&r.nodes_start!==null&&r.nodes_end!==null&&(_l(r.nodes_start,r.nodes_end),t=!0),Ka(r,e&&!t),_n(r,0),de(r,ct);var n=r.transitions;if(n!==null)for(const o of n)o.stop();Va(r);var i=r.parent;i!==null&&i.first!==null&&Ya(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=r.ac=null}function _l(r,e){for(;r!==null;){var t=r===e?null:Wr(r);r.remove(),r=t}}function Ya(r){var e=r.parent,t=r.prev,n=r.next;t!==null&&(t.next=n),n!==null&&(n.prev=t),e!==null&&(e.first===r&&(e.first=n),e.last===r&&(e.last=t))}function qa(r,e,t=!0){var n=[];qi(r,n,!0),Xa(n,()=>{t&&rt(r),e&&e()})}function Xa(r,e){var t=r.length;if(t>0){var n=()=>--t||e();for(var i of r)i.out(n)}else e()}function qi(r,e,t){if(!(r.f&Ie)){if(r.f^=Ie,r.transitions!==null)for(const a of r.transitions)(a.is_global||t)&&e.push(a);for(var n=r.first;n!==null;){var i=n.next,o=(n.f&$r)!==0||(n.f&vt)!==0&&(r.f&pt)!==0;qi(n,e,o?t:!1),n=i}}}function Xi(r){Za(r,!0)}function Za(r,e){if(r.f&Ie){r.f^=Ie,r.f&ce||(de(r,Le),zt(r));for(var t=r.first;t!==null;){var n=t.next,i=(t.f&$r)!==0||(t.f&vt)!==0;Za(t,i?e:!1),t=n}if(r.transitions!==null)for(const o of r.transitions)(o.is_global||e)&&o.in()}}function wl(r,e){for(var t=r.nodes_start,n=r.nodes_end;t!==null;){var i=t===n?null:Wr(t);e.append(t),t=i}}let At=null;function El(r){var e=At;try{if(At=new Set,Ye(r),e!==null)for(var t of At)e.add(t);return At}finally{At=e}}function yi(r){for(var e of El(r))or(e,e.v)}let Zt=!1;function Do(r){Zt=r}let jt=!1;function Lo(r){jt=r}let H=null,et=!1;function it(r){H=r}let W=null;function Ct(r){W=r}let Ce=null;function Ja(r){H!==null&&(Ce===null?Ce=[r]:Ce.push(r))}let Ee=null,Ne=0,Pe=null;function Al(r){Pe=r}let Qa=1,Br=0,Ot=Br;function No(r){Ot=r}let xt=!1;function es(){return++Qa}function yr(r){var c;var e=r.f;if(e&Le)return!0;if(e&at){var t=r.deps,n=(e&$e)!==0;if(e&me&&(r.f&=~gn),t!==null){var i,o,a=(e&fn)!==0,s=n&&W!==null&&!xt,u=t.length;if((a||s)&&(W===null||!(W.f&ct))){var l=r,h=l.parent;for(i=0;i<u;i++)o=t[i],(a||!((c=o==null?void 0:o.reactions)!=null&&c.includes(l)))&&(o.reactions??(o.reactions=[])).push(l);a&&(l.f^=fn),s&&h!==null&&!(h.f&$e)&&(l.f^=$e)}for(i=0;i<u;i++)if(o=t[i],yr(o)&&Pa(o),o.wv>r.wv)return!0}(!n||W!==null&&!xt)&&de(r,ce)}return!1}function ts(r,e,t=!0){var n=r.reactions;if(n!==null&&!(Ce!=null&&Ce.includes(r)))for(var i=0;i<n.length;i++){var o=n[i];o.f&me?ts(o,e,!1):e===o&&(t?de(o,Le):o.f&ce&&de(o,at),zt(o))}}function rs(r){var p;var e=Ee,t=Ne,n=Pe,i=H,o=xt,a=Ce,s=ie,u=et,l=Ot,h=r.f;Ee=null,Ne=0,Pe=null,xt=(h&$e)!==0&&(et||!Zt||H===null),H=h&(vt|gr)?null:r,Ce=null,pn(r.ctx),et=!1,Ot=++Br,r.ac!==null&&(Pn(()=>{r.ac.abort(qt)}),r.ac=null);try{r.f|=ci;var c=r.fn,d=c(),f=r.deps;if(Ee!==null){var g;if(_n(r,Ne),f!==null&&Ne>0)for(f.length=Ne+Ee.length,g=0;g<Ee.length;g++)f[Ne+g]=Ee[g];else r.deps=f=Ee;if(!xt||h&me&&r.reactions!==null)for(g=Ne;g<f.length;g++)((p=f[g]).reactions??(p.reactions=[])).push(r)}else f!==null&&Ne<f.length&&(_n(r,Ne),f.length=Ne);if(mr()&&Pe!==null&&!et&&f!==null&&!(r.f&(me|at|Le)))for(g=0;g<Pe.length;g++)ts(Pe[g],r);return i!==null&&i!==r&&(Br++,Pe!==null&&(n===null?n=Pe:n.push(...Pe))),r.f&Pt&&(r.f^=Pt),d}catch(v){return rl(v)}finally{r.f^=ci,Ee=e,Ne=t,Pe=n,H=i,xt=o,Ce=a,pn(s),et=u,Ot=l}}function xl(r,e){let t=e.reactions;if(t!==null){var n=Pu.call(t,r);if(n!==-1){var i=t.length-1;i===0?t=e.reactions=null:(t[n]=t[i],t.pop())}}t===null&&e.f&me&&(Ee===null||!Ee.includes(e))&&(de(e,at),e.f&($e|fn)||(e.f^=fn),Ma(e),_n(e,0))}function _n(r,e){var t=r.deps;if(t!==null)for(var n=e;n<t.length;n++)xl(r,t[n])}function ar(r){var e=r.f;if(!(e&ct)){de(r,ce);var t=W,n=Zt;W=r,Zt=!0;try{e&pt?bl(r):Ka(r),Va(r);var i=rs(r);r.teardown=typeof i=="function"?i:null,r.wv=Qa;var o;_a&&Cu&&r.f&Le&&r.deps}finally{Zt=n,W=t}}}async function Sl(){await Promise.resolve(),nl()}function x(r){var e=r.f,t=(e&me)!==0;if(At==null||At.add(r),H!==null&&!et){var n=W!==null&&(W.f&ct)!==0;if(!n&&!(Ce!=null&&Ce.includes(r))){var i=H.deps;if(H.f&ci)r.rv<Br&&(r.rv=Br,Ee===null&&i!==null&&i[Ne]===r?Ne++:Ee===null?Ee=[r]:(!xt||!Ee.includes(r))&&Ee.push(r));else{(H.deps??(H.deps=[])).push(r);var o=r.reactions;o===null?r.reactions=[H]:o.includes(H)||o.push(H)}}}else if(t&&r.deps===null&&r.effects===null){var a=r,s=a.parent;s!==null&&!(s.f&$e)&&(a.f^=$e)}if(jt){if(Tt.has(r))return Tt.get(r);if(t){a=r;var u=a.v;return(!(a.f&ce)&&a.reactions!==null||ns(a))&&(u=Ki(a)),Tt.set(a,u),u}}else if(t){if(a=r,le!=null&&le.has(a))return le.get(a);yr(a)&&Pa(a)}if(le!=null&&le.has(r))return le.get(r);if(r.f&Pt)throw r.v;return r.v}function ns(r){if(r.v===pe)return!0;if(r.deps===null)return!1;for(const e of r.deps)if(Tt.has(e)||e.f&me&&ns(e))return!0;return!1}function Ye(r){var e=et;try{return et=!0,r()}finally{et=e}}const Tl=-7169;function de(r,e){r.f=r.f&Tl|e}function is(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(dt in r)bi(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&dt in t&&bi(t)}}}function bi(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let n in r)try{bi(r[n],e)}catch{}const t=Bi(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const n=Aa(t);for(let i in n){const o=n[i].get;if(o)try{o.call(r)}catch{}}}}}function Cl(r,e,t,n={}){function i(o){if(n.capture||Rl.call(e,o),!o.cancelBubble)return Pn(()=>t==null?void 0:t.call(this,o))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?Gn(()=>{e.addEventListener(r,i,n)}):e.addEventListener(r,i,n),i}function xe(r,e,t,n,i){var o={capture:n,passive:i},a=Cl(r,e,t,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&$n(()=>{e.removeEventListener(r,a,o)})}let Fo=null;function Rl(r){var v;var e=this,t=e.ownerDocument,n=r.type,i=((v=r.composedPath)==null?void 0:v.call(r))||[],o=i[0]||r.target;Fo=r;var a=0,s=Fo===r&&r.__root;if(s){var u=i.indexOf(s);if(u!==-1&&(e===document||e===window)){r.__root=e;return}var l=i.indexOf(e);if(l===-1)return;u<=l&&(a=u)}if(o=i[a]||r.target,o!==e){Ea(r,"currentTarget",{configurable:!0,get(){return o||t}});var h=H,c=W;it(null),Ct(null);try{for(var d,f=[];o!==null;){var g=o.assignedSlot||o.parentNode||o.host||null;try{var p=o["__"+n];p!=null&&(!o.disabled||r.target===o)&&p.call(o,r)}catch(y){d?f.push(y):d=y}if(r.cancelBubble||g===e||g===null)break;o=g}if(d){for(let y of f)queueMicrotask(()=>{throw y});throw d}}finally{r.__root=e,delete r.currentTarget,it(h),Ct(c)}}}function kl(r){var e=document.createElement("template");return e.innerHTML=r.replaceAll("<!>","<!---->"),e.content}function _i(r,e){var t=W;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function X(r,e){var t=(e&Gu)!==0,n=(e&Iu)!==0,i,o=!r.startsWith("<!>");return()=>{i===void 0&&(i=kl(o?r:"<!>"+r),t||(i=yn(i)));var a=n||cl?document.importNode(i,!0):i.cloneNode(!0);if(t){var s=yn(a),u=a.lastChild;_i(s,u)}else _i(a,a);return a}}function Yt(){var r=document.createDocumentFragment(),e=document.createComment(""),t=Ur();return r.append(e,t),_i(e,t),r}function z(r,e){r!==null&&r.before(e)}function ee(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=t,r.nodeValue=t+"")}var Ve,Je,Fe,Hr,jr,kn;class os{constructor(e,t=!0){st(this,"anchor");we(this,Ve,new Map);we(this,Je,new Map);we(this,Fe,new Map);we(this,Hr,!0);we(this,jr,()=>{var e=V;if($(this,Ve).has(e)){var t=$(this,Ve).get(e),n=$(this,Je).get(t);if(n)Xi(n);else{var i=$(this,Fe).get(t);i&&($(this,Je).set(t,i.effect),$(this,Fe).delete(t),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),n=i.effect)}for(const[o,a]of $(this,Ve)){if($(this,Ve).delete(o),o===e)break;const s=$(this,Fe).get(a);s&&(rt(s.effect),$(this,Fe).delete(a))}for(const[o,a]of $(this,Je)){if(o===t)continue;const s=()=>{if(Array.from($(this,Ve).values()).includes(o)){var l=document.createDocumentFragment();wl(a,l),l.append(Ur()),$(this,Fe).set(o,{effect:a,fragment:l})}else rt(a);$(this,Je).delete(o)};$(this,Hr)||!n?qa(a,s,!1):s()}}});we(this,kn,e=>{$(this,Ve).delete(e);const t=Array.from($(this,Ve).values());for(const[n,i]of $(this,Fe))t.includes(n)||(rt(i.effect),$(this,Fe).delete(n))});this.anchor=e,ut(this,Hr,t)}ensure(e,t){var n=V,i=Ua();if(t&&!$(this,Je).has(e)&&!$(this,Fe).has(e))if(i){var o=document.createDocumentFragment(),a=Ur();o.append(a),$(this,Fe).set(e,{effect:bn(()=>t(a)),fragment:o})}else $(this,Je).set(e,bn(()=>t(this.anchor)));if($(this,Ve).set(n,e),i){for(const[s,u]of $(this,Je))s===e?n.skipped_effects.delete(u):n.skipped_effects.add(u);for(const[s,u]of $(this,Fe))s===e?n.skipped_effects.delete(u.effect):n.skipped_effects.add(u.effect);n.oncommit($(this,jr)),n.ondiscard($(this,kn))}else $(this,jr).call(this)}}Ve=new WeakMap,Je=new WeakMap,Fe=new WeakMap,Hr=new WeakMap,jr=new WeakMap,kn=new WeakMap;function Zi(r){ie===null&&Ta(),fr&&ie.l!==null?Ll(ie).m.push(r):vi(()=>{const e=Ye(r);if(typeof e=="function")return e})}function Dl(r){ie===null&&Ta(),Zi(()=>()=>Ye(r))}function Ll(r){var e=r.l;return e.u??(e.u={a:[],b:[],m:[]})}function Ze(r,e,t=!1){var n=new os(r),i=t?$r:0;function o(a,s){n.ensure(a,s)}Yi(()=>{var a=!1;e((s,u=!0)=>{a=!0,o(u,s)}),a||o(!1,null)},i)}function Nl(r,e,t){var n=new os(r),i=!mr();Yi(()=>{var o=e();i&&o!==null&&typeof o=="object"&&(o={}),n.ensure(o,t)})}function Se(r,e){return e}function Fl(r,e,t){for(var n=r.items,i=[],o=e.length,a=0;a<o;a++)qi(e[a].e,i,!0);var s=o>0&&i.length===0&&t!==null;if(s){var u=t.parentNode;gl(u),u.append(t),n.clear(),Xe(r,e[0].prev,e[o-1].next)}Xa(i,()=>{for(var l=0;l<o;l++){var h=e[l];s||(n.delete(h.k),Xe(r,h.prev,h.next)),rt(h.e,!s)}})}function Te(r,e,t,n,i,o=null){var a=r,s={flags:e,items:new Map,first:null},u=(e&ba)!==0;if(u){var l=r;a=l.appendChild(Ur())}var h=null,c=!1,d=new Map,f=Vi(()=>{var y=t();return Ui(y)?y:y==null?[]:wa(y)}),g,p;function v(){Gl(p,g,s,d,a,i,e,n,t),o!==null&&(g.length===0?h?Xi(h):h=bn(()=>o(a)):h!==null&&qa(h,()=>{h=null}))}Yi(()=>{p??(p=W),g=x(f);var y=g.length;if(!(c&&y===0)){c=y===0;var m,b,_,T;if(Ua()){var A=new Set,E=V;for(b=0;b<y;b+=1){_=g[b],T=n(_,b);var G=s.items.get(T)??d.get(T);G?e&(Dn|Ln)&&as(G,_,b,e):(m=ss(null,s,null,null,_,T,b,i,e,t,!0),d.set(T,m)),A.add(T)}for(const[R,I]of s.items)A.has(R)||E.skipped_effects.add(I.e);E.oncommit(v)}else v();x(f)}})}function Gl(r,e,t,n,i,o,a,s,u){var J,Q,ne,ge;var l=(a&ku)!==0,h=(a&(Dn|Ln))!==0,c=e.length,d=t.items,f=t.first,g=f,p,v=null,y,m=[],b=[],_,T,A,E;if(l)for(E=0;E<c;E+=1)_=e[E],T=s(_,E),A=d.get(T),A!==void 0&&((J=A.a)==null||J.measure(),(y??(y=new Set)).add(A));for(E=0;E<c;E+=1){if(_=e[E],T=s(_,E),A=d.get(T),A===void 0){var G=n.get(T);if(G!==void 0){n.delete(T),d.set(T,G);var R=v?v.next:g;Xe(t,v,G),Xe(t,G,R),Yn(G,R,i),v=G}else{var I=g?g.e.nodes_start:i;v=ss(I,t,v,v===null?t.first:v.next,_,T,E,o,a,u)}d.set(T,v),m=[],b=[],g=v.next;continue}if(h&&as(A,_,E,a),A.e.f&Ie&&(Xi(A.e),l&&((Q=A.a)==null||Q.unfix(),(y??(y=new Set)).delete(A))),A!==g){if(p!==void 0&&p.has(A)){if(m.length<b.length){var k=b[0],C;v=k.prev;var U=m[0],N=m[m.length-1];for(C=0;C<m.length;C+=1)Yn(m[C],k,i);for(C=0;C<b.length;C+=1)p.delete(b[C]);Xe(t,U.prev,N.next),Xe(t,v,U),Xe(t,N,k),g=k,v=N,E-=1,m=[],b=[]}else p.delete(A),Yn(A,g,i),Xe(t,A.prev,A.next),Xe(t,A,v===null?t.first:v.next),Xe(t,v,A),v=A;continue}for(m=[],b=[];g!==null&&g.k!==T;)g.e.f&Ie||(p??(p=new Set)).add(g),b.push(g),g=g.next;if(g===null)continue;A=g}m.push(A),v=A,g=A.next}if(g!==null||p!==void 0){for(var B=p===void 0?[]:wa(p);g!==null;)g.e.f&Ie||B.push(g),g=g.next;var j=B.length;if(j>0){var ue=a&ba&&c===0?i:null;if(l){for(E=0;E<j;E+=1)(ne=B[E].a)==null||ne.measure();for(E=0;E<j;E+=1)(ge=B[E].a)==null||ge.fix()}Fl(t,B,ue)}}l&&Gn(()=>{var se;if(y!==void 0)for(A of y)(se=A.a)==null||se.apply()}),r.first=t.first&&t.first.e,r.last=v&&v.e;for(var re of n.values())rt(re.e);n.clear()}function as(r,e,t,n){n&Dn&&or(r.v,e),n&Ln?or(r.i,t):r.i=t}function ss(r,e,t,n,i,o,a,s,u,l,h){var c=(u&Dn)!==0,d=(u&Du)===0,f=c?d?$t(i,!1,!1):Or(i):i,g=u&Ln?Or(a):a,p={i:g,v:f,k:o,a:null,e:null,prev:t,next:n};try{if(r===null){var v=document.createDocumentFragment();v.append(r=Ur())}return p.e=bn(()=>s(r,f,g,l),el),p.e.prev=t&&t.e,p.e.next=n&&n.e,t===null?h||(e.first=p):(t.next=p,t.e.next=p.e),n!==null&&(n.prev=p,n.e.prev=p.e),p}finally{}}function Yn(r,e,t){for(var n=r.next?r.next.e.nodes_start:t,i=e?e.e.nodes_start:t,o=r.e.nodes_start;o!==null&&o!==n;){var a=Wr(o);i.before(o),o=a}}function Xe(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}const Go=[...` 	
\r\f \v\uFEFF`];function Il(r,e,t){var n=r==null?"":""+r;if(t){for(var i in t)if(t[i])n=n?n+" "+i:i;else if(n.length)for(var o=i.length,a=0;(a=n.indexOf(i,a))>=0;){var s=a+o;(a===0||Go.includes(n[a-1]))&&(s===n.length||Go.includes(n[s]))?n=(a===0?"":n.substring(0,a))+n.substring(s+1):a=s}}return n===""?null:n}function us(r,e,t,n,i,o){var a=r.__className;if(a!==t||a===void 0){var s=Il(t,n,o);s==null?r.removeAttribute("class"):r.className=s,r.__className=t}else if(o&&i!==o)for(var u in o){var l=!!o[u];(i==null||l!==!!i[u])&&r.classList.toggle(u,l)}return o}function ls(r,e,t=!1){if(r.multiple){if(e==null)return;if(!Ui(e))return Qu();for(var n of r.options)n.selected=e.includes(Ir(n));return}for(n of r.options){var i=Ir(n);if(hl(i,e)){n.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function Ml(r){var e=new MutationObserver(()=>{ls(r,r.__value)});e.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),$n(()=>{e.disconnect()})}function wi(r,e,t=e){var n=new WeakSet,i=!0;Ba(r,"change",o=>{var a=o?"[selected]":":checked",s;if(r.multiple)s=[].map.call(r.querySelectorAll(a),Ir);else{var u=r.querySelector(a)??r.querySelector("option:not([disabled])");s=u&&Ir(u)}t(s),V!==null&&n.add(V)}),ja(()=>{var o=e();if(r===document.activeElement){var a=Fr??V;if(n.has(a))return}if(ls(r,o,i),i&&o===void 0){var s=r.querySelector(":checked");s!==null&&(o=Ir(s),t(o))}r.__value=o,i=!1}),Ml(r)}function Ir(r){return"__value"in r?r.__value:r.value}const Pl=Symbol("is custom element"),$l=Symbol("is html");function qn(r,e){var t=hs(r);t.checked!==(t.checked=e??void 0)&&(r.checked=e)}function Ei(r,e,t,n){var i=hs(r);i[e]!==(i[e]=t)&&(e==="loading"&&(r[Hu]=t),t==null?r.removeAttribute(e):typeof t!="string"&&Ol(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function hs(r){return r.__attributes??(r.__attributes={[Pl]:r.nodeName.includes("-"),[$l]:r.namespaceURI===Mu})}var Io=new Map;function Ol(r){var e=r.getAttribute("is")||r.nodeName,t=Io.get(e);if(t)return t;Io.set(e,t=[]);for(var n,i=r,o=Element.prototype;o!==i;){n=Aa(i);for(var a in n)n[a].set&&t.push(a);i=Bi(i)}return t}function Ul(r,e,t=e){var n=new WeakSet;Ba(r,"input",async i=>{var o=i?r.defaultValue:r.value;if(o=Xn(r)?Zn(o):o,t(o),V!==null&&n.add(V),await Sl(),o!==(o=e())){var a=r.selectionStart,s=r.selectionEnd,u=r.value.length;if(r.value=o??"",s!==null){var l=r.value.length;a===s&&s===u&&l>u?(r.selectionStart=l,r.selectionEnd=l):(r.selectionStart=a,r.selectionEnd=Math.min(s,l))}}}),Ye(e)==null&&r.value&&(t(Xn(r)?Zn(r.value):r.value),V!==null&&n.add(V)),On(()=>{var i=e();if(r===document.activeElement){var o=Fr??V;if(n.has(o))return}Xn(r)&&i===Zn(r.value)||r.type==="date"&&!i&&!r.value||i!==r.value&&(r.value=i??"")})}function Xn(r){var e=r.type;return e==="number"||e==="range"}function Zn(r){return r===""?null:+r}function Mo(r,e){return r===e||(r==null?void 0:r[dt])===e}function Bl(r={},e,t,n){return ja(()=>{var i,o;return On(()=>{i=o,o=[],Ye(()=>{r!==t(...o)&&(e(r,...o),i&&Mo(t(...i),r)&&e(null,...i))})}),()=>{Gn(()=>{o&&Mo(t(...o),r)&&e(null,...o)})}}),r}function br(r=!1){const e=ie,t=e.l.u;if(!t)return;let n=()=>is(e.s);if(r){let i=0,o={};const a=Mn(()=>{let s=!1;const u=e.s;for(const l in u)u[l]!==o[l]&&(o[l]=u[l],s=!0);return s&&i++,i});n=()=>x(a)}t.b.length&&ml(()=>{Po(e,n),dn(t.b)}),vi(()=>{const i=Ye(()=>t.m.map(Uu));return()=>{for(const o of i)typeof o=="function"&&o()}}),t.a.length&&vi(()=>{Po(e,n),dn(t.a)})}function Po(r,e){if(r.l.s)for(const t of r.l.s)x(t);e()}function Ji(r,e,t){if(r==null)return e(void 0),t&&t(void 0),St;const n=Ye(()=>r.subscribe(e,t));return n.unsubscribe?()=>n.unsubscribe():n}const Vt=[];function zl(r,e){return{subscribe:Re(r,e).subscribe}}function Re(r,e=St){let t=null;const n=new Set;function i(s){if(Ra(r,s)&&(r=s,t)){const u=!Vt.length;for(const l of n)l[1](),Vt.push(l,r);if(u){for(let l=0;l<Vt.length;l+=2)Vt[l][0](Vt[l+1]);Vt.length=0}}}function o(s){i(s(r))}function a(s,u=St){const l=[s,u];return n.add(l),n.size===1&&(t=e(i,o)||St),s(r),()=>{n.delete(l),n.size===0&&t&&(t(),t=null)}}return{set:i,update:o,subscribe:a}}function ke(r,e,t){const n=!Array.isArray(r),i=n?[r]:r;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const o=e.length<2;return zl(t,(a,s)=>{let u=!1;const l=[];let h=0,c=St;const d=()=>{if(h)return;c();const g=e(n?l[0]:l,a,s);o?a(g):c=typeof g=="function"?g:St},f=i.map((g,p)=>Ji(g,v=>{l[p]=v,h&=~(1<<p),u&&d()},()=>{h|=1<<p}));return u=!0,d(),function(){dn(f),c(),u=!1}})}function sr(r){let e;return Ji(r,t=>e=t)(),e}let tn=!1,Ai=Symbol();function K(r,e,t){const n=t[e]??(t[e]={store:null,source:$t(void 0),unsubscribe:St});if(n.store!==r&&!(Ai in t))if(n.unsubscribe(),n.store=r??null,r==null)n.source.v=void 0,n.unsubscribe=St;else{var i=!0;n.unsubscribe=Ji(r,o=>{i?n.source.v=o:Ae(n.source,o)}),i=!1}return r&&Ai in t?sr(r):x(n.source)}function wn(r,e){return r.set(e),e}function _r(){const r={};function e(){$n(()=>{for(var t in r)r[t].unsubscribe();Ea(r,Ai,{enumerable:!1,value:!0})})}return[r,e]}function Hl(r){var e=tn;try{return tn=!1,[r(),tn]}finally{tn=e}}function jl(r,e,t,n){var m;var i=!fr||(t&Lu)!==0,o=(t&Fu)!==0,a=n,s=!0,u=()=>(s&&(s=!1,a=n),a),l;{var h=dt in r||zu in r;l=((m=ln(r,e))==null?void 0:m.set)??(h&&e in r?b=>r[e]=b:void 0)}var c,d=!1;[c,d]=Hl(()=>r[e]),c===void 0&&n!==void 0&&(c=u(),l&&(i&&qu(),l(c)));var f;if(i?f=()=>{var b=r[e];return b===void 0?u():(s=!0,b)}:f=()=>{var b=r[e];return b!==void 0&&(a=void 0),b===void 0?a:b},i&&!(t&Nu))return f;if(l){var g=r.$$legacy;return function(b,_){return arguments.length>0?((!i||!_||g||d)&&l(_?f():b),b):f()}}var p=!1,v=Vi(()=>(p=!1,f()));x(v);var y=W;return function(b,_){if(arguments.length>0){const T=_?x(v):i&&o?Xt(b):b;return Ae(v,T),p=!0,a!==void 0&&(a=T),b}return jt&&p||y.f&ct?v.v:x(v)}}function gt(r){return Array.isArray?Array.isArray(r):fs(r)==="[object Array]"}function Wl(r){if(typeof r=="string")return r;let e=r+"";return e=="0"&&1/r==-1/0?"-0":e}function Vl(r){return r==null?"":Wl(r)}function tt(r){return typeof r=="string"}function cs(r){return typeof r=="number"}function Kl(r){return r===!0||r===!1||Yl(r)&&fs(r)=="[object Boolean]"}function ds(r){return typeof r=="object"}function Yl(r){return ds(r)&&r!==null}function Ge(r){return r!=null}function Jn(r){return!r.trim().length}function fs(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const ql="Incorrect 'index' type",Xl=r=>`Invalid value for key ${r}`,Zl=r=>`Pattern length exceeds max of ${r}.`,Jl=r=>`Missing ${r} property in key`,Ql=r=>`Property 'weight' in key '${r}' must be a positive integer`,$o=Object.prototype.hasOwnProperty;class eh{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(n=>{let i=gs(n);this._keys.push(i),this._keyMap[i.id]=i,t+=i.weight}),this._keys.forEach(n=>{n.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function gs(r){let e=null,t=null,n=null,i=1,o=null;if(tt(r)||gt(r))n=r,e=Oo(r),t=xi(r);else{if(!$o.call(r,"name"))throw new Error(Jl("name"));const a=r.name;if(n=a,$o.call(r,"weight")&&(i=r.weight,i<=0))throw new Error(Ql(a));e=Oo(a),t=xi(a),o=r.getFn}return{path:e,id:t,weight:i,src:n,getFn:o}}function Oo(r){return gt(r)?r:r.split(".")}function xi(r){return gt(r)?r.join("."):r}function th(r,e){let t=[],n=!1;const i=(o,a,s)=>{if(Ge(o))if(!a[s])t.push(o);else{let u=a[s];const l=o[u];if(!Ge(l))return;if(s===a.length-1&&(tt(l)||cs(l)||Kl(l)))t.push(Vl(l));else if(gt(l)){n=!0;for(let h=0,c=l.length;h<c;h+=1)i(l[h],a,s+1)}else a.length&&i(l,a,s+1)}};return i(r,tt(e)?e.split("."):e,0),n?t:t[0]}const rh={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},nh={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(r,e)=>r.score===e.score?r.idx<e.idx?-1:1:r.score<e.score?-1:1},ih={location:0,threshold:.6,distance:100},oh={useExtendedSearch:!1,getFn:th,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var O={...nh,...rh,...ih,...oh};const ah=/[^ ]+/g;function sh(r=1,e=3){const t=new Map,n=Math.pow(10,e);return{get(i){const o=i.match(ah).length;if(t.has(o))return t.get(o);const a=1/Math.pow(o,.5*r),s=parseFloat(Math.round(a*n)/n);return t.set(o,s),s},clear(){t.clear()}}}class Qi{constructor({getFn:e=O.getFn,fieldNormWeight:t=O.fieldNormWeight}={}){this.norm=sh(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((t,n)=>{this._keysMap[t.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,tt(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){const t=this.size();tt(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!Ge(e)||Jn(e))return;let n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}_addObject(e,t){let n={i:t,$:{}};this.keys.forEach((i,o)=>{let a=i.getFn?i.getFn(e):this.getFn(e,i.path);if(Ge(a)){if(gt(a)){let s=[];const u=[{nestedArrIndex:-1,value:a}];for(;u.length;){const{nestedArrIndex:l,value:h}=u.pop();if(Ge(h))if(tt(h)&&!Jn(h)){let c={v:h,i:l,n:this.norm.get(h)};s.push(c)}else gt(h)&&h.forEach((c,d)=>{u.push({nestedArrIndex:d,value:c})})}n.$[o]=s}else if(tt(a)&&!Jn(a)){let s={v:a,n:this.norm.get(a)};n.$[o]=s}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function ps(r,e,{getFn:t=O.getFn,fieldNormWeight:n=O.fieldNormWeight}={}){const i=new Qi({getFn:t,fieldNormWeight:n});return i.setKeys(r.map(gs)),i.setSources(e),i.create(),i}function uh(r,{getFn:e=O.getFn,fieldNormWeight:t=O.fieldNormWeight}={}){const{keys:n,records:i}=r,o=new Qi({getFn:e,fieldNormWeight:t});return o.setKeys(n),o.setIndexRecords(i),o}function rn(r,{errors:e=0,currentLocation:t=0,expectedLocation:n=0,distance:i=O.distance,ignoreLocation:o=O.ignoreLocation}={}){const a=e/r.length;if(o)return a;const s=Math.abs(n-t);return i?a+s/i:s?1:a}function lh(r=[],e=O.minMatchCharLength){let t=[],n=-1,i=-1,o=0;for(let a=r.length;o<a;o+=1){let s=r[o];s&&n===-1?n=o:!s&&n!==-1&&(i=o-1,i-n+1>=e&&t.push([n,i]),n=-1)}return r[o-1]&&o-n>=e&&t.push([n,o-1]),t}const Ft=32;function hh(r,e,t,{location:n=O.location,distance:i=O.distance,threshold:o=O.threshold,findAllMatches:a=O.findAllMatches,minMatchCharLength:s=O.minMatchCharLength,includeMatches:u=O.includeMatches,ignoreLocation:l=O.ignoreLocation}={}){if(e.length>Ft)throw new Error(Zl(Ft));const h=e.length,c=r.length,d=Math.max(0,Math.min(n,c));let f=o,g=d;const p=s>1||u,v=p?Array(c):[];let y;for(;(y=r.indexOf(e,g))>-1;){let E=rn(e,{currentLocation:y,expectedLocation:d,distance:i,ignoreLocation:l});if(f=Math.min(E,f),g=y+h,p){let G=0;for(;G<h;)v[y+G]=1,G+=1}}g=-1;let m=[],b=1,_=h+c;const T=1<<h-1;for(let E=0;E<h;E+=1){let G=0,R=_;for(;G<R;)rn(e,{errors:E,currentLocation:d+R,expectedLocation:d,distance:i,ignoreLocation:l})<=f?G=R:_=R,R=Math.floor((_-G)/2+G);_=R;let I=Math.max(1,d-R+1),k=a?c:Math.min(d+R,c)+h,C=Array(k+2);C[k+1]=(1<<E)-1;for(let N=k;N>=I;N-=1){let B=N-1,j=t[r.charAt(B)];if(p&&(v[B]=+!!j),C[N]=(C[N+1]<<1|1)&j,E&&(C[N]|=(m[N+1]|m[N])<<1|1|m[N+1]),C[N]&T&&(b=rn(e,{errors:E,currentLocation:B,expectedLocation:d,distance:i,ignoreLocation:l}),b<=f)){if(f=b,g=B,g<=d)break;I=Math.max(1,2*d-g)}}if(rn(e,{errors:E+1,currentLocation:d,expectedLocation:d,distance:i,ignoreLocation:l})>f)break;m=C}const A={isMatch:g>=0,score:Math.max(.001,b)};if(p){const E=lh(v,s);E.length?u&&(A.indices=E):A.isMatch=!1}return A}function ch(r){let e={};for(let t=0,n=r.length;t<n;t+=1){const i=r.charAt(t);e[i]=(e[i]||0)|1<<n-t-1}return e}const En=String.prototype.normalize?r=>r.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):r=>r;class vs{constructor(e,{location:t=O.location,threshold:n=O.threshold,distance:i=O.distance,includeMatches:o=O.includeMatches,findAllMatches:a=O.findAllMatches,minMatchCharLength:s=O.minMatchCharLength,isCaseSensitive:u=O.isCaseSensitive,ignoreDiacritics:l=O.ignoreDiacritics,ignoreLocation:h=O.ignoreLocation}={}){if(this.options={location:t,threshold:n,distance:i,includeMatches:o,findAllMatches:a,minMatchCharLength:s,isCaseSensitive:u,ignoreDiacritics:l,ignoreLocation:h},e=u?e:e.toLowerCase(),e=l?En(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const c=(f,g)=>{this.chunks.push({pattern:f,alphabet:ch(f),startIndex:g})},d=this.pattern.length;if(d>Ft){let f=0;const g=d%Ft,p=d-g;for(;f<p;)c(this.pattern.substr(f,Ft),f),f+=Ft;if(g){const v=d-Ft;c(this.pattern.substr(v),v)}}else c(this.pattern,0)}searchIn(e){const{isCaseSensitive:t,ignoreDiacritics:n,includeMatches:i}=this.options;if(e=t?e:e.toLowerCase(),e=n?En(e):e,this.pattern===e){let p={isMatch:!0,score:0};return i&&(p.indices=[[0,e.length-1]]),p}const{location:o,distance:a,threshold:s,findAllMatches:u,minMatchCharLength:l,ignoreLocation:h}=this.options;let c=[],d=0,f=!1;this.chunks.forEach(({pattern:p,alphabet:v,startIndex:y})=>{const{isMatch:m,score:b,indices:_}=hh(e,p,v,{location:o+y,distance:a,threshold:s,findAllMatches:u,minMatchCharLength:l,includeMatches:i,ignoreLocation:h});m&&(f=!0),d+=b,m&&_&&(c=[...c,..._])});let g={isMatch:f,score:f?d/this.chunks.length:1};return f&&i&&(g.indices=c),g}}class kt{constructor(e){this.pattern=e}static isMultiMatch(e){return Uo(e,this.multiRegex)}static isSingleMatch(e){return Uo(e,this.singleRegex)}search(){}}function Uo(r,e){const t=r.match(e);return t?t[1]:null}class dh extends kt{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class fh extends kt{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const n=e.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class gh extends kt{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class ph extends kt{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class vh extends kt{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class mh extends kt{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class ms extends kt{constructor(e,{location:t=O.location,threshold:n=O.threshold,distance:i=O.distance,includeMatches:o=O.includeMatches,findAllMatches:a=O.findAllMatches,minMatchCharLength:s=O.minMatchCharLength,isCaseSensitive:u=O.isCaseSensitive,ignoreDiacritics:l=O.ignoreDiacritics,ignoreLocation:h=O.ignoreLocation}={}){super(e),this._bitapSearch=new vs(e,{location:t,threshold:n,distance:i,includeMatches:o,findAllMatches:a,minMatchCharLength:s,isCaseSensitive:u,ignoreDiacritics:l,ignoreLocation:h})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class ys extends kt{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t=0,n;const i=[],o=this.pattern.length;for(;(n=e.indexOf(this.pattern,t))>-1;)t=n+o,i.push([n,t-1]);const a=!!i.length;return{isMatch:a,score:a?0:1,indices:i}}}const Si=[dh,ys,gh,ph,mh,vh,fh,ms],Bo=Si.length,yh=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,bh="|";function _h(r,e={}){return r.split(bh).map(t=>{let n=t.trim().split(yh).filter(o=>o&&!!o.trim()),i=[];for(let o=0,a=n.length;o<a;o+=1){const s=n[o];let u=!1,l=-1;for(;!u&&++l<Bo;){const h=Si[l];let c=h.isMultiMatch(s);c&&(i.push(new h(c,e)),u=!0)}if(!u)for(l=-1;++l<Bo;){const h=Si[l];let c=h.isSingleMatch(s);if(c){i.push(new h(c,e));break}}}return i})}const wh=new Set([ms.type,ys.type]);class Eh{constructor(e,{isCaseSensitive:t=O.isCaseSensitive,ignoreDiacritics:n=O.ignoreDiacritics,includeMatches:i=O.includeMatches,minMatchCharLength:o=O.minMatchCharLength,ignoreLocation:a=O.ignoreLocation,findAllMatches:s=O.findAllMatches,location:u=O.location,threshold:l=O.threshold,distance:h=O.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:n,includeMatches:i,minMatchCharLength:o,findAllMatches:s,ignoreLocation:a,location:u,threshold:l,distance:h},e=t?e:e.toLowerCase(),e=n?En(e):e,this.pattern=e,this.query=_h(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:i,ignoreDiacritics:o}=this.options;e=i?e:e.toLowerCase(),e=o?En(e):e;let a=0,s=[],u=0;for(let l=0,h=t.length;l<h;l+=1){const c=t[l];s.length=0,a=0;for(let d=0,f=c.length;d<f;d+=1){const g=c[d],{isMatch:p,indices:v,score:y}=g.search(e);if(p){if(a+=1,u+=y,n){const m=g.constructor.type;wh.has(m)?s=[...s,...v]:s.push(v)}}else{u=0,a=0,s.length=0;break}}if(a){let d={isMatch:!0,score:u/a};return n&&(d.indices=s),d}}return{isMatch:!1,score:1}}}const Ti=[];function Ah(...r){Ti.push(...r)}function Ci(r,e){for(let t=0,n=Ti.length;t<n;t+=1){let i=Ti[t];if(i.condition(r,e))return new i(r,e)}return new vs(r,e)}const An={AND:"$and",OR:"$or"},Ri={PATH:"$path",PATTERN:"$val"},ki=r=>!!(r[An.AND]||r[An.OR]),xh=r=>!!r[Ri.PATH],Sh=r=>!gt(r)&&ds(r)&&!ki(r),zo=r=>({[An.AND]:Object.keys(r).map(e=>({[e]:r[e]}))});function bs(r,e,{auto:t=!0}={}){const n=i=>{let o=Object.keys(i);const a=xh(i);if(!a&&o.length>1&&!ki(i))return n(zo(i));if(Sh(i)){const u=a?i[Ri.PATH]:o[0],l=a?i[Ri.PATTERN]:i[u];if(!tt(l))throw new Error(Xl(u));const h={keyId:xi(u),pattern:l};return t&&(h.searcher=Ci(l,e)),h}let s={children:[],operator:o[0]};return o.forEach(u=>{const l=i[u];gt(l)&&l.forEach(h=>{s.children.push(n(h))})}),s};return ki(r)||(r=zo(r)),n(r)}function Th(r,{ignoreFieldNorm:e=O.ignoreFieldNorm}){r.forEach(t=>{let n=1;t.matches.forEach(({key:i,norm:o,score:a})=>{const s=i?i.weight:null;n*=Math.pow(a===0&&s?Number.EPSILON:a,(s||1)*(e?1:o))}),t.score=n})}function Ch(r,e){const t=r.matches;e.matches=[],Ge(t)&&t.forEach(n=>{if(!Ge(n.indices)||!n.indices.length)return;const{indices:i,value:o}=n;let a={indices:i,value:o};n.key&&(a.key=n.key.src),n.idx>-1&&(a.refIndex=n.idx),e.matches.push(a)})}function Rh(r,e){e.score=r.score}function kh(r,e,{includeMatches:t=O.includeMatches,includeScore:n=O.includeScore}={}){const i=[];return t&&i.push(Ch),n&&i.push(Rh),r.map(o=>{const{idx:a}=o,s={item:e[a],refIndex:a};return i.length&&i.forEach(u=>{u(o,s)}),s})}class wr{constructor(e,t={},n){this.options={...O,...t},this.options.useExtendedSearch,this._keyStore=new eh(this.options.keys),this.setCollection(e,n)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof Qi))throw new Error(ql);this._myIndex=t||ps(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){Ge(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const t=[];for(let n=0,i=this._docs.length;n<i;n+=1){const o=this._docs[n];e(o,n)&&(this.removeAt(n),n-=1,i-=1,t.push(o))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){const{includeMatches:n,includeScore:i,shouldSort:o,sortFn:a,ignoreFieldNorm:s}=this.options;let u=tt(e)?tt(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Th(u,{ignoreFieldNorm:s}),o&&u.sort(a),cs(t)&&t>-1&&(u=u.slice(0,t)),kh(u,this._docs,{includeMatches:n,includeScore:i})}_searchStringList(e){const t=Ci(e,this.options),{records:n}=this._myIndex,i=[];return n.forEach(({v:o,i:a,n:s})=>{if(!Ge(o))return;const{isMatch:u,score:l,indices:h}=t.searchIn(o);u&&i.push({item:o,idx:a,matches:[{score:l,value:o,norm:s,indices:h}]})}),i}_searchLogical(e){const t=bs(e,this.options),n=(s,u,l)=>{if(!s.children){const{keyId:c,searcher:d}=s,f=this._findMatches({key:this._keyStore.get(c),value:this._myIndex.getValueForItemAtKeyId(u,c),searcher:d});return f&&f.length?[{idx:l,item:u,matches:f}]:[]}const h=[];for(let c=0,d=s.children.length;c<d;c+=1){const f=s.children[c],g=n(f,u,l);if(g.length)h.push(...g);else if(s.operator===An.AND)return[]}return h},i=this._myIndex.records,o={},a=[];return i.forEach(({$:s,i:u})=>{if(Ge(s)){let l=n(t,s,u);l.length&&(o[u]||(o[u]={idx:u,item:s,matches:[]},a.push(o[u])),l.forEach(({matches:h})=>{o[u].matches.push(...h)}))}}),a}_searchObjectList(e){const t=Ci(e,this.options),{keys:n,records:i}=this._myIndex,o=[];return i.forEach(({$:a,i:s})=>{if(!Ge(a))return;let u=[];n.forEach((l,h)=>{u.push(...this._findMatches({key:l,value:a[h],searcher:t}))}),u.length&&o.push({idx:s,item:a,matches:u})}),o}_findMatches({key:e,value:t,searcher:n}){if(!Ge(t))return[];let i=[];if(gt(t))t.forEach(({v:o,i:a,n:s})=>{if(!Ge(o))return;const{isMatch:u,score:l,indices:h}=n.searchIn(o);u&&i.push({score:l,key:e,value:o,idx:a,norm:s,indices:h})});else{const{v:o,n:a}=t,{isMatch:s,score:u,indices:l}=n.searchIn(o);s&&i.push({score:u,key:e,value:o,norm:a,indices:l})}return i}}wr.version="7.1.0";wr.createIndex=ps;wr.parseIndex=uh;wr.config=O;wr.parseQuery=bs;Ah(Eh);function Dh(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var eo={exports:{}},Jt=typeof Reflect=="object"?Reflect:null,Ho=Jt&&typeof Jt.apply=="function"?Jt.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},hn;Jt&&typeof Jt.ownKeys=="function"?hn=Jt.ownKeys:Object.getOwnPropertySymbols?hn=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:hn=function(e){return Object.getOwnPropertyNames(e)};function Lh(r){console&&console.warn&&console.warn(r)}var _s=Number.isNaN||function(e){return e!==e};function Z(){Z.init.call(this)}eo.exports=Z;eo.exports.once=Ih;Z.EventEmitter=Z;Z.prototype._events=void 0;Z.prototype._eventsCount=0;Z.prototype._maxListeners=void 0;var jo=10;function Un(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Z,"defaultMaxListeners",{enumerable:!0,get:function(){return jo},set:function(r){if(typeof r!="number"||r<0||_s(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");jo=r}});Z.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Z.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||_s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ws(r){return r._maxListeners===void 0?Z.defaultMaxListeners:r._maxListeners}Z.prototype.getMaxListeners=function(){return ws(this)};Z.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=o[e];if(u===void 0)return!1;if(typeof u=="function")Ho(u,this,t);else for(var l=u.length,h=Ts(u,l),n=0;n<l;++n)Ho(h[n],this,t);return!0};function Es(r,e,t,n){var i,o,a;if(Un(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),a=o[e]),a===void 0)a=o[e]=t,++r._eventsCount;else if(typeof a=="function"?a=o[e]=n?[t,a]:[a,t]:n?a.unshift(t):a.push(t),i=ws(r),i>0&&a.length>i&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=r,s.type=e,s.count=a.length,Lh(s)}return r}Z.prototype.addListener=function(e,t){return Es(this,e,t,!1)};Z.prototype.on=Z.prototype.addListener;Z.prototype.prependListener=function(e,t){return Es(this,e,t,!0)};function Nh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function As(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=Nh.bind(n);return i.listener=t,n.wrapFn=i,i}Z.prototype.once=function(e,t){return Un(t),this.on(e,As(this,e,t)),this};Z.prototype.prependOnceListener=function(e,t){return Un(t),this.prependListener(e,As(this,e,t)),this};Z.prototype.removeListener=function(e,t){var n,i,o,a,s;if(Un(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){s=n[a].listener,o=a;break}if(o<0)return this;o===0?n.shift():Fh(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,s||t)}return this};Z.prototype.off=Z.prototype.removeListener;Z.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),a;for(i=0;i<o.length;++i)a=o[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function xs(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Gh(i):Ts(i,i.length)}Z.prototype.listeners=function(e){return xs(this,e,!0)};Z.prototype.rawListeners=function(e){return xs(this,e,!1)};Z.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):Ss.call(r,e)};Z.prototype.listenerCount=Ss;function Ss(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Z.prototype.eventNames=function(){return this._eventsCount>0?hn(this._events):[]};function Ts(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Fh(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Gh(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Ih(r,e){return new Promise(function(t,n){function i(a){r.removeListener(e,o),n(a)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}Cs(r,e,o,{once:!0}),e!=="error"&&Mh(r,i,{once:!0})})}function Mh(r,e,t){typeof r.on=="function"&&Cs(r,"error",e,t)}function Cs(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(o){n.once&&r.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var Rs=eo.exports;function Ph(){const r=arguments[0];for(let e=1,t=arguments.length;e<t;e++)if(arguments[e])for(const n in arguments[e])r[n]=arguments[e][n];return r}let ae=Ph;typeof Object.assign=="function"&&(ae=Object.assign);function Oe(r,e,t,n){const i=r._nodes.get(e);let o=null;return i&&(n==="mixed"?o=i.out&&i.out[t]||i.undirected&&i.undirected[t]:n==="directed"?o=i.out&&i.out[t]:o=i.undirected&&i.undirected[t]),o}function he(r){return typeof r=="object"&&r!==null}function ks(r){let e;for(e in r)return!1;return!0}function Me(r,e,t){Object.defineProperty(r,e,{enumerable:!1,configurable:!1,writable:!0,value:t})}function He(r,e,t){const n={enumerable:!0,configurable:!0};typeof t=="function"?n.get=t:(n.value=t,n.writable=!1),Object.defineProperty(r,e,n)}function Wo(r){return!(!he(r)||r.attributes&&!Array.isArray(r.attributes))}function $h(){let r=Math.floor(Math.random()*256)&255;return()=>r++}function ft(){const r=arguments;let e=null,t=-1;return{[Symbol.iterator](){return this},next(){let n=null;do{if(e===null){if(t++,t>=r.length)return{done:!0};e=r[t][Symbol.iterator]()}if(n=e.next(),n.done){e=null;continue}break}while(!0);return n}}}function Er(){return{[Symbol.iterator](){return this},next(){return{done:!0}}}}class to extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}class D extends to{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,D.prototype.constructor)}}class S extends to{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,S.prototype.constructor)}}class P extends to{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,P.prototype.constructor)}}function Ds(r,e){this.key=r,this.attributes=e,this.clear()}Ds.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function Ls(r,e){this.key=r,this.attributes=e,this.clear()}Ls.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function Ns(r,e){this.key=r,this.attributes=e,this.clear()}Ns.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function Ar(r,e,t,n,i){this.key=e,this.attributes=i,this.undirected=r,this.source=t,this.target=n}Ar.prototype.attach=function(){let r="out",e="in";this.undirected&&(r=e="undirected");const t=this.source.key,n=this.target.key;this.source[r][n]=this,!(this.undirected&&t===n)&&(this.target[e][t]=this)};Ar.prototype.attachMulti=function(){let r="out",e="in";const t=this.source.key,n=this.target.key;this.undirected&&(r=e="undirected");const i=this.source[r],o=i[n];if(typeof o>"u"){i[n]=this,this.undirected&&t===n||(this.target[e][t]=this);return}o.previous=this,this.next=o,i[n]=this,this.target[e][t]=this};Ar.prototype.detach=function(){const r=this.source.key,e=this.target.key;let t="out",n="in";this.undirected&&(t=n="undirected"),delete this.source[t][e],delete this.target[n][r]};Ar.prototype.detachMulti=function(){const r=this.source.key,e=this.target.key;let t="out",n="in";this.undirected&&(t=n="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[t][e],delete this.target[n][r]):(this.next.previous=void 0,this.source[t][e]=this.next,this.target[n][r]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const Fs=0,Gs=1,Oh=2,Is=3;function yt(r,e,t,n,i,o,a){let s,u,l,h;if(n=""+n,t===Fs){if(s=r._nodes.get(n),!s)throw new S(`Graph.${e}: could not find the "${n}" node in the graph.`);l=i,h=o}else if(t===Is){if(i=""+i,u=r._edges.get(i),!u)throw new S(`Graph.${e}: could not find the "${i}" edge in the graph.`);const c=u.source.key,d=u.target.key;if(n===c)s=u.target;else if(n===d)s=u.source;else throw new S(`Graph.${e}: the "${n}" node is not attached to the "${i}" edge (${c}, ${d}).`);l=o,h=a}else{if(u=r._edges.get(n),!u)throw new S(`Graph.${e}: could not find the "${n}" edge in the graph.`);t===Gs?s=u.source:s=u.target,l=i,h=o}return[s,l,h]}function Uh(r,e,t){r.prototype[e]=function(n,i,o){const[a,s]=yt(this,e,t,n,i,o);return a.attributes[s]}}function Bh(r,e,t){r.prototype[e]=function(n,i){const[o]=yt(this,e,t,n,i);return o.attributes}}function zh(r,e,t){r.prototype[e]=function(n,i,o){const[a,s]=yt(this,e,t,n,i,o);return a.attributes.hasOwnProperty(s)}}function Hh(r,e,t){r.prototype[e]=function(n,i,o,a){const[s,u,l]=yt(this,e,t,n,i,o,a);return s.attributes[u]=l,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:u}),this}}function jh(r,e,t){r.prototype[e]=function(n,i,o,a){const[s,u,l]=yt(this,e,t,n,i,o,a);if(typeof l!="function")throw new D(`Graph.${e}: updater should be a function.`);const h=s.attributes,c=l(h[u]);return h[u]=c,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:u}),this}}function Wh(r,e,t){r.prototype[e]=function(n,i,o){const[a,s]=yt(this,e,t,n,i,o);return delete a.attributes[s],this.emit("nodeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:s}),this}}function Vh(r,e,t){r.prototype[e]=function(n,i,o){const[a,s]=yt(this,e,t,n,i,o);if(!he(s))throw new D(`Graph.${e}: provided attributes are not a plain object.`);return a.attributes=s,this.emit("nodeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function Kh(r,e,t){r.prototype[e]=function(n,i,o){const[a,s]=yt(this,e,t,n,i,o);if(!he(s))throw new D(`Graph.${e}: provided attributes are not a plain object.`);return ae(a.attributes,s),this.emit("nodeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:s}),this}}function Yh(r,e,t){r.prototype[e]=function(n,i,o){const[a,s]=yt(this,e,t,n,i,o);if(typeof s!="function")throw new D(`Graph.${e}: provided updater is not a function.`);return a.attributes=s(a.attributes),this.emit("nodeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const qh=[{name:r=>`get${r}Attribute`,attacher:Uh},{name:r=>`get${r}Attributes`,attacher:Bh},{name:r=>`has${r}Attribute`,attacher:zh},{name:r=>`set${r}Attribute`,attacher:Hh},{name:r=>`update${r}Attribute`,attacher:jh},{name:r=>`remove${r}Attribute`,attacher:Wh},{name:r=>`replace${r}Attributes`,attacher:Vh},{name:r=>`merge${r}Attributes`,attacher:Kh},{name:r=>`update${r}Attributes`,attacher:Yh}];function Xh(r){qh.forEach(function({name:e,attacher:t}){t(r,e("Node"),Fs),t(r,e("Source"),Gs),t(r,e("Target"),Oh),t(r,e("Opposite"),Is)})}function Zh(r,e,t){r.prototype[e]=function(n,i){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new P(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new P(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+n,s=""+i;if(i=arguments[2],o=Oe(this,a,s,t),!o)throw new S(`Graph.${e}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new P(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,o=this._edges.get(n),!o)throw new S(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return o.attributes[i]}}function Jh(r,e,t){r.prototype[e]=function(n){let i;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new P(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new P(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,a=""+arguments[1];if(i=Oe(this,o,a,t),!i)throw new S(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(t!=="mixed")throw new P(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,i=this._edges.get(n),!i)throw new S(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return i.attributes}}function Qh(r,e,t){r.prototype[e]=function(n,i){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new P(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new P(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+n,s=""+i;if(i=arguments[2],o=Oe(this,a,s,t),!o)throw new S(`Graph.${e}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new P(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,o=this._edges.get(n),!o)throw new S(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return o.attributes.hasOwnProperty(i)}}function ec(r,e,t){r.prototype[e]=function(n,i,o){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new P(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new P(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,u=""+i;if(i=arguments[2],o=arguments[3],a=Oe(this,s,u,t),!a)throw new S(`Graph.${e}: could not find an edge for the given path ("${s}" - "${u}").`)}else{if(t!=="mixed")throw new P(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new S(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return a.attributes[i]=o,this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:i}),this}}function tc(r,e,t){r.prototype[e]=function(n,i,o){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new P(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new P(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,u=""+i;if(i=arguments[2],o=arguments[3],a=Oe(this,s,u,t),!a)throw new S(`Graph.${e}: could not find an edge for the given path ("${s}" - "${u}").`)}else{if(t!=="mixed")throw new P(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new S(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(typeof o!="function")throw new D(`Graph.${e}: updater should be a function.`);return a.attributes[i]=o(a.attributes[i]),this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:i}),this}}function rc(r,e,t){r.prototype[e]=function(n,i){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new P(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new P(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+n,s=""+i;if(i=arguments[2],o=Oe(this,a,s,t),!o)throw new S(`Graph.${e}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new P(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,o=this._edges.get(n),!o)throw new S(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return delete o.attributes[i],this.emit("edgeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:i}),this}}function nc(r,e,t){r.prototype[e]=function(n,i){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new P(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new P(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+n,s=""+i;if(i=arguments[2],o=Oe(this,a,s,t),!o)throw new S(`Graph.${e}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new P(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,o=this._edges.get(n),!o)throw new S(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(!he(i))throw new D(`Graph.${e}: provided attributes are not a plain object.`);return o.attributes=i,this.emit("edgeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function ic(r,e,t){r.prototype[e]=function(n,i){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new P(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new P(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+n,s=""+i;if(i=arguments[2],o=Oe(this,a,s,t),!o)throw new S(`Graph.${e}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new P(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,o=this._edges.get(n),!o)throw new S(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(!he(i))throw new D(`Graph.${e}: provided attributes are not a plain object.`);return ae(o.attributes,i),this.emit("edgeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:i}),this}}function oc(r,e,t){r.prototype[e]=function(n,i){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new P(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new P(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+n,s=""+i;if(i=arguments[2],o=Oe(this,a,s,t),!o)throw new S(`Graph.${e}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new P(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,o=this._edges.get(n),!o)throw new S(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(typeof i!="function")throw new D(`Graph.${e}: provided updater is not a function.`);return o.attributes=i(o.attributes),this.emit("edgeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const ac=[{name:r=>`get${r}Attribute`,attacher:Zh},{name:r=>`get${r}Attributes`,attacher:Jh},{name:r=>`has${r}Attribute`,attacher:Qh},{name:r=>`set${r}Attribute`,attacher:ec},{name:r=>`update${r}Attribute`,attacher:tc},{name:r=>`remove${r}Attribute`,attacher:rc},{name:r=>`replace${r}Attributes`,attacher:nc},{name:r=>`merge${r}Attributes`,attacher:ic},{name:r=>`update${r}Attributes`,attacher:oc}];function sc(r){ac.forEach(function({name:e,attacher:t}){t(r,e("Edge"),"mixed"),t(r,e("DirectedEdge"),"directed"),t(r,e("UndirectedEdge"),"undirected")})}const uc=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function lc(r,e,t,n){let i=!1;for(const o in e){if(o===n)continue;const a=e[o];if(i=t(a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes,a.undirected),r&&i)return a.key}}function hc(r,e,t,n){let i,o,a,s=!1;for(const u in e)if(u!==n){i=e[u];do{if(o=i.source,a=i.target,s=t(i.key,i.attributes,o.key,a.key,o.attributes,a.attributes,i.undirected),r&&s)return i.key;i=i.next}while(i!==void 0)}}function Qn(r,e){const t=Object.keys(r),n=t.length;let i,o=0;return{[Symbol.iterator](){return this},next(){do if(i)i=i.next;else{if(o>=n)return{done:!0};const a=t[o++];if(a===e){i=void 0;continue}i=r[a]}while(!i);return{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected}}}}}function cc(r,e,t,n){const i=e[t];if(!i)return;const o=i.source,a=i.target;if(n(i.key,i.attributes,o.key,a.key,o.attributes,a.attributes,i.undirected)&&r)return i.key}function dc(r,e,t,n){let i=e[t];if(!i)return;let o=!1;do{if(o=n(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),r&&o)return i.key;i=i.next}while(i!==void 0)}function ei(r,e){let t=r[e];if(t.next!==void 0)return{[Symbol.iterator](){return this},next(){if(!t)return{done:!0};const i={edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected};return t=t.next,{done:!1,value:i}}};let n=!1;return{[Symbol.iterator](){return this},next(){return n===!0?{done:!0}:(n=!0,{done:!1,value:{edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected}})}}}function fc(r,e){if(r.size===0)return[];if(e==="mixed"||e===r.type)return Array.from(r._edges.keys());const t=e==="undirected"?r.undirectedSize:r.directedSize,n=new Array(t),i=e==="undirected",o=r._edges.values();let a=0,s,u;for(;s=o.next(),s.done!==!0;)u=s.value,u.undirected===i&&(n[a++]=u.key);return n}function Ms(r,e,t,n){if(e.size===0)return;const i=t!=="mixed"&&t!==e.type,o=t==="undirected";let a,s,u=!1;const l=e._edges.values();for(;a=l.next(),a.done!==!0;){if(s=a.value,i&&s.undirected!==o)continue;const{key:h,attributes:c,source:d,target:f}=s;if(u=n(h,c,d.key,f.key,d.attributes,f.attributes,s.undirected),r&&u)return h}}function gc(r,e){if(r.size===0)return Er();const t=e!=="mixed"&&e!==r.type,n=e==="undirected",i=r._edges.values();return{[Symbol.iterator](){return this},next(){let o,a;for(;;){if(o=i.next(),o.done)return o;if(a=o.value,!(t&&a.undirected!==n))break}return{value:{edge:a.key,attributes:a.attributes,source:a.source.key,target:a.target.key,sourceAttributes:a.source.attributes,targetAttributes:a.target.attributes,undirected:a.undirected},done:!1}}}}function ro(r,e,t,n,i,o){const a=e?hc:lc;let s;if(t!=="undirected"&&(n!=="out"&&(s=a(r,i.in,o),r&&s)||n!=="in"&&(s=a(r,i.out,o,n?void 0:i.key),r&&s))||t!=="directed"&&(s=a(r,i.undirected,o),r&&s))return s}function pc(r,e,t,n){const i=[];return ro(!1,r,e,t,n,function(o){i.push(o)}),i}function vc(r,e,t){let n=Er();return r!=="undirected"&&(e!=="out"&&typeof t.in<"u"&&(n=ft(n,Qn(t.in))),e!=="in"&&typeof t.out<"u"&&(n=ft(n,Qn(t.out,e?void 0:t.key)))),r!=="directed"&&typeof t.undirected<"u"&&(n=ft(n,Qn(t.undirected))),n}function no(r,e,t,n,i,o,a){const s=t?dc:cc;let u;if(e!=="undirected"&&(typeof i.in<"u"&&n!=="out"&&(u=s(r,i.in,o,a),r&&u)||typeof i.out<"u"&&n!=="in"&&(n||i.key!==o)&&(u=s(r,i.out,o,a),r&&u))||e!=="directed"&&typeof i.undirected<"u"&&(u=s(r,i.undirected,o,a),r&&u))return u}function mc(r,e,t,n,i){const o=[];return no(!1,r,e,t,n,i,function(a){o.push(a)}),o}function yc(r,e,t,n){let i=Er();return r!=="undirected"&&(typeof t.in<"u"&&e!=="out"&&n in t.in&&(i=ft(i,ei(t.in,n))),typeof t.out<"u"&&e!=="in"&&n in t.out&&(e||t.key!==n)&&(i=ft(i,ei(t.out,n)))),r!=="directed"&&typeof t.undirected<"u"&&n in t.undirected&&(i=ft(i,ei(t.undirected,n))),i}function bc(r,e){const{name:t,type:n,direction:i}=e;r.prototype[t]=function(o,a){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return[];if(!arguments.length)return fc(this,n);if(arguments.length===1){o=""+o;const s=this._nodes.get(o);if(typeof s>"u")throw new S(`Graph.${t}: could not find the "${o}" node in the graph.`);return pc(this.multi,n==="mixed"?this.type:n,i,s)}if(arguments.length===2){o=""+o,a=""+a;const s=this._nodes.get(o);if(!s)throw new S(`Graph.${t}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new S(`Graph.${t}:  could not find the "${a}" target node in the graph.`);return mc(n,this.multi,i,s,a)}throw new D(`Graph.${t}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function _c(r,e){const{name:t,type:n,direction:i}=e,o="forEach"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[o]=function(l,h,c){if(!(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)){if(arguments.length===1)return c=l,Ms(!1,this,n,c);if(arguments.length===2){l=""+l,c=h;const d=this._nodes.get(l);if(typeof d>"u")throw new S(`Graph.${o}: could not find the "${l}" node in the graph.`);return ro(!1,this.multi,n==="mixed"?this.type:n,i,d,c)}if(arguments.length===3){l=""+l,h=""+h;const d=this._nodes.get(l);if(!d)throw new S(`Graph.${o}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(h))throw new S(`Graph.${o}:  could not find the "${h}" target node in the graph.`);return no(!1,n,this.multi,i,d,h,c)}throw new D(`Graph.${o}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const a="map"+t[0].toUpperCase()+t.slice(1);r.prototype[a]=function(){const l=Array.prototype.slice.call(arguments),h=l.pop();let c;if(l.length===0){let d=0;n!=="directed"&&(d+=this.undirectedSize),n!=="undirected"&&(d+=this.directedSize),c=new Array(d);let f=0;l.push((g,p,v,y,m,b,_)=>{c[f++]=h(g,p,v,y,m,b,_)})}else c=[],l.push((d,f,g,p,v,y,m)=>{c.push(h(d,f,g,p,v,y,m))});return this[o].apply(this,l),c};const s="filter"+t[0].toUpperCase()+t.slice(1);r.prototype[s]=function(){const l=Array.prototype.slice.call(arguments),h=l.pop(),c=[];return l.push((d,f,g,p,v,y,m)=>{h(d,f,g,p,v,y,m)&&c.push(d)}),this[o].apply(this,l),c};const u="reduce"+t[0].toUpperCase()+t.slice(1);r.prototype[u]=function(){let l=Array.prototype.slice.call(arguments);if(l.length<2||l.length>4)throw new D(`Graph.${u}: invalid number of arguments (expecting 2, 3 or 4 and got ${l.length}).`);if(typeof l[l.length-1]=="function"&&typeof l[l.length-2]!="function")throw new D(`Graph.${u}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let h,c;l.length===2?(h=l[0],c=l[1],l=[]):l.length===3?(h=l[1],c=l[2],l=[l[0]]):l.length===4&&(h=l[2],c=l[3],l=[l[0],l[1]]);let d=c;return l.push((f,g,p,v,y,m,b)=>{d=h(d,f,g,p,v,y,m,b)}),this[o].apply(this,l),d}}function wc(r,e){const{name:t,type:n,direction:i}=e,o="find"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[o]=function(u,l,h){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return!1;if(arguments.length===1)return h=u,Ms(!0,this,n,h);if(arguments.length===2){u=""+u,h=l;const c=this._nodes.get(u);if(typeof c>"u")throw new S(`Graph.${o}: could not find the "${u}" node in the graph.`);return ro(!0,this.multi,n==="mixed"?this.type:n,i,c,h)}if(arguments.length===3){u=""+u,l=""+l;const c=this._nodes.get(u);if(!c)throw new S(`Graph.${o}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(l))throw new S(`Graph.${o}:  could not find the "${l}" target node in the graph.`);return no(!0,n,this.multi,i,c,l,h)}throw new D(`Graph.${o}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const a="some"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[a]=function(){const u=Array.prototype.slice.call(arguments),l=u.pop();return u.push((c,d,f,g,p,v,y)=>l(c,d,f,g,p,v,y)),!!this[o].apply(this,u)};const s="every"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[s]=function(){const u=Array.prototype.slice.call(arguments),l=u.pop();return u.push((c,d,f,g,p,v,y)=>!l(c,d,f,g,p,v,y)),!this[o].apply(this,u)}}function Ec(r,e){const{name:t,type:n,direction:i}=e,o=t.slice(0,-1)+"Entries";r.prototype[o]=function(a,s){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return Er();if(!arguments.length)return gc(this,n);if(arguments.length===1){a=""+a;const u=this._nodes.get(a);if(!u)throw new S(`Graph.${o}: could not find the "${a}" node in the graph.`);return vc(n,i,u)}if(arguments.length===2){a=""+a,s=""+s;const u=this._nodes.get(a);if(!u)throw new S(`Graph.${o}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(s))throw new S(`Graph.${o}:  could not find the "${s}" target node in the graph.`);return yc(n,i,u,s)}throw new D(`Graph.${o}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Ac(r){uc.forEach(e=>{bc(r,e),_c(r,e),wc(r,e),Ec(r,e)})}const xc=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Bn(){this.A=null,this.B=null}Bn.prototype.wrap=function(r){this.A===null?this.A=r:this.B===null&&(this.B=r)};Bn.prototype.has=function(r){return this.A!==null&&r in this.A||this.B!==null&&r in this.B};function Cr(r,e,t,n,i){for(const o in n){const a=n[o],s=a.source,u=a.target,l=s===t?u:s;if(e&&e.has(l.key))continue;const h=i(l.key,l.attributes);if(r&&h)return l.key}}function io(r,e,t,n,i){if(e!=="mixed"){if(e==="undirected")return Cr(r,null,n,n.undirected,i);if(typeof t=="string")return Cr(r,null,n,n[t],i)}const o=new Bn;let a;if(e!=="undirected"){if(t!=="out"){if(a=Cr(r,null,n,n.in,i),r&&a)return a;o.wrap(n.in)}if(t!=="in"){if(a=Cr(r,o,n,n.out,i),r&&a)return a;o.wrap(n.out)}}if(e!=="directed"&&(a=Cr(r,o,n,n.undirected,i),r&&a))return a}function Sc(r,e,t){if(r!=="mixed"){if(r==="undirected")return Object.keys(t.undirected);if(typeof e=="string")return Object.keys(t[e])}const n=[];return io(!1,r,e,t,function(i){n.push(i)}),n}function Rr(r,e,t){const n=Object.keys(t),i=n.length;let o=0;return{[Symbol.iterator](){return this},next(){let a=null;do{if(o>=i)return r&&r.wrap(t),{done:!0};const s=t[n[o++]],u=s.source,l=s.target;if(a=u===e?l:u,r&&r.has(a.key)){a=null;continue}}while(a===null);return{done:!1,value:{neighbor:a.key,attributes:a.attributes}}}}}function Tc(r,e,t){if(r!=="mixed"){if(r==="undirected")return Rr(null,t,t.undirected);if(typeof e=="string")return Rr(null,t,t[e])}let n=Er();const i=new Bn;return r!=="undirected"&&(e!=="out"&&(n=ft(n,Rr(i,t,t.in))),e!=="in"&&(n=ft(n,Rr(i,t,t.out)))),r!=="directed"&&(n=ft(n,Rr(i,t,t.undirected))),n}function Cc(r,e){const{name:t,type:n,direction:i}=e;r.prototype[t]=function(o){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return[];o=""+o;const a=this._nodes.get(o);if(typeof a>"u")throw new S(`Graph.${t}: could not find the "${o}" node in the graph.`);return Sc(n==="mixed"?this.type:n,i,a)}}function Rc(r,e){const{name:t,type:n,direction:i}=e,o="forEach"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[o]=function(l,h){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return;l=""+l;const c=this._nodes.get(l);if(typeof c>"u")throw new S(`Graph.${o}: could not find the "${l}" node in the graph.`);io(!1,n==="mixed"?this.type:n,i,c,h)};const a="map"+t[0].toUpperCase()+t.slice(1);r.prototype[a]=function(l,h){const c=[];return this[o](l,(d,f)=>{c.push(h(d,f))}),c};const s="filter"+t[0].toUpperCase()+t.slice(1);r.prototype[s]=function(l,h){const c=[];return this[o](l,(d,f)=>{h(d,f)&&c.push(d)}),c};const u="reduce"+t[0].toUpperCase()+t.slice(1);r.prototype[u]=function(l,h,c){if(arguments.length<3)throw new D(`Graph.${u}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let d=c;return this[o](l,(f,g)=>{d=h(d,f,g)}),d}}function kc(r,e){const{name:t,type:n,direction:i}=e,o=t[0].toUpperCase()+t.slice(1,-1),a="find"+o;r.prototype[a]=function(l,h){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return;l=""+l;const c=this._nodes.get(l);if(typeof c>"u")throw new S(`Graph.${a}: could not find the "${l}" node in the graph.`);return io(!0,n==="mixed"?this.type:n,i,c,h)};const s="some"+o;r.prototype[s]=function(l,h){return!!this[a](l,h)};const u="every"+o;r.prototype[u]=function(l,h){return!this[a](l,(d,f)=>!h(d,f))}}function Dc(r,e){const{name:t,type:n,direction:i}=e,o=t.slice(0,-1)+"Entries";r.prototype[o]=function(a){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return Er();a=""+a;const s=this._nodes.get(a);if(typeof s>"u")throw new S(`Graph.${o}: could not find the "${a}" node in the graph.`);return Tc(n==="mixed"?this.type:n,i,s)}}function Lc(r){xc.forEach(e=>{Cc(r,e),Rc(r,e),kc(r,e),Dc(r,e)})}function nn(r,e,t,n,i){const o=n._nodes.values(),a=n.type;let s,u,l,h,c,d;for(;s=o.next(),s.done!==!0;){let f=!1;if(u=s.value,a!=="undirected"){h=u.out;for(l in h){c=h[l];do d=c.target,f=!0,i(u.key,d.key,u.attributes,d.attributes,c.key,c.attributes,c.undirected),c=c.next;while(c)}}if(a!=="directed"){h=u.undirected;for(l in h)if(!(e&&u.key>l)){c=h[l];do d=c.target,d.key!==l&&(d=c.source),f=!0,i(u.key,d.key,u.attributes,d.attributes,c.key,c.attributes,c.undirected),c=c.next;while(c)}}t&&!f&&i(u.key,null,u.attributes,null,null,null,null)}}function Nc(r,e){const t={key:r};return ks(e.attributes)||(t.attributes=ae({},e.attributes)),t}function Fc(r,e,t){const n={key:e,source:t.source.key,target:t.target.key};return ks(t.attributes)||(n.attributes=ae({},t.attributes)),r==="mixed"&&t.undirected&&(n.undirected=!0),n}function Gc(r){if(!he(r))throw new D('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in r))throw new D("Graph.import: serialized node is missing its key.");if("attributes"in r&&(!he(r.attributes)||r.attributes===null))throw new D("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function Ic(r){if(!he(r))throw new D('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in r))throw new D("Graph.import: serialized edge is missing its source.");if(!("target"in r))throw new D("Graph.import: serialized edge is missing its target.");if("attributes"in r&&(!he(r.attributes)||r.attributes===null))throw new D("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in r&&typeof r.undirected!="boolean")throw new D("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const Mc=$h(),Pc=new Set(["directed","undirected","mixed"]),Vo=new Set(["domain","_events","_eventsCount","_maxListeners"]),$c=[{name:r=>`${r}Edge`,generateKey:!0},{name:r=>`${r}DirectedEdge`,generateKey:!0,type:"directed"},{name:r=>`${r}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:r=>`${r}EdgeWithKey`},{name:r=>`${r}DirectedEdgeWithKey`,type:"directed"},{name:r=>`${r}UndirectedEdgeWithKey`,type:"undirected"}],Oc={allowSelfLoops:!0,multi:!1,type:"mixed"};function Uc(r,e,t){if(t&&!he(t))throw new D(`Graph.addNode: invalid attributes. Expecting an object but got "${t}"`);if(e=""+e,t=t||{},r._nodes.has(e))throw new P(`Graph.addNode: the "${e}" node already exist in the graph.`);const n=new r.NodeDataClass(e,t);return r._nodes.set(e,n),r.emit("nodeAdded",{key:e,attributes:t}),n}function Ko(r,e,t){const n=new r.NodeDataClass(e,t);return r._nodes.set(e,n),r.emit("nodeAdded",{key:e,attributes:t}),n}function Ps(r,e,t,n,i,o,a,s){if(!n&&r.type==="undirected")throw new P(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(n&&r.type==="directed")throw new P(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(s&&!he(s))throw new D(`Graph.${e}: invalid attributes. Expecting an object but got "${s}"`);if(o=""+o,a=""+a,s=s||{},!r.allowSelfLoops&&o===a)throw new P(`Graph.${e}: source & target are the same ("${o}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const u=r._nodes.get(o),l=r._nodes.get(a);if(!u)throw new S(`Graph.${e}: source node "${o}" not found.`);if(!l)throw new S(`Graph.${e}: target node "${a}" not found.`);const h={key:null,undirected:n,source:o,target:a,attributes:s};if(t)i=r._edgeKeyGenerator();else if(i=""+i,r._edges.has(i))throw new P(`Graph.${e}: the "${i}" edge already exists in the graph.`);if(!r.multi&&(n?typeof u.undirected[a]<"u":typeof u.out[a]<"u"))throw new P(`Graph.${e}: an edge linking "${o}" to "${a}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const c=new Ar(n,i,u,l,s);r._edges.set(i,c);const d=o===a;return n?(u.undirectedDegree++,l.undirectedDegree++,d&&(u.undirectedLoops++,r._undirectedSelfLoopCount++)):(u.outDegree++,l.inDegree++,d&&(u.directedLoops++,r._directedSelfLoopCount++)),r.multi?c.attachMulti():c.attach(),n?r._undirectedSize++:r._directedSize++,h.key=i,r.emit("edgeAdded",h),i}function Bc(r,e,t,n,i,o,a,s,u){if(!n&&r.type==="undirected")throw new P(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(n&&r.type==="directed")throw new P(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(s){if(u){if(typeof s!="function")throw new D(`Graph.${e}: invalid updater function. Expecting a function but got "${s}"`)}else if(!he(s))throw new D(`Graph.${e}: invalid attributes. Expecting an object but got "${s}"`)}o=""+o,a=""+a;let l;if(u&&(l=s,s=void 0),!r.allowSelfLoops&&o===a)throw new P(`Graph.${e}: source & target are the same ("${o}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let h=r._nodes.get(o),c=r._nodes.get(a),d,f;if(!t&&(d=r._edges.get(i),d)){if((d.source.key!==o||d.target.key!==a)&&(!n||d.source.key!==a||d.target.key!==o))throw new P(`Graph.${e}: inconsistency detected when attempting to merge the "${i}" edge with "${o}" source & "${a}" target vs. ("${d.source.key}", "${d.target.key}").`);f=d}if(!f&&!r.multi&&h&&(f=n?h.undirected[a]:h.out[a]),f){const m=[f.key,!1,!1,!1];if(u?!l:!s)return m;if(u){const b=f.attributes;f.attributes=l(b),r.emit("edgeAttributesUpdated",{type:"replace",key:f.key,attributes:f.attributes})}else ae(f.attributes,s),r.emit("edgeAttributesUpdated",{type:"merge",key:f.key,attributes:f.attributes,data:s});return m}s=s||{},u&&l&&(s=l(s));const g={key:null,undirected:n,source:o,target:a,attributes:s};if(t)i=r._edgeKeyGenerator();else if(i=""+i,r._edges.has(i))throw new P(`Graph.${e}: the "${i}" edge already exists in the graph.`);let p=!1,v=!1;h||(h=Ko(r,o,{}),p=!0,o===a&&(c=h,v=!0)),c||(c=Ko(r,a,{}),v=!0),d=new Ar(n,i,h,c,s),r._edges.set(i,d);const y=o===a;return n?(h.undirectedDegree++,c.undirectedDegree++,y&&(h.undirectedLoops++,r._undirectedSelfLoopCount++)):(h.outDegree++,c.inDegree++,y&&(h.directedLoops++,r._directedSelfLoopCount++)),r.multi?d.attachMulti():d.attach(),n?r._undirectedSize++:r._directedSize++,g.key=i,r.emit("edgeAdded",g),[i,!0,p,v]}function Kt(r,e){r._edges.delete(e.key);const{source:t,target:n,attributes:i}=e,o=e.undirected,a=t===n;o?(t.undirectedDegree--,n.undirectedDegree--,a&&(t.undirectedLoops--,r._undirectedSelfLoopCount--)):(t.outDegree--,n.inDegree--,a&&(t.directedLoops--,r._directedSelfLoopCount--)),r.multi?e.detachMulti():e.detach(),o?r._undirectedSize--:r._directedSize--,r.emit("edgeDropped",{key:e.key,attributes:i,source:t.key,target:n.key,undirected:o})}class Y extends Rs.EventEmitter{constructor(e){if(super(),e=ae({},Oc,e),typeof e.multi!="boolean")throw new D(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!Pc.has(e.type))throw new D(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new D(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const t=e.type==="mixed"?Ds:e.type==="directed"?Ls:Ns;Me(this,"NodeDataClass",t);const n="geid_"+Mc()+"_";let i=0;const o=()=>{let a;do a=n+i++;while(this._edges.has(a));return a};Me(this,"_attributes",{}),Me(this,"_nodes",new Map),Me(this,"_edges",new Map),Me(this,"_directedSize",0),Me(this,"_undirectedSize",0),Me(this,"_directedSelfLoopCount",0),Me(this,"_undirectedSelfLoopCount",0),Me(this,"_edgeKeyGenerator",o),Me(this,"_options",e),Vo.forEach(a=>Me(this,a,this[a])),He(this,"order",()=>this._nodes.size),He(this,"size",()=>this._edges.size),He(this,"directedSize",()=>this._directedSize),He(this,"undirectedSize",()=>this._undirectedSize),He(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),He(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),He(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),He(this,"multi",this._options.multi),He(this,"type",this._options.type),He(this,"allowSelfLoops",this._options.allowSelfLoops),He(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,t){if(this.type==="undirected")return!1;if(arguments.length===1){const n=""+e,i=this._edges.get(n);return!!i&&!i.undirected}else if(arguments.length===2){e=""+e,t=""+t;const n=this._nodes.get(e);return n?n.out.hasOwnProperty(t):!1}throw new D(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,t){if(this.type==="directed")return!1;if(arguments.length===1){const n=""+e,i=this._edges.get(n);return!!i&&i.undirected}else if(arguments.length===2){e=""+e,t=""+t;const n=this._nodes.get(e);return n?n.undirected.hasOwnProperty(t):!1}throw new D(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,t){if(arguments.length===1){const n=""+e;return this._edges.has(n)}else if(arguments.length===2){e=""+e,t=""+t;const n=this._nodes.get(e);return n?typeof n.out<"u"&&n.out.hasOwnProperty(t)||typeof n.undirected<"u"&&n.undirected.hasOwnProperty(t):!1}throw new D(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,t){if(this.type==="undirected")return;if(e=""+e,t=""+t,this.multi)throw new P("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const n=this._nodes.get(e);if(!n)throw new S(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new S(`Graph.directedEdge: could not find the "${t}" target node in the graph.`);const i=n.out&&n.out[t]||void 0;if(i)return i.key}undirectedEdge(e,t){if(this.type==="directed")return;if(e=""+e,t=""+t,this.multi)throw new P("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const n=this._nodes.get(e);if(!n)throw new S(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new S(`Graph.undirectedEdge: could not find the "${t}" target node in the graph.`);const i=n.undirected&&n.undirected[t]||void 0;if(i)return i.key}edge(e,t){if(this.multi)throw new P("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new S(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new S(`Graph.edge: could not find the "${t}" target node in the graph.`);const i=n.out&&n.out[t]||n.undirected&&n.undirected[t]||void 0;if(i)return i.key}areDirectedNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new S(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.in||t in n.out}areOutNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new S(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.out}areInNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new S(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.in}areUndirectedNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new S(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:t in n.undirected}areNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new S(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(t in n.in||t in n.out)||this.type!=="directed"&&t in n.undirected}areInboundNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new S(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in n.in||this.type!=="directed"&&t in n.undirected}areOutboundNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new S(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in n.out||this.type!=="directed"&&t in n.undirected}inDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree}outDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree}directedDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree}undirectedDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree}inboundDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.inDegree),n}outboundDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.outDegree),n}degree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.degree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.inDegree+t.outDegree),n}inDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree-t.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree-t.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree-t.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree-t.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,i=0;return this.type!=="directed"&&(n+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.inDegree,i+=t.directedLoops),n-i}outboundDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,i=0;return this.type!=="directed"&&(n+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.outDegree,i+=t.directedLoops),n-i}degreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,i=0;return this.type!=="directed"&&(n+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.inDegree+t.outDegree,i+=t.directedLoops*2),n-i}source(e){e=""+e;const t=this._edges.get(e);if(!t)throw new S(`Graph.source: could not find the "${e}" edge in the graph.`);return t.source.key}target(e){e=""+e;const t=this._edges.get(e);if(!t)throw new S(`Graph.target: could not find the "${e}" edge in the graph.`);return t.target.key}extremities(e){e=""+e;const t=this._edges.get(e);if(!t)throw new S(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[t.source.key,t.target.key]}opposite(e,t){e=""+e,t=""+t;const n=this._edges.get(t);if(!n)throw new S(`Graph.opposite: could not find the "${t}" edge in the graph.`);const i=n.source.key,o=n.target.key;if(e===i)return o;if(e===o)return i;throw new S(`Graph.opposite: the "${e}" node is not attached to the "${t}" edge (${i}, ${o}).`)}hasExtremity(e,t){e=""+e,t=""+t;const n=this._edges.get(e);if(!n)throw new S(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return n.source.key===t||n.target.key===t}isUndirected(e){e=""+e;const t=this._edges.get(e);if(!t)throw new S(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return t.undirected}isDirected(e){e=""+e;const t=this._edges.get(e);if(!t)throw new S(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!t.undirected}isSelfLoop(e){e=""+e;const t=this._edges.get(e);if(!t)throw new S(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return t.source===t.target}addNode(e,t){return Uc(this,e,t).key}mergeNode(e,t){if(t&&!he(t))throw new D(`Graph.mergeNode: invalid attributes. Expecting an object but got "${t}"`);e=""+e,t=t||{};let n=this._nodes.get(e);return n?(t&&(ae(n.attributes,t),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:n.attributes,data:t})),[e,!1]):(n=new this.NodeDataClass(e,t),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:t}),[e,!0])}updateNode(e,t){if(t&&typeof t!="function")throw new D(`Graph.updateNode: invalid updater function. Expecting a function but got "${t}"`);e=""+e;let n=this._nodes.get(e);if(n){if(t){const o=n.attributes;n.attributes=t(o),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:n.attributes})}return[e,!1]}const i=t?t({}):{};return n=new this.NodeDataClass(e,i),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:i}),[e,!0]}dropNode(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new S(`Graph.dropNode: could not find the "${e}" node in the graph.`);let n;if(this.type!=="undirected"){for(const i in t.out){n=t.out[i];do Kt(this,n),n=n.next;while(n)}for(const i in t.in){n=t.in[i];do Kt(this,n),n=n.next;while(n)}}if(this.type!=="directed")for(const i in t.undirected){n=t.undirected[i];do Kt(this,n),n=n.next;while(n)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:t.attributes})}dropEdge(e){let t;if(arguments.length>1){const n=""+arguments[0],i=""+arguments[1];if(t=Oe(this,n,i,this.type),!t)throw new S(`Graph.dropEdge: could not find the "${n}" -> "${i}" edge in the graph.`)}else if(e=""+e,t=this._edges.get(e),!t)throw new S(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return Kt(this,t),this}dropDirectedEdge(e,t){if(arguments.length<2)throw new P("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new P("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,t=""+t;const n=Oe(this,e,t,"directed");if(!n)throw new S(`Graph.dropDirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return Kt(this,n),this}dropUndirectedEdge(e,t){if(arguments.length<2)throw new P("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new P("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const n=Oe(this,e,t,"undirected");if(!n)throw new S(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return Kt(this,n),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let t;for(;t=e.next(),t.done!==!0;)t.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,t){return this._attributes[e]=t,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,t){if(typeof t!="function")throw new D("Graph.updateAttribute: updater should be a function.");const n=this._attributes[e];return this._attributes[e]=t(n),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!he(e))throw new D("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!he(e))throw new D("Graph.mergeAttributes: provided attributes are not a plain object.");return ae(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new D("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,t){if(typeof e!="function")throw new D("Graph.updateEachNodeAttributes: expecting an updater function.");if(t&&!Wo(t))throw new D("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const n=this._nodes.values();let i,o;for(;i=n.next(),i.done!==!0;)o=i.value,o.attributes=e(o.key,o.attributes);this.emit("eachNodeAttributesUpdated",{hints:t||null})}updateEachEdgeAttributes(e,t){if(typeof e!="function")throw new D("Graph.updateEachEdgeAttributes: expecting an updater function.");if(t&&!Wo(t))throw new D("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const n=this._edges.values();let i,o,a,s;for(;i=n.next(),i.done!==!0;)o=i.value,a=o.source,s=o.target,o.attributes=e(o.key,o.attributes,a.key,s.key,a.attributes,s.attributes,o.undirected);this.emit("eachEdgeAttributesUpdated",{hints:t||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new D("Graph.forEachAdjacencyEntry: expecting a callback.");nn(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new D("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");nn(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new D("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");nn(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new D("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");nn(!1,!0,!0,this,e)}nodes(){return Array.from(this._nodes.keys())}forEachNode(e){if(typeof e!="function")throw new D("Graph.forEachNode: expecting a callback.");const t=this._nodes.values();let n,i;for(;n=t.next(),n.done!==!0;)i=n.value,e(i.key,i.attributes)}findNode(e){if(typeof e!="function")throw new D("Graph.findNode: expecting a callback.");const t=this._nodes.values();let n,i;for(;n=t.next(),n.done!==!0;)if(i=n.value,e(i.key,i.attributes))return i.key}mapNodes(e){if(typeof e!="function")throw new D("Graph.mapNode: expecting a callback.");const t=this._nodes.values();let n,i;const o=new Array(this.order);let a=0;for(;n=t.next(),n.done!==!0;)i=n.value,o[a++]=e(i.key,i.attributes);return o}someNode(e){if(typeof e!="function")throw new D("Graph.someNode: expecting a callback.");const t=this._nodes.values();let n,i;for(;n=t.next(),n.done!==!0;)if(i=n.value,e(i.key,i.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new D("Graph.everyNode: expecting a callback.");const t=this._nodes.values();let n,i;for(;n=t.next(),n.done!==!0;)if(i=n.value,!e(i.key,i.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new D("Graph.filterNodes: expecting a callback.");const t=this._nodes.values();let n,i;const o=[];for(;n=t.next(),n.done!==!0;)i=n.value,e(i.key,i.attributes)&&o.push(i.key);return o}reduceNodes(e,t){if(typeof e!="function")throw new D("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new D("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let n=t;const i=this._nodes.values();let o,a;for(;o=i.next(),o.done!==!0;)a=o.value,n=e(n,a.key,a.attributes);return n}nodeEntries(){const e=this._nodes.values();return{[Symbol.iterator](){return this},next(){const t=e.next();if(t.done)return t;const n=t.value;return{value:{node:n.key,attributes:n.attributes},done:!1}}}}export(){const e=new Array(this._nodes.size);let t=0;this._nodes.forEach((i,o)=>{e[t++]=Nc(o,i)});const n=new Array(this._edges.size);return t=0,this._edges.forEach((i,o)=>{n[t++]=Fc(this.type,o,i)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:n}}import(e,t=!1){if(e instanceof Y)return e.forEachNode((u,l)=>{t?this.mergeNode(u,l):this.addNode(u,l)}),e.forEachEdge((u,l,h,c,d,f,g)=>{t?g?this.mergeUndirectedEdgeWithKey(u,h,c,l):this.mergeDirectedEdgeWithKey(u,h,c,l):g?this.addUndirectedEdgeWithKey(u,h,c,l):this.addDirectedEdgeWithKey(u,h,c,l)}),this;if(!he(e))throw new D("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!he(e.attributes))throw new D("Graph.import: invalid attributes. Expecting a plain object.");t?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let n,i,o,a,s;if(e.nodes){if(o=e.nodes,!Array.isArray(o))throw new D("Graph.import: invalid nodes. Expecting an array.");for(n=0,i=o.length;n<i;n++){a=o[n],Gc(a);const{key:u,attributes:l}=a;t?this.mergeNode(u,l):this.addNode(u,l)}}if(e.edges){let u=!1;if(this.type==="undirected"&&(u=!0),o=e.edges,!Array.isArray(o))throw new D("Graph.import: invalid edges. Expecting an array.");for(n=0,i=o.length;n<i;n++){s=o[n],Ic(s);const{source:l,target:h,attributes:c,undirected:d=u}=s;let f;"key"in s?(f=t?d?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:d?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,f.call(this,s.key,l,h,c)):(f=t?d?this.mergeUndirectedEdge:this.mergeDirectedEdge:d?this.addUndirectedEdge:this.addDirectedEdge,f.call(this,l,h,c))}}return this}nullCopy(e){const t=new Y(ae({},this._options,e));return t.replaceAttributes(ae({},this.getAttributes())),t}emptyCopy(e){const t=this.nullCopy(e);return this._nodes.forEach((n,i)=>{const o=ae({},n.attributes);n=new t.NodeDataClass(i,o),t._nodes.set(i,n)}),t}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new P(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new P("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new P("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const t=this.emptyCopy(e),n=this._edges.values();let i,o;for(;i=n.next(),i.done!==!0;)o=i.value,Ps(t,"copy",!1,o.undirected,o.key,o.source.key,o.target.key,ae({},o.attributes));return t}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((o,a)=>{e[a]=o.attributes});const t={},n={};this._edges.forEach((o,a)=>{const s=o.undirected?"--":"->";let u="",l=o.source.key,h=o.target.key,c;o.undirected&&l>h&&(c=l,l=h,h=c);const d=`(${l})${s}(${h})`;a.startsWith("geid_")?this.multi&&(typeof n[d]>"u"?n[d]=0:n[d]++,u+=`${n[d]}. `):u+=`[${a}]: `,u+=d,t[u]=o.attributes});const i={};for(const o in this)this.hasOwnProperty(o)&&!Vo.has(o)&&typeof this[o]!="function"&&typeof o!="symbol"&&(i[o]=this[o]);return i.attributes=this._attributes,i.nodes=e,i.edges=t,Me(i,"constructor",this.constructor),i}}typeof Symbol<"u"&&(Y.prototype[Symbol.for("nodejs.util.inspect.custom")]=Y.prototype.inspect);$c.forEach(r=>{["add","merge","update"].forEach(e=>{const t=r.name(e),n=e==="add"?Ps:Bc;r.generateKey?Y.prototype[t]=function(i,o,a){return n(this,t,!0,(r.type||this.type)==="undirected",null,i,o,a,e==="update")}:Y.prototype[t]=function(i,o,a,s){return n(this,t,!1,(r.type||this.type)==="undirected",i,o,a,s,e==="update")}})});Xh(Y);sc(Y);Ac(Y);Lc(Y);class $s extends Y{constructor(e){const t=ae({type:"directed"},e);if("multi"in t&&t.multi!==!1)throw new D("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="directed")throw new D('DirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class Os extends Y{constructor(e){const t=ae({type:"undirected"},e);if("multi"in t&&t.multi!==!1)throw new D("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="undirected")throw new D('UndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class Us extends Y{constructor(e){const t=ae({multi:!0},e);if("multi"in t&&t.multi!==!0)throw new D("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(t)}}class Bs extends Y{constructor(e){const t=ae({type:"directed",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new D("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="directed")throw new D('MultiDirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class zs extends Y{constructor(e){const t=ae({type:"undirected",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new D("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="undirected")throw new D('MultiUndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}function xr(r){r.from=function(e,t){const n=ae({},e.options,t),i=new r(n);return i.import(e),i}}xr(Y);xr($s);xr(Os);xr(Us);xr(Bs);xr(zs);Y.Graph=Y;Y.DirectedGraph=$s;Y.UndirectedGraph=Os;Y.MultiGraph=Us;Y.MultiDirectedGraph=Bs;Y.MultiUndirectedGraph=zs;Y.InvalidArgumentsGraphError=D;Y.NotFoundGraphError=S;Y.UsageGraphError=P;var Sr={},zn=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"};const zc=Dh(zn);function ot(r){if(typeof r!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=r}typeof Symbol<"u"&&(ot.prototype[Symbol.iterator]=function(){return this});ot.of=function(){var r=arguments,e=r.length,t=0;return new ot(function(){return t>=e?{done:!0}:{done:!1,value:r[t++]}})};ot.empty=function(){var r=new ot(function(){return{done:!0}});return r};ot.fromSequence=function(r){var e=0,t=r.length;return new ot(function(){return e>=t?{done:!0}:{done:!1,value:r[e++]}})};ot.is=function(r){return r instanceof ot?!0:typeof r=="object"&&r!==null&&typeof r.next=="function"};var Hc=ot,oo={};oo.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";oo.SYMBOL_SUPPORT=typeof Symbol<"u";var Hs=oo,jc=Hs.ARRAY_BUFFER_SUPPORT,Wc=Hs.SYMBOL_SUPPORT,ao=function(e,t){var n,i,o,a,s;if(!e)throw new Error("obliterator/forEach: invalid iterable.");if(typeof t!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(e)||jc&&ArrayBuffer.isView(e)||typeof e=="string"||e.toString()==="[object Arguments]"){for(o=0,a=e.length;o<a;o++)t(e[o],o);return}if(typeof e.forEach=="function"){e.forEach(t);return}if(Wc&&Symbol.iterator in e&&typeof e.next!="function"&&(e=e[Symbol.iterator]()),typeof e.next=="function"){for(n=e,o=0;s=n.next(),s.done!==!0;)t(s.value,o),o++;return}for(i in e)e.hasOwnProperty(i)&&t(e[i],i)},js=Hc,Vc=ao;function oe(){this.clear()}oe.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};oe.prototype.enqueue=function(r){return this.items.push(r),++this.size};oe.prototype.dequeue=function(){if(this.size){var r=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,r}};oe.prototype.peek=function(){if(this.size)return this.items[this.offset]};oe.prototype.forEach=function(r,e){e=arguments.length>1?e:this;for(var t=this.offset,n=0,i=this.items.length;t<i;t++,n++)r.call(e,this.items[t],n,this)};oe.prototype.toArray=function(){return this.items.slice(this.offset)};oe.prototype.values=function(){var r=this.items,e=this.offset;return new js(function(){if(e>=r.length)return{done:!0};var t=r[e];return e++,{value:t,done:!1}})};oe.prototype.entries=function(){var r=this.items,e=this.offset,t=0;return new js(function(){if(e>=r.length)return{done:!0};var n=r[e];return e++,{value:[t++,n],done:!1}})};typeof Symbol<"u"&&(oe.prototype[Symbol.iterator]=oe.prototype.values);oe.prototype.toString=function(){return this.toArray().join(",")};oe.prototype.toJSON=function(){return this.toArray()};oe.prototype.inspect=function(){var r=this.toArray();return Object.defineProperty(r,"constructor",{value:oe,enumerable:!1}),r};typeof Symbol<"u"&&(oe.prototype[Symbol.for("nodejs.util.inspect.custom")]=oe.prototype.inspect);oe.from=function(r){var e=new oe;return Vc(r,function(t){e.enqueue(t)}),e};oe.of=function(){return oe.from(arguments)};var Kc=oe,Yc=function(e,t){var n=t.length;if(n!==0){var i=e.length;e.length+=n;for(var o=0;o<n;o++)e[i+o]=t[o]}},so=zn,qc=Kc,Xc=Yc;function Zc(r,e,t){if(!so(r))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!r.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');if(!r.hasNode(t))throw new Error('graphology-shortest-path: the "'+t+'" target node does not exist in the given graph.');if(e=""+e,t=""+t,e===t)return[e];var n=r.inboundNeighbors.bind(r),i=r.outboundNeighbors.bind(r),o={},a={};o[e]=null,a[t]=null;var s=[e],u=[t],l,h,c,d,f,g,p,v,y=!1;e:for(;s.length&&u.length;)if(s.length<=u.length){for(l=s,s=[],f=0,p=l.length;f<p;f++)for(h=l[f],c=i(h),g=0,v=c.length;g<v;g++)if(d=c[g],d in o||(s.push(d),o[d]=h),d in a){y=!0;break e}}else for(l=u,u=[],f=0,p=l.length;f<p;f++)for(h=l[f],c=n(h),g=0,v=c.length;g<v;g++)if(d=c[g],d in a||(u.push(d),a[d]=h),d in o){y=!0;break e}if(!y)return null;for(var m=[];d;)m.unshift(d),d=o[d];for(d=a[m[m.length-1]];d;)m.push(d),d=a[d];return m.length?m:null}function Jc(r,e){if(!so(r))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!r.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');e=""+e;var t={},n={},i,o,a,s,u,l;for(t[e]=!0,n[e]=[e];Object.keys(t).length;){i=t,t={};for(a in i)for(o=r.outboundNeighbors(a),u=0,l=o.length;u<l;u++)s=o[u],n[s]||(n[s]=n[a].concat(s),t[s]=!0)}return n}function Ws(r,e,t){if(!so(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!e.hasNode(t))throw new Error('graphology-shortest-path: the "'+t+'" source node does not exist in the given graph.');t=""+t;var n=new Set,i={},o=0;i[t]=0;for(var a=[t],s,u,l;a.length!==0;){var h=[];for(s=0,u=a.length;s<u;s++)l=a[s],!n.has(l)&&(n.add(l),Xc(h,e[r](l)),i[l]=o);o++,a=h}return i}var Qc=Ws.bind(null,"outboundNeighbors"),ed=Ws.bind(null,"neighbors");function td(r,e){e=""+e;var t=[],n={},i={},o=r.nodes(),a,s,u,l,h,c,d,f,g;for(c=0,f=o.length;c<f;c++)l=o[c],n[l]=[],i[l]=0;var p={};i[e]=1,p[e]=0;for(var v=qc.of(e);v.size;)for(l=v.dequeue(),t.push(l),a=p[l],s=i[l],u=r.outboundNeighbors(l),d=0,g=u.length;d<g;d++)h=u[d],h in p||(v.enqueue(h),p[h]=a+1),p[h]===a+1&&(i[h]+=s,n[h].push(l));return[t,n,i]}Sr.bidirectional=Zc;Sr.singleSource=Jc;Sr.singleSourceLength=Qc;Sr.undirectedSingleSourceLength=ed;Sr.brandes=td;var uo={},Vr={};function rd(r){return typeof r!="number"||isNaN(r)?1:r}function nd(r,e){var t={},n=function(a){return typeof a>"u"?e:a};typeof e=="function"&&(n=e);var i=function(a){return n(a[r])},o=function(){return n(void 0)};return typeof r=="string"?(t.fromAttributes=i,t.fromGraph=function(a,s){return i(a.getNodeAttributes(s))},t.fromEntry=function(a,s){return i(s)}):typeof r=="function"?(t.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},t.fromGraph=function(a,s){return n(r(s,a.getNodeAttributes(s)))},t.fromEntry=function(a,s){return n(r(a,s))}):(t.fromAttributes=o,t.fromGraph=o,t.fromEntry=o),t}function Vs(r,e){var t={},n=function(a){return typeof a>"u"?e:a};typeof e=="function"&&(n=e);var i=function(a){return n(a[r])},o=function(){return n(void 0)};return typeof r=="string"?(t.fromAttributes=i,t.fromGraph=function(a,s){return i(a.getEdgeAttributes(s))},t.fromEntry=function(a,s){return i(s)},t.fromPartialEntry=t.fromEntry,t.fromMinimalEntry=t.fromEntry):typeof r=="function"?(t.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},t.fromGraph=function(a,s){var u=a.extremities(s);return n(r(s,a.getEdgeAttributes(s),u[0],u[1],a.getNodeAttributes(u[0]),a.getNodeAttributes(u[1]),a.isUndirected(s)))},t.fromEntry=function(a,s,u,l,h,c,d){return n(r(a,s,u,l,h,c,d))},t.fromPartialEntry=function(a,s,u,l){return n(r(a,s,u,l))},t.fromMinimalEntry=function(a,s){return n(r(a,s))}):(t.fromAttributes=o,t.fromGraph=o,t.fromEntry=o,t.fromMinimalEntry=o),t}Vr.createNodeValueGetter=nd;Vr.createEdgeValueGetter=Vs;Vr.createEdgeWeightGetter=function(r){return Vs(r,rd)};var Kr={},id=function(r,e){return r<e?-1:r>e?1:0},od=function(r,e){return r<e?1:r>e?-1:0};function ad(r){return function(e,t){return r(t,e)}}function sd(r){return r===2?function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:e[1]<t[1]?-1:e[1]>t[1]?1:0}:function(e,t){for(var n=0;n<r;){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1;n++}return 0}}Kr.DEFAULT_COMPARATOR=id;Kr.DEFAULT_REVERSE_COMPARATOR=od;Kr.reverseComparator=ad;Kr.createTupleComparator=sd;var Yr={},Ks={};(function(r){var e=Math.pow(2,8)-1,t=Math.pow(2,16)-1,n=Math.pow(2,32)-1,i=Math.pow(2,7)-1,o=Math.pow(2,15)-1,a=Math.pow(2,31)-1;r.getPointerArray=function(u){var l=u-1;if(l<=e)return Uint8Array;if(l<=t)return Uint16Array;if(l<=n)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")},r.getSignedPointerArray=function(u){var l=u-1;return l<=i?Int8Array:l<=o?Int16Array:l<=a?Int32Array:Float64Array},r.getNumberType=function(u){return u===(u|0)?Math.sign(u)===-1?u<=127&&u>=-128?Int8Array:u<=32767&&u>=-32768?Int16Array:Int32Array:u<=255?Uint8Array:u<=65535?Uint16Array:Uint32Array:Float64Array};var s={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};r.getMinimalRepresentation=function(u,l){var h=null,c=0,d,f,g,p,v;for(p=0,v=u.length;p<v;p++)g=l?l(u[p]):u[p],f=r.getNumberType(g),d=s[f.name],d>c&&(c=d,h=f);return h},r.isTypedArray=function(u){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(u)},r.concat=function(){var u=0,l,h,c;for(l=0,c=arguments.length;l<c;l++)u+=arguments[l].length;var d=new arguments[0].constructor(u);for(l=0,h=0;l<c;l++)d.set(arguments[l],h),h+=arguments[l].length;return d},r.indices=function(u){for(var l=r.getPointerArray(u),h=new l(u),c=0;c<u;c++)h[c]=c;return h}})(Ks);var Ys=ao,qs=Ks;function ud(r){return Array.isArray(r)||qs.isTypedArray(r)}function lo(r){if(typeof r.length=="number")return r.length;if(typeof r.size=="number")return r.size}function ld(r){var e=lo(r),t=typeof e=="number"?new Array(e):[],n=0;return Ys(r,function(i){t[n++]=i}),t}function hd(r){var e=lo(r),t=typeof e=="number"?qs.getPointerArray(e):Array,n=typeof e=="number"?new Array(e):[],i=typeof e=="number"?new t(e):[],o=0;return Ys(r,function(a){n[o]=a,i[o]=o++}),[n,i]}Yr.isArrayLike=ud;Yr.guessLength=lo;Yr.toArray=ld;Yr.toArrayWithIndices=hd;var xn=ao,Xs=Kr,nt=Yr,Hn=Xs.DEFAULT_COMPARATOR,ho=Xs.reverseComparator;function co(r,e,t,n){for(var i=e[n],o,a;n>t;){if(o=n-1>>1,a=e[o],r(i,a)<0){e[n]=a,n=o;continue}break}e[n]=i}function qr(r,e,t){for(var n=e.length,i=t,o=e[t],a=2*t+1,s;a<n;)s=a+1,s<n&&r(e[a],e[s])>=0&&(a=s),e[t]=e[a],t=a,a=2*t+1;e[t]=o,co(r,e,i,t)}function Zs(r,e,t){e.push(t),co(r,e,0,e.length-1)}function fo(r,e){var t=e.pop();if(e.length!==0){var n=e[0];return e[0]=t,qr(r,e,0),n}return t}function ur(r,e,t){if(e.length===0)throw new Error("mnemonist/heap.replace: cannot pop an empty heap.");var n=e[0];return e[0]=t,qr(r,e,0),n}function Js(r,e,t){var n;return e.length!==0&&r(e[0],t)<0&&(n=e[0],e[0]=t,t=n,qr(r,e,0)),t}function Ht(r,e){for(var t=e.length,n=t>>1,i=n;--i>=0;)qr(r,e,i)}function go(r,e){for(var t=e.length,n=0,i=new Array(t);n<t;)i[n++]=fo(r,e);return i}function cd(r,e,t){arguments.length===2&&(t=e,e=r,r=Hn);var n=ho(r),i,o,a,s=1/0,u;if(e===1){if(nt.isArrayLike(t)){for(i=0,o=t.length;i<o;i++)a=t[i],(s===1/0||r(a,s)<0)&&(s=a);return u=new t.constructor(1),u[0]=s,u}return xn(t,function(h){(s===1/0||r(h,s)<0)&&(s=h)}),[s]}if(nt.isArrayLike(t)){if(e>=t.length)return t.slice().sort(r);for(u=t.slice(0,e),Ht(n,u),i=e,o=t.length;i<o;i++)n(t[i],u[0])>0&&ur(n,u,t[i]);return u.sort(r)}var l=nt.guessLength(t);return l!==null&&l<e&&(e=l),u=new Array(e),i=0,xn(t,function(h){i<e?u[i]=h:(i===e&&Ht(n,u),n(h,u[0])>0&&ur(n,u,h)),i++}),u.length>i&&(u.length=i),u.sort(r)}function dd(r,e,t){arguments.length===2&&(t=e,e=r,r=Hn);var n=ho(r),i,o,a,s=-1/0,u;if(e===1){if(nt.isArrayLike(t)){for(i=0,o=t.length;i<o;i++)a=t[i],(s===-1/0||r(a,s)>0)&&(s=a);return u=new t.constructor(1),u[0]=s,u}return xn(t,function(h){(s===-1/0||r(h,s)>0)&&(s=h)}),[s]}if(nt.isArrayLike(t)){if(e>=t.length)return t.slice().sort(n);for(u=t.slice(0,e),Ht(r,u),i=e,o=t.length;i<o;i++)r(t[i],u[0])>0&&ur(r,u,t[i]);return u.sort(n)}var l=nt.guessLength(t);return l!==null&&l<e&&(e=l),u=new Array(e),i=0,xn(t,function(h){i<e?u[i]=h:(i===e&&Ht(r,u),r(h,u[0])>0&&ur(r,u,h)),i++}),u.length>i&&(u.length=i),u.sort(n)}function q(r){if(this.clear(),this.comparator=r||Hn,typeof this.comparator!="function")throw new Error("mnemonist/Heap.constructor: given comparator should be a function.")}q.prototype.clear=function(){this.items=[],this.size=0};q.prototype.push=function(r){return Zs(this.comparator,this.items,r),++this.size};q.prototype.peek=function(){return this.items[0]};q.prototype.pop=function(){return this.size!==0&&this.size--,fo(this.comparator,this.items)};q.prototype.replace=function(r){return ur(this.comparator,this.items,r)};q.prototype.pushpop=function(r){return Js(this.comparator,this.items,r)};q.prototype.consume=function(){return this.size=0,go(this.comparator,this.items)};q.prototype.toArray=function(){return go(this.comparator,this.items.slice())};q.prototype.inspect=function(){var r=this.toArray();return Object.defineProperty(r,"constructor",{value:q,enumerable:!1}),r};typeof Symbol<"u"&&(q.prototype[Symbol.for("nodejs.util.inspect.custom")]=q.prototype.inspect);function Sn(r){if(this.clear(),this.comparator=r||Hn,typeof this.comparator!="function")throw new Error("mnemonist/MaxHeap.constructor: given comparator should be a function.");this.comparator=ho(this.comparator)}Sn.prototype=q.prototype;q.from=function(r,e){var t=new q(e),n;return nt.isArrayLike(r)?n=r.slice():n=nt.toArray(r),Ht(t.comparator,n),t.items=n,t.size=n.length,t};Sn.from=function(r,e){var t=new Sn(e),n;return nt.isArrayLike(r)?n=r.slice():n=nt.toArray(r),Ht(t.comparator,n),t.items=n,t.size=n.length,t};q.siftUp=qr;q.siftDown=co;q.push=Zs;q.pop=fo;q.replace=ur;q.pushpop=Js;q.heapify=Ht;q.consume=go;q.nsmallest=cd;q.nlargest=dd;q.MinHeap=q;q.MaxHeap=Sn;var Qs=q,eu=zn,po=Vr.createEdgeWeightGetter,Tn=Qs,vo="weight";function Di(r,e){return r[0]>e[0]?1:r[0]<e[0]?-1:r[1]>e[1]?1:r[1]<e[1]?-1:r[2]>e[2]?1:r[2]<e[2]?-1:0}function fd(r,e){return r[0]>e[0]?1:r[0]<e[0]?-1:r[1]>e[1]?1:r[1]<e[1]?-1:r[2]>e[2]?1:r[2]<e[2]?-1:r[3]>e[3]?1:r[3]<e[3]?-1:0}function gd(r,e,t,n){if(e=""+e,t=""+t,!eu(r))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");if(e&&!r.hasNode(e))throw new Error('graphology-shortest-path/dijkstra: the "'+e+'" source node does not exist in the given graph.');if(t&&!r.hasNode(t))throw new Error('graphology-shortest-path/dijkstra: the "'+t+'" target node does not exist in the given graph.');if(n=po(n||vo).fromMinimalEntry,e===t)return[0,[e]];var i=[{},{}],o=[{},{}],a=[new Tn(Di),new Tn(Di)],s=[{},{}];o[0][e]=[e],o[1][t]=[t],s[0][e]=0,s[1][t]=0;var u=[],l=1/0,h=0,c=1,d,f,g,p,v,y,m,b,_;for(a[0].push([0,h++,e]),a[1].push([0,h++,t]);a[0].size&&a[1].size;)if(c=1-c,d=a[c].pop(),p=d[0],v=d[2],!(v in i[c])){if(i[c][v]=p,v in i[1-c])return[l,u];for(f=c===1?r.inboundEdges(v):r.outboundEdges(v),b=0,_=f.length;b<_;b++){if(m=f[b],y=r.opposite(v,m),g=i[c][v]+n(m,r.getEdgeAttributes(m)),y in i[c]&&g<i[c][y])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(y in s[c])||g<s[c][y])&&(s[c][y]=g,a[c].push([g,h++,y]),o[c][y]=o[c][v].concat(y),y in s[0]&&y in s[1]&&(p=s[0][y]+s[1][y],(u.length===0||l>p)&&(l=p,u=o[0][y].concat(o[1][y].slice(0,-1).reverse()))))}}return[1/0,null]}function pd(r,e,t,n,i,o){if(!eu(r))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");t=po(t||vo).fromMinimalEntry;var a={},s={},u=new Tn(Di),l=0,h,c,d,f,g,p,v,y,m,b,_;for(y=0,b=e.length;y<b;y++)f=e[y],s[f]=0,u.push([0,l++,f]),o&&(o[f]=[f]);for(;u.size;)if(c=u.pop(),v=c[0],f=c[2],!(f in a)){if(a[f]=v,f===i)break;for(h=r.outboundEdges(f),m=0,_=h.length;m<_;m++){if(p=h[m],g=r.opposite(f,p),d=t(p,r.getEdgeAttributes(p))+a[f],g in a&&d<a[g])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(g in s)||d<s[g])&&(s[g]=d,u.push([d,l++,g]),o&&(o[g]=o[f].concat(g)))}}return a}function vd(r,e,t){var n={};return pd(r,[e],t,0,null,n),n}function md(r,e,t,n){return gd(r,e,t,n)[1]}function yd(r,e,t){e=""+e,t=po(t||vo).fromMinimalEntry;var n=[],i={},o={},a=r.nodes(),s,u,l,h,c,d,f,g,p,v;for(p=0,v=a.length;p<v;p++)d=a[p],i[d]=[],o[d]=0;var y={};o[e]=1;var m={};m[e]=0;var b=0,_=new Tn(fd);for(_.push([0,b++,e,e]);_.size;)if(u=_.pop(),h=u[0],l=u[2],d=u[3],!(d in y))for(o[d]+=o[l],n.push(d),y[d]=h,s=r.outboundEdges(d),p=0,v=s.length;p<v;p++)g=s[p],f=r.opposite(d,g),c=h+t(g,r.getEdgeAttributes(g)),!(f in y)&&(!(f in m)||c<m[f])?(m[f]=c,_.push([c,b++,d,f]),o[f]=0,i[f]=[d]):c===m[f]&&(o[f]+=o[d],i[f].push(d));return[n,i,o]}uo.bidirectional=md;uo.singleSource=vd;uo.brandes=yd;var bd={},_d=zn,wd=Vr.createEdgeWeightGetter,Ed=Qs,Ad="weight";function xd(r,e){return r[0]>e[0]?1:r[0]<e[0]?-1:r[1]>e[1]?1:r[1]<e[1]?-1:0}function Sd(r,e,t,n,i,o){if(!_d(r))throw new Error("graphology-shortest-path/astar: invalid graphology instance.");if(e&&!r.hasNode(e))throw new Error('graphology-shortest-path/astar: the "'+e+'" source node does not exist in the given graph.');if(t&&!r.hasNode(t))throw new Error('graphology-shortest-path/astar: the "'+t+'" target node does not exist in the given graph.');if(n=wd(n||Ad).fromMinimalEntry,e===t)return[e];i=i||function(){return 0},o=o||{};var a=0,s=new Ed(xd);s.push([0,a++,e,0,null]);var u={},l={},h,c,d,f,g,p,v,y,m,b,_,T;function A(E,G,R,I){if(T=c===R?I:R,b=n(E,G),b!==null){if(_=f+b,u.hasOwnProperty(T)){if(d=u[T],y=d[0],m=d[1],y<=_)return}else m=i(T,t);o.cutoff&&_+m>o.cutoff||(u[T]=[_,m],s.push([_+m,a++,T,_,c]))}}for(;s.size!==0;){if(h=s.pop(),c=h[2],f=h[3],g=h[4],c===t){for(p=[c],v=g;v!==null;)p.push(v),v=l[v];return p.reverse(),p}l.hasOwnProperty(c)&&(l[c]===null||(y=u[c][0],y<f))||(l[c]=g,r.forEachOutboundEdge(c,A))}return null}bd.bidirectional=Sd;var Xr=Sr,Td=Xr.bidirectional;Xr.singleSource;Xr.singleSourceLength;Xr.undirectedSingleSourceLength;Xr.brandes;const fe=Re(null),tu=Re(null),Li=Re(""),Ni=Re(new Set(["Character","Ability","Mechanic","Archetype"])),Fi=Re(new Set),Gi=Re(new Set),Qt=Re(null),Cd=Re(!1),Rt=Re(null),Ut=Re(null),lr=Re(null),hr=Re(null),Cn=Re("default"),Rd=ke(fe,r=>r?new wr(r.nodes,{keys:["properties.name","properties.description","id","label","properties.archetype"],threshold:.3}):null),ru=ke([Rd,Li],([r,e])=>{const t=e.trim();return!r||!t?[]:r.search(t,{limit:20}).map(n=>n.item)});function kd(r){const e=new Y({type:"undirected"});r.nodes.forEach(t=>e.addNode(t.id,{raw:t})),r.edges.forEach(t=>{e.hasEdge(t.id)||e.addEdgeWithKey(t.id,t.source,t.target,{raw:t})}),fe.set(r),tu.set(e)}const Dd=ke(fe,r=>r?Object.keys(r.meta.label_distribution).sort((e,t)=>e.localeCompare(t)):[]),Ld=ke(fe,r=>r?Object.keys(r.meta.archetype_counts).sort((e,t)=>e.localeCompare(t)):[]),Nd=ke(fe,r=>r?r.nodes.filter(e=>e.label==="Mechanic").map(e=>{var t;return(t=e.properties)==null?void 0:t.name}).sort((e,t)=>e.localeCompare(t)):[]);function Fd(r,e){var i,o;const t=((i=r.properties)==null?void 0:i.mechanics_used)??[],n=((o=r.properties)==null?void 0:o.mechanics_countered)??[];return t.includes(e)||n.includes(e)}const Gd=ke([fe,Ni,Fi,Qt],([r,e,t,n])=>r?r.nodes.filter(i=>{var o,a;if(!e.has(i.label))return!1;if(t.size>0&&i.label==="Character"){const s=(o=i.properties)==null?void 0:o.archetype;if(!s||!t.has(s))return!1}return!(n&&(i.label==="Mechanic"&&((a=i.properties)==null?void 0:a.name)!==n||i.label==="Character"&&!Fd(i,n)))}):[]),Id=ke(Gd,r=>new Set(r.map(e=>e.id))),Md=new Set(["STRONG_AGAINST","WEAK_AGAINST","EVEN_AGAINST"]);ke([fe,Id,Gi,Qt,Ut],([r,e,t,n,i])=>r?r.edges.filter(o=>{if(!e.has(o.source)||!e.has(o.target))return!1;const a=Md.has(o.type),s=i===o.id;return!(a&&t.size>0&&!t.has(o.type)&&!s||n&&(o.type==="USES_MECHANIC"||o.type==="CHARACTER_COUNTERS_MECHANIC")&&!o.target.endsWith(`:${n}`)&&!s)}):[]);const nu=ke([fe,Rt,Cd],([r,e,t])=>{const n=new Set;return!r||!e||!t||(n.add(e),(r.indexes.neighbors[e]??[]).forEach(o=>n.add(o))),n}),Pd=ke([fe,Rt,nu],([r,e,t])=>{const n=new Set;return!r||!e||t.size===0||r.edges.forEach(i=>{(i.source===e&&t.has(i.target)||i.target===e&&t.has(i.source))&&n.add(i.id)}),n}),Bt=Re([]);function iu(r,e){const t=sr(tu);if(!t||!r||!e||r===e){Bt.set([]);return}try{const n=Td(t,r,e);Bt.set(n??[])}catch{Bt.set([])}}function Yo(r){lr.set(r),iu(sr(lr),sr(hr))}function qo(r){hr.set(r),iu(sr(lr),sr(hr))}function $d(){lr.set(null),hr.set(null),Bt.set([])}const Od=ke([fe,Bt],([r,e])=>{const t=new Set;if(!r||!e||e.length<2)return t;for(let n=0;n<e.length-1;n++){const i=e[n],o=e[n+1],a=r.edges.find(s=>s.source===i&&s.target===o||s.source===o&&s.target===i);a&&t.add(a.id)}return t}),mo=ke(fe,r=>{const e=[],t=[];return r?(Object.keys(r.indexes.degrees_out??{}).forEach(n=>e.push({id:n,value:r.indexes.degrees_out[n]??0})),Object.keys(r.indexes.strong_against??{}).forEach(n=>t.push({id:n,value:(r.indexes.strong_against[n]??[]).length})),e.sort((n,i)=>i.value-n.value),t.sort((n,i)=>i.value-n.value),{outDegree:e,strongCount:t}):{outDegree:e,strongCount:t}}),yo=ke(fe,r=>r?Object.entries(r.indexes.mechanic_usage??{}).map(([e,t])=>{var n;return{name:e,usage:t,counter:((n=r.indexes.mechanic_counter)==null?void 0:n[e])??0}}).sort((e,t)=>t.usage-e.usage):[]);function Mr(r,e=0,t=1){return Math.min(t,Math.max(e,r))}function ti(r,e,t){const n=r.replace("#",""),i=e.replace("#",""),o=parseInt(n.slice(0,2),16),a=parseInt(n.slice(2,4),16),s=parseInt(n.slice(4,6),16),u=parseInt(i.slice(0,2),16),l=parseInt(i.slice(2,4),16),h=parseInt(i.slice(4,6),16),c=Math.round(o+(u-o)*t),d=Math.round(a+(l-a)*t),f=Math.round(s+(h-s)*t);return`#${c.toString(16).padStart(2,"0")}${d.toString(16).padStart(2,"0")}${f.toString(16).padStart(2,"0")}`}const Ud=ke([Cn,mo,yo,fe],([r,e,t,n])=>{var o,a;const i=new Map;if(!n)return i;if(r==="outDegree"||r==="strongCount"){const s=r==="outDegree"?e.outDegree:e.strongCount,u=((o=s[0])==null?void 0:o.value)??0;if(u<=0)return i;s.forEach(l=>{const h=n.nodes.find(f=>f.id===l.id),c=(h==null?void 0:h.size)??1.5,d=Mr(l.value/u);i.set(l.id,c+1.2*d)})}else if(r==="mechanicUsage"){const s=((a=t[0])==null?void 0:a.usage)??0;if(s<=0)return i;n.nodes.filter(u=>u.label==="Mechanic").forEach(u=>{var f;const l=(f=u.properties)==null?void 0:f.name,h=t.find(g=>g.name===l);if(!l||!h)return;const c=u.size??1.5,d=Mr(h.usage/s);i.set(u.id,c+1.5*d)})}return i}),Bd=ke([Cn,mo,yo,fe],([r,e,t,n])=>{var o,a,s;const i=new Map;if(!n)return i;if(r==="outDegree"){const u=((o=e.outDegree[0])==null?void 0:o.value)??0;e.outDegree.forEach(l=>{l.value>0&&i.set(l.id,ti("#bfdbfe","#1d4ed8",Mr(l.value/(u||1))))})}else if(r==="strongCount"){const u=((a=e.strongCount[0])==null?void 0:a.value)??0;e.strongCount.forEach(l=>{l.value>0&&i.set(l.id,ti("#fecaca","#b91c1c",Mr(l.value/(u||1))))})}else if(r==="mechanicUsage"){const u=((s=t[0])==null?void 0:s.usage)??0;n.nodes.filter(l=>l.label==="Mechanic").forEach(l=>{var d;const h=(d=l.properties)==null?void 0:d.name,c=t.find(f=>f.name===h);!h||!c||i.set(l.id,ti("#bbf7d0","#047857",Mr(c.usage/(u||1))))})}return i});function ri(r,e){r.update(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})}function zd(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function Pr(r){var e=zd(r,"string");return typeof e=="symbol"?e:e+""}function ye(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Xo(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,Pr(n.key),n)}}function be(r,e,t){return e&&Xo(r.prototype,e),t&&Xo(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function cr(r){return cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cr(r)}function ou(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ou=function(){return!!r})()}function Hd(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function jd(r,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hd(r)}function Ue(r,e,t){return e=cr(e),jd(r,ou()?Reflect.construct(e,t||[],cr(r).constructor):e.apply(r,t))}function Ii(r,e){return Ii=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Ii(r,e)}function Be(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Ii(r,e)}function Wd(r){if(Array.isArray(r))return r}function Vd(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(t=t.call(r)).next,e===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=o.call(t)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(h){l=!0,i=h}finally{try{if(!u&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}function Mi(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function au(r,e){if(r){if(typeof r=="string")return Mi(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Mi(r,e):void 0}}function Kd(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dr(r,e){return Wd(r)||Vd(r,e)||au(r,e)||Kd()}var ni={black:"#000000",silver:"#C0C0C0",gray:"#808080",grey:"#808080",white:"#FFFFFF",maroon:"#800000",red:"#FF0000",purple:"#800080",fuchsia:"#FF00FF",green:"#008000",lime:"#00FF00",olive:"#808000",yellow:"#FFFF00",navy:"#000080",blue:"#0000FF",teal:"#008080",aqua:"#00FFFF",darkblue:"#00008B",mediumblue:"#0000CD",darkgreen:"#006400",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",springgreen:"#00FF7F",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",rebeccapurple:"#663399",mediumaquamarine:"#66CDAA",dimgray:"#696969",dimgrey:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",slategrey:"#708090",lightslategray:"#778899",lightslategrey:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370DB",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",palevioletred:"#DB7093",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",lightyellow:"#FFFFE0",ivory:"#FFFFF0"},su=new Int8Array(4),ii=new Int32Array(su.buffer,0,1),Yd=new Float32Array(su.buffer,0,1),qd=/^\s*rgba?\s*\(/,Xd=/^\s*rgba?\s*\(\s*([0-9]*)\s*,\s*([0-9]*)\s*,\s*([0-9]*)(?:\s*,\s*(.*)?)?\)\s*$/;function Zd(r){var e=0,t=0,n=0,i=1;if(r[0]==="#")r.length===4?(e=parseInt(r.charAt(1)+r.charAt(1),16),t=parseInt(r.charAt(2)+r.charAt(2),16),n=parseInt(r.charAt(3)+r.charAt(3),16)):(e=parseInt(r.charAt(1)+r.charAt(2),16),t=parseInt(r.charAt(3)+r.charAt(4),16),n=parseInt(r.charAt(5)+r.charAt(6),16)),r.length===9&&(i=parseInt(r.charAt(7)+r.charAt(8),16)/255);else if(qd.test(r)){var o=r.match(Xd);o&&(e=+o[1],t=+o[2],n=+o[3],o[4]&&(i=+o[4]))}return{r:e,g:t,b:n,a:i}}var er={};for(var on in ni)er[on]=Zr(ni[on]),er[ni[on]]=er[on];function uu(r,e,t,n,i){return ii[0]=n<<24|t<<16|e<<8|r,ii[0]=ii[0]&4278190079,Yd[0]}function Zr(r){if(r=r.toLowerCase(),typeof er[r]<"u")return er[r];var e=Zd(r),t=e.r,n=e.g,i=e.b,o=e.a;o=o*255|0;var a=uu(t,n,i,o);return er[r]=a,a}var oi={};function lu(r){if(typeof oi[r]<"u")return oi[r];var e=(r&16711680)>>>16,t=(r&65280)>>>8,n=r&255,i=255,o=uu(e,t,n,i);return oi[r]=o,o}function Zo(r,e,t,n){return t+(e<<8)+(r<<16)}function Jo(r,e,t,n,i,o){var a=Math.floor(t/o*i),s=Math.floor(r.drawingBufferHeight/o-n/o*i),u=new Uint8Array(4);r.bindFramebuffer(r.FRAMEBUFFER,e),r.readPixels(a,s,1,1,r.RGBA,r.UNSIGNED_BYTE,u);var l=dr(u,4),h=l[0],c=l[1],d=l[2],f=l[3];return[h,c,d,f]}function w(r,e,t){return(e=Pr(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Qo(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function L(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Qo(Object(t),!0).forEach(function(n){w(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Qo(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Jd(r,e){for(;!{}.hasOwnProperty.call(r,e)&&(r=cr(r))!==null;);return r}function Pi(){return Pi=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(r,e,t){var n=Jd(r,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?r:t):i.value}},Pi.apply(null,arguments)}function hu(r,e,t,n){var i=Pi(cr(r.prototype),e,t);return typeof i=="function"?function(o){return i.apply(t,o)}:i}function Qd(r){return r.normalized?1:r.size}function ai(r){var e=0;return r.forEach(function(t){return e+=Qd(t)}),e}function cu(r,e,t){var n=r==="VERTEX"?e.VERTEX_SHADER:e.FRAGMENT_SHADER,i=e.createShader(n);if(i===null)throw new Error("loadShader: error while creating the shader");e.shaderSource(i,t),e.compileShader(i);var o=e.getShaderParameter(i,e.COMPILE_STATUS);if(!o){var a=e.getShaderInfoLog(i);throw e.deleteShader(i),new Error(`loadShader: error while compiling the shader:
`.concat(a,`
`).concat(t))}return i}function ef(r,e){return cu("VERTEX",r,e)}function tf(r,e){return cu("FRAGMENT",r,e)}function rf(r,e){var t=r.createProgram();if(t===null)throw new Error("loadProgram: error while creating the program.");var n,i;for(n=0,i=e.length;n<i;n++)r.attachShader(t,e[n]);r.linkProgram(t);var o=r.getProgramParameter(t,r.LINK_STATUS);if(!o)throw r.deleteProgram(t),new Error("loadProgram: error while linking the program.");return t}function ea(r){var e=r.gl,t=r.buffer,n=r.program,i=r.vertexShader,o=r.fragmentShader;e.deleteShader(i),e.deleteShader(o),e.deleteProgram(n),e.deleteBuffer(t)}var ta=`#define PICKING_MODE
`,nf=w(w(w(w(w(w(w(w({},WebGL2RenderingContext.BOOL,1),WebGL2RenderingContext.BYTE,1),WebGL2RenderingContext.UNSIGNED_BYTE,1),WebGL2RenderingContext.SHORT,2),WebGL2RenderingContext.UNSIGNED_SHORT,2),WebGL2RenderingContext.INT,4),WebGL2RenderingContext.UNSIGNED_INT,4),WebGL2RenderingContext.FLOAT,4),du=function(){function r(e,t,n){ye(this,r),w(this,"array",new Float32Array),w(this,"constantArray",new Float32Array),w(this,"capacity",0),w(this,"verticesCount",0);var i=this.getDefinition();if(this.VERTICES=i.VERTICES,this.VERTEX_SHADER_SOURCE=i.VERTEX_SHADER_SOURCE,this.FRAGMENT_SHADER_SOURCE=i.FRAGMENT_SHADER_SOURCE,this.UNIFORMS=i.UNIFORMS,this.ATTRIBUTES=i.ATTRIBUTES,this.METHOD=i.METHOD,this.CONSTANT_ATTRIBUTES="CONSTANT_ATTRIBUTES"in i?i.CONSTANT_ATTRIBUTES:[],this.CONSTANT_DATA="CONSTANT_DATA"in i?i.CONSTANT_DATA:[],this.isInstanced="CONSTANT_ATTRIBUTES"in i,this.ATTRIBUTES_ITEMS_COUNT=ai(this.ATTRIBUTES),this.STRIDE=this.VERTICES*this.ATTRIBUTES_ITEMS_COUNT,this.renderer=n,this.normalProgram=this.getProgramInfo("normal",e,i.VERTEX_SHADER_SOURCE,i.FRAGMENT_SHADER_SOURCE,null),this.pickProgram=t?this.getProgramInfo("pick",e,ta+i.VERTEX_SHADER_SOURCE,ta+i.FRAGMENT_SHADER_SOURCE,t):null,this.isInstanced){var o=ai(this.CONSTANT_ATTRIBUTES);if(this.CONSTANT_DATA.length!==this.VERTICES)throw new Error("Program: error while getting constant data (expected ".concat(this.VERTICES," items, received ").concat(this.CONSTANT_DATA.length," instead)"));this.constantArray=new Float32Array(this.CONSTANT_DATA.length*o);for(var a=0;a<this.CONSTANT_DATA.length;a++){var s=this.CONSTANT_DATA[a];if(s.length!==o)throw new Error("Program: error while getting constant data (one vector has ".concat(s.length," items instead of ").concat(o,")"));for(var u=0;u<s.length;u++)this.constantArray[a*o+u]=s[u]}this.STRIDE=this.ATTRIBUTES_ITEMS_COUNT}}return be(r,[{key:"kill",value:function(){ea(this.normalProgram),this.pickProgram&&(ea(this.pickProgram),this.pickProgram=null)}},{key:"getProgramInfo",value:function(t,n,i,o,a){var s=this.getDefinition(),u=n.createBuffer();if(u===null)throw new Error("Program: error while creating the WebGL buffer.");var l=ef(n,i),h=tf(n,o),c=rf(n,[l,h]),d={};s.UNIFORMS.forEach(function(p){var v=n.getUniformLocation(c,p);v&&(d[p]=v)});var f={};s.ATTRIBUTES.forEach(function(p){f[p.name]=n.getAttribLocation(c,p.name)});var g;if("CONSTANT_ATTRIBUTES"in s&&(s.CONSTANT_ATTRIBUTES.forEach(function(p){f[p.name]=n.getAttribLocation(c,p.name)}),g=n.createBuffer(),g===null))throw new Error("Program: error while creating the WebGL constant buffer.");return{name:t,program:c,gl:n,frameBuffer:a,buffer:u,constantBuffer:g||{},uniformLocations:d,attributeLocations:f,isPicking:t==="pick",vertexShader:l,fragmentShader:h}}},{key:"bindProgram",value:function(t){var n=this,i=0,o=t.gl,a=t.buffer;this.isInstanced?(o.bindBuffer(o.ARRAY_BUFFER,t.constantBuffer),i=0,this.CONSTANT_ATTRIBUTES.forEach(function(s){return i+=n.bindAttribute(s,t,i,!1)}),o.bufferData(o.ARRAY_BUFFER,this.constantArray,o.STATIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,t.buffer),i=0,this.ATTRIBUTES.forEach(function(s){return i+=n.bindAttribute(s,t,i,!0)}),o.bufferData(o.ARRAY_BUFFER,this.array,o.DYNAMIC_DRAW)):(o.bindBuffer(o.ARRAY_BUFFER,a),i=0,this.ATTRIBUTES.forEach(function(s){return i+=n.bindAttribute(s,t,i)}),o.bufferData(o.ARRAY_BUFFER,this.array,o.DYNAMIC_DRAW)),o.bindBuffer(o.ARRAY_BUFFER,null)}},{key:"unbindProgram",value:function(t){var n=this;this.isInstanced?(this.CONSTANT_ATTRIBUTES.forEach(function(i){return n.unbindAttribute(i,t,!1)}),this.ATTRIBUTES.forEach(function(i){return n.unbindAttribute(i,t,!0)})):this.ATTRIBUTES.forEach(function(i){return n.unbindAttribute(i,t)})}},{key:"bindAttribute",value:function(t,n,i,o){var a=nf[t.type];if(typeof a!="number")throw new Error('Program.bind: yet unsupported attribute type "'.concat(t.type,'"'));var s=n.attributeLocations[t.name],u=n.gl;if(s!==-1){u.enableVertexAttribArray(s);var l=this.isInstanced?(o?this.ATTRIBUTES_ITEMS_COUNT:ai(this.CONSTANT_ATTRIBUTES))*Float32Array.BYTES_PER_ELEMENT:this.ATTRIBUTES_ITEMS_COUNT*Float32Array.BYTES_PER_ELEMENT;if(u.vertexAttribPointer(s,t.size,t.type,t.normalized||!1,l,i),this.isInstanced&&o)if(u instanceof WebGL2RenderingContext)u.vertexAttribDivisor(s,1);else{var h=u.getExtension("ANGLE_instanced_arrays");h&&h.vertexAttribDivisorANGLE(s,1)}}return t.size*a}},{key:"unbindAttribute",value:function(t,n,i){var o=n.attributeLocations[t.name],a=n.gl;if(o!==-1&&(a.disableVertexAttribArray(o),this.isInstanced&&i))if(a instanceof WebGL2RenderingContext)a.vertexAttribDivisor(o,0);else{var s=a.getExtension("ANGLE_instanced_arrays");s&&s.vertexAttribDivisorANGLE(o,0)}}},{key:"reallocate",value:function(t){t!==this.capacity&&(this.capacity=t,this.verticesCount=this.VERTICES*t,this.array=new Float32Array(this.isInstanced?this.capacity*this.ATTRIBUTES_ITEMS_COUNT:this.verticesCount*this.ATTRIBUTES_ITEMS_COUNT))}},{key:"hasNothingToRender",value:function(){return this.verticesCount===0}},{key:"renderProgram",value:function(t,n){var i=n.gl,o=n.program;i.enable(i.BLEND),i.useProgram(o),this.setUniforms(t,n),this.drawWebGL(this.METHOD,n)}},{key:"render",value:function(t){this.hasNothingToRender()||(this.pickProgram&&(this.pickProgram.gl.viewport(0,0,t.width*t.pixelRatio/t.downSizingRatio,t.height*t.pixelRatio/t.downSizingRatio),this.bindProgram(this.pickProgram),this.renderProgram(L(L({},t),{},{pixelRatio:t.pixelRatio/t.downSizingRatio}),this.pickProgram),this.unbindProgram(this.pickProgram)),this.normalProgram.gl.viewport(0,0,t.width*t.pixelRatio,t.height*t.pixelRatio),this.bindProgram(this.normalProgram),this.renderProgram(t,this.normalProgram),this.unbindProgram(this.normalProgram))}},{key:"drawWebGL",value:function(t,n){var i=n.gl,o=n.frameBuffer;if(i.bindFramebuffer(i.FRAMEBUFFER,o),!this.isInstanced)i.drawArrays(t,0,this.verticesCount);else if(i instanceof WebGL2RenderingContext)i.drawArraysInstanced(t,0,this.VERTICES,this.capacity);else{var a=i.getExtension("ANGLE_instanced_arrays");a&&a.drawArraysInstancedANGLE(t,0,this.VERTICES,this.capacity)}}}])}(),of=function(r){function e(){return ye(this,e),Ue(this,e,arguments)}return Be(e,r),be(e,[{key:"kill",value:function(){hu(e,"kill",this)([])}},{key:"process",value:function(n,i,o){var a=i*this.STRIDE;if(o.hidden){for(var s=a+this.STRIDE;a<s;a++)this.array[a]=0;return}return this.processVisibleItem(lu(n),a,o)}}])}(du),bo=function(r){function e(){var t;ye(this,e);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return t=Ue(this,e,[].concat(i)),w(t,"drawLabel",void 0),t}return Be(e,r),be(e,[{key:"kill",value:function(){hu(e,"kill",this)([])}},{key:"process",value:function(n,i,o,a,s){var u=i*this.STRIDE;if(s.hidden||o.hidden||a.hidden){for(var l=u+this.STRIDE;u<l;u++)this.array[u]=0;return}return this.processVisibleItem(lu(n),u,o,a,s)}}])}(du);function af(r,e){return function(){function t(n,i,o){ye(this,t),w(this,"drawLabel",e),this.programs=r.map(function(a){return new a(n,i,o)})}return be(t,[{key:"reallocate",value:function(i){this.programs.forEach(function(o){return o.reallocate(i)})}},{key:"process",value:function(i,o,a,s,u){this.programs.forEach(function(l){return l.process(i,o,a,s,u)})}},{key:"render",value:function(i){this.programs.forEach(function(o){return o.render(i)})}},{key:"kill",value:function(){this.programs.forEach(function(i){return i.kill()})}}])}()}function sf(r,e,t,n,i){var o=i.edgeLabelSize,a=i.edgeLabelFont,s=i.edgeLabelWeight,u=i.edgeLabelColor.attribute?e[i.edgeLabelColor.attribute]||i.edgeLabelColor.color||"#000":i.edgeLabelColor.color,l=e.label;if(l){r.fillStyle=u,r.font="".concat(s," ").concat(o,"px ").concat(a);var h=t.size,c=n.size,d=t.x,f=t.y,g=n.x,p=n.y,v=(d+g)/2,y=(f+p)/2,m=g-d,b=p-f,_=Math.sqrt(m*m+b*b);if(!(_<h+c)){d+=m*h/_,f+=b*h/_,g-=m*c/_,p-=b*c/_,v=(d+g)/2,y=(f+p)/2,m=g-d,b=p-f,_=Math.sqrt(m*m+b*b);var T=r.measureText(l).width;if(T>_){var A="…";for(l=l+A,T=r.measureText(l).width;T>_&&l.length>1;)l=l.slice(0,-2)+A,T=r.measureText(l).width;if(l.length<4)return}var E;m>0?b>0?E=Math.acos(m/_):E=Math.asin(b/_):b>0?E=Math.acos(m/_)+Math.PI:E=Math.asin(m/_)+Math.PI/2,r.save(),r.translate(v,y),r.rotate(E),r.fillText(l,-T/2,e.size/2+o),r.restore()}}}function fu(r,e,t){if(e.label){var n=t.labelSize,i=t.labelFont,o=t.labelWeight,a=t.labelColor.attribute?e[t.labelColor.attribute]||t.labelColor.color||"#000":t.labelColor.color;r.fillStyle=a,r.font="".concat(o," ").concat(n,"px ").concat(i),r.fillText(e.label,e.x+e.size+3,e.y+n/3)}}function uf(r,e,t){var n=t.labelSize,i=t.labelFont,o=t.labelWeight;r.font="".concat(o," ").concat(n,"px ").concat(i),r.fillStyle="#FFF",r.shadowOffsetX=0,r.shadowOffsetY=0,r.shadowBlur=8,r.shadowColor="#000";var a=2;if(typeof e.label=="string"){var s=r.measureText(e.label).width,u=Math.round(s+5),l=Math.round(n+2*a),h=Math.max(e.size,n/2)+a,c=Math.asin(l/2/h),d=Math.sqrt(Math.abs(Math.pow(h,2)-Math.pow(l/2,2)));r.beginPath(),r.moveTo(e.x+d,e.y+l/2),r.lineTo(e.x+h+u,e.y+l/2),r.lineTo(e.x+h+u,e.y-l/2),r.lineTo(e.x+d,e.y-l/2),r.arc(e.x,e.y,h,c,-c),r.closePath(),r.fill()}else r.beginPath(),r.arc(e.x,e.y,e.size+a,0,Math.PI*2),r.closePath(),r.fill();r.shadowOffsetX=0,r.shadowOffsetY=0,r.shadowBlur=0,fu(r,e,t)}var lf=`
precision highp float;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;

uniform float u_correctionRatio;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float border = u_correctionRatio * 2.0;
  float dist = length(v_diffVector) - v_radius + border;

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
  if (dist > border)
    gl_FragColor = transparent;
  else
    gl_FragColor = v_color;

  #else
  float t = 0.0;
  if (dist > border)
    t = 1.0;
  else if (dist > 0.0)
    t = dist / border;

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,hf=lf,cf=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_border;

const float bias = 255.0 / 254.0;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,df=cf,gu=WebGLRenderingContext,ra=gu.UNSIGNED_BYTE,si=gu.FLOAT,ff=["u_sizeRatio","u_correctionRatio","u_matrix"],jn=function(r){function e(){return ye(this,e),Ue(this,e,arguments)}return Be(e,r),be(e,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:df,FRAGMENT_SHADER_SOURCE:hf,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:ff,ATTRIBUTES:[{name:"a_position",size:2,type:si},{name:"a_size",size:1,type:si},{name:"a_color",size:4,type:ra,normalized:!0},{name:"a_id",size:4,type:ra,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:si}],CONSTANT_DATA:[[e.ANGLE_1],[e.ANGLE_2],[e.ANGLE_3]]}}},{key:"processVisibleItem",value:function(n,i,o){var a=this.array,s=Zr(o.color);a[i++]=o.x,a[i++]=o.y,a[i++]=o.size,a[i++]=s,a[i++]=n}},{key:"setUniforms",value:function(n,i){var o=i.gl,a=i.uniformLocations,s=a.u_sizeRatio,u=a.u_correctionRatio,l=a.u_matrix;o.uniform1f(u,n.correctionRatio),o.uniform1f(s,n.sizeRatio),o.uniformMatrix3fv(l,!1,n.matrix)}}])}(of);w(jn,"ANGLE_1",0);w(jn,"ANGLE_2",2*Math.PI/3);w(jn,"ANGLE_3",4*Math.PI/3);var gf=`
precision mediump float;

varying vec4 v_color;

void main(void) {
  gl_FragColor = v_color;
}
`,pf=gf,vf=`
attribute vec2 a_position;
attribute vec2 a_normal;
attribute float a_radius;
attribute vec3 a_barycentric;

#ifdef PICKING_MODE
attribute vec4 a_id;
#else
attribute vec4 a_color;
#endif

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_widenessToThicknessRatio;

varying vec4 v_color;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // These first computations are taken from edge.vert.glsl and
  // edge.clamped.vert.glsl. Please read it to get better comments on what's
  // happening:
  float pixelsThickness = max(normalLength / u_sizeRatio, minThickness);
  float webGLThickness = pixelsThickness * u_correctionRatio;
  float webGLNodeRadius = a_radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  float webGLArrowHeadThickness = webGLThickness * u_widenessToThicknessRatio;

  float da = a_barycentric.x;
  float db = a_barycentric.y;
  float dc = a_barycentric.z;

  vec2 delta = vec2(
      da * (webGLNodeRadius * unitNormal.y)
    + db * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y + webGLArrowHeadThickness * unitNormal.x)
    + dc * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y - webGLArrowHeadThickness * unitNormal.x),

      da * (-webGLNodeRadius * unitNormal.x)
    + db * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x + webGLArrowHeadThickness * unitNormal.y)
    + dc * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x - webGLArrowHeadThickness * unitNormal.y)
  );

  vec2 position = (u_matrix * vec3(a_position + delta, 1)).xy;

  gl_Position = vec4(position, 0, 1);

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,mf=vf,pu=WebGLRenderingContext,na=pu.UNSIGNED_BYTE,an=pu.FLOAT,yf=["u_matrix","u_sizeRatio","u_correctionRatio","u_minEdgeThickness","u_lengthToThicknessRatio","u_widenessToThicknessRatio"],vu={extremity:"target",lengthToThicknessRatio:2.5,widenessToThicknessRatio:2};function mu(r){var e=L(L({},vu),{});return function(t){function n(){return ye(this,n),Ue(this,n,arguments)}return Be(n,t),be(n,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:mf,FRAGMENT_SHADER_SOURCE:pf,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:yf,ATTRIBUTES:[{name:"a_position",size:2,type:an},{name:"a_normal",size:2,type:an},{name:"a_radius",size:1,type:an},{name:"a_color",size:4,type:na,normalized:!0},{name:"a_id",size:4,type:na,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_barycentric",size:3,type:an}],CONSTANT_DATA:[[1,0,0],[0,1,0],[0,0,1]]}}},{key:"processVisibleItem",value:function(o,a,s,u,l){if(e.extremity==="source"){var h=[u,s];s=h[0],u=h[1]}var c=l.size||1,d=u.size||1,f=s.x,g=s.y,p=u.x,v=u.y,y=Zr(l.color),m=p-f,b=v-g,_=m*m+b*b,T=0,A=0;_&&(_=1/Math.sqrt(_),T=-b*_*c,A=m*_*c);var E=this.array;E[a++]=p,E[a++]=v,E[a++]=-T,E[a++]=-A,E[a++]=d,E[a++]=y,E[a++]=o}},{key:"setUniforms",value:function(o,a){var s=a.gl,u=a.uniformLocations,l=u.u_matrix,h=u.u_sizeRatio,c=u.u_correctionRatio,d=u.u_minEdgeThickness,f=u.u_lengthToThicknessRatio,g=u.u_widenessToThicknessRatio;s.uniformMatrix3fv(l,!1,o.matrix),s.uniform1f(h,o.sizeRatio),s.uniform1f(c,o.correctionRatio),s.uniform1f(d,o.minEdgeThickness),s.uniform1f(f,e.lengthToThicknessRatio),s.uniform1f(g,e.widenessToThicknessRatio)}}])}(bo)}mu();var bf=`
precision mediump float;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  // We only handle antialiasing for normal mode:
  #ifdef PICKING_MODE
  gl_FragColor = v_color;
  #else
  float dist = length(v_normal) * v_thickness;

  float t = smoothstep(
    v_thickness - v_feather,
    v_thickness,
    dist
  );

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,yu=bf,_f=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;
attribute float a_radius;
attribute float a_radiusCoef;

uniform mat3 u_matrix;
uniform float u_zoomRatio;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float radius = a_radius * a_radiusCoef;
  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // These first computations are taken from edge.vert.glsl. Please read it to
  // get better comments on what's happening:
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here, we move the point to leave space for the arrow head:
  float direction = sign(radius);
  float webGLNodeRadius = direction * radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;

  vec2 compensationVector = vec2(-direction * unitNormal.y, direction * unitNormal.x) * (webGLNodeRadius + webGLArrowHeadLength);

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness + compensationVector, 1)).xy, 0, 1);

  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,wf=_f,bu=WebGLRenderingContext,ia=bu.UNSIGNED_BYTE,Lt=bu.FLOAT,Ef=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness","u_lengthToThicknessRatio"],Af={lengthToThicknessRatio:vu.lengthToThicknessRatio};function _u(r){var e=L(L({},Af),{});return function(t){function n(){return ye(this,n),Ue(this,n,arguments)}return Be(n,t),be(n,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:wf,FRAGMENT_SHADER_SOURCE:yu,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Ef,ATTRIBUTES:[{name:"a_positionStart",size:2,type:Lt},{name:"a_positionEnd",size:2,type:Lt},{name:"a_normal",size:2,type:Lt},{name:"a_color",size:4,type:ia,normalized:!0},{name:"a_id",size:4,type:ia,normalized:!0},{name:"a_radius",size:1,type:Lt}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:Lt},{name:"a_normalCoef",size:1,type:Lt},{name:"a_radiusCoef",size:1,type:Lt}],CONSTANT_DATA:[[0,1,0],[0,-1,0],[1,1,1],[1,1,1],[0,-1,0],[1,-1,-1]]}}},{key:"processVisibleItem",value:function(o,a,s,u,l){var h=l.size||1,c=s.x,d=s.y,f=u.x,g=u.y,p=Zr(l.color),v=f-c,y=g-d,m=u.size||1,b=v*v+y*y,_=0,T=0;b&&(b=1/Math.sqrt(b),_=-y*b*h,T=v*b*h);var A=this.array;A[a++]=c,A[a++]=d,A[a++]=f,A[a++]=g,A[a++]=_,A[a++]=T,A[a++]=p,A[a++]=o,A[a++]=m}},{key:"setUniforms",value:function(o,a){var s=a.gl,u=a.uniformLocations,l=u.u_matrix,h=u.u_zoomRatio,c=u.u_feather,d=u.u_pixelRatio,f=u.u_correctionRatio,g=u.u_sizeRatio,p=u.u_minEdgeThickness,v=u.u_lengthToThicknessRatio;s.uniformMatrix3fv(l,!1,o.matrix),s.uniform1f(h,o.zoomRatio),s.uniform1f(g,o.sizeRatio),s.uniform1f(f,o.correctionRatio),s.uniform1f(d,o.pixelRatio),s.uniform1f(c,o.antiAliasingFeather),s.uniform1f(p,o.minEdgeThickness),s.uniform1f(v,e.lengthToThicknessRatio)}}])}(bo)}_u();function xf(r){return af([_u(),mu()])}var Sf=xf(),Tf=Sf,Cf=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_zoomRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // We require edges to be at least "minThickness" pixels thick *on screen*
  // (so we need to compensate the size ratio):
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);

  // Then, we need to retrieve the normalized thickness of the edge in the WebGL
  // referential (in a ([0, 1], [0, 1]) space), using our "magic" correction
  // ratio:
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness, 1)).xy, 0, 1);

  // For the fragment shader though, we need a thickness that takes the "magic"
  // correction ratio into account (as in webGLThickness), but so that the
  // antialiasing effect does not depend on the zoom level. So here's yet
  // another thickness version:
  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Rf=Cf,wu=WebGLRenderingContext,oa=wu.UNSIGNED_BYTE,kr=wu.FLOAT,kf=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness"],Df=function(r){function e(){return ye(this,e),Ue(this,e,arguments)}return Be(e,r),be(e,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Rf,FRAGMENT_SHADER_SOURCE:yu,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:kf,ATTRIBUTES:[{name:"a_positionStart",size:2,type:kr},{name:"a_positionEnd",size:2,type:kr},{name:"a_normal",size:2,type:kr},{name:"a_color",size:4,type:oa,normalized:!0},{name:"a_id",size:4,type:oa,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:kr},{name:"a_normalCoef",size:1,type:kr}],CONSTANT_DATA:[[0,1],[0,-1],[1,1],[1,1],[0,-1],[1,-1]]}}},{key:"processVisibleItem",value:function(n,i,o,a,s){var u=s.size||1,l=o.x,h=o.y,c=a.x,d=a.y,f=Zr(s.color),g=c-l,p=d-h,v=g*g+p*p,y=0,m=0;v&&(v=1/Math.sqrt(v),y=-p*v*u,m=g*v*u);var b=this.array;b[i++]=l,b[i++]=h,b[i++]=c,b[i++]=d,b[i++]=y,b[i++]=m,b[i++]=f,b[i++]=n}},{key:"setUniforms",value:function(n,i){var o=i.gl,a=i.uniformLocations,s=a.u_matrix,u=a.u_zoomRatio,l=a.u_feather,h=a.u_pixelRatio,c=a.u_correctionRatio,d=a.u_sizeRatio,f=a.u_minEdgeThickness;o.uniformMatrix3fv(s,!1,n.matrix),o.uniform1f(u,n.zoomRatio),o.uniform1f(d,n.sizeRatio),o.uniform1f(c,n.correctionRatio),o.uniform1f(h,n.pixelRatio),o.uniform1f(l,n.antiAliasingFeather),o.uniform1f(f,n.minEdgeThickness)}}])}(bo),_o=function(r){function e(){var t;return ye(this,e),t=Ue(this,e),t.rawEmitter=t,t}return Be(e,r),be(e)}(Rs.EventEmitter),Lf=function(e){return e},Nf=function(e){return e*e},Ff=function(e){return e*(2-e)},Gf=function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},If=function(e){return e*e*e},Mf=function(e){return--e*e*e+1},Pf=function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},$f={linear:Lf,quadraticIn:Nf,quadraticOut:Ff,quadraticInOut:Gf,cubicIn:If,cubicOut:Mf,cubicInOut:Pf},Of={easing:"quadraticInOut",duration:150};function We(){return Float32Array.of(1,0,0,0,1,0,0,0,1)}function sn(r,e,t){return r[0]=e,r[4]=typeof t=="number"?t:e,r}function aa(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[3]=-t,r[4]=n,r}function sa(r,e,t){return r[6]=e,r[7]=t,r}function wt(r,e){var t=r[0],n=r[1],i=r[2],o=r[3],a=r[4],s=r[5],u=r[6],l=r[7],h=r[8],c=e[0],d=e[1],f=e[2],g=e[3],p=e[4],v=e[5],y=e[6],m=e[7],b=e[8];return r[0]=c*t+d*o+f*u,r[1]=c*n+d*a+f*l,r[2]=c*i+d*s+f*h,r[3]=g*t+p*o+v*u,r[4]=g*n+p*a+v*l,r[5]=g*i+p*s+v*h,r[6]=y*t+m*o+b*u,r[7]=y*n+m*a+b*l,r[8]=y*i+m*s+b*h,r}function $i(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=r[0],i=r[1],o=r[3],a=r[4],s=r[6],u=r[7],l=e.x,h=e.y;return{x:l*n+h*o+s*t,y:l*i+h*a+u*t}}function Uf(r,e){var t=r.height/r.width,n=e.height/e.width;return t<1&&n>1||t>1&&n<1?1:Math.min(Math.max(n,1/n),Math.max(1/t,t))}function Dr(r,e,t,n,i){var o=r.angle,a=r.ratio,s=r.x,u=r.y,l=e.width,h=e.height,c=We(),d=Math.min(l,h)-2*n,f=Uf(e,t);return i?(wt(c,sa(We(),s,u)),wt(c,sn(We(),a)),wt(c,aa(We(),o)),wt(c,sn(We(),l/d/2/f,h/d/2/f))):(wt(c,sn(We(),2*(d/l)*f,2*(d/h)*f)),wt(c,aa(We(),-o)),wt(c,sn(We(),1/a)),wt(c,sa(We(),-s,-u))),c}function Bf(r,e,t){var n=$i(r,{x:Math.cos(e.angle),y:Math.sin(e.angle)},0),i=n.x,o=n.y;return 1/Math.sqrt(Math.pow(i,2)+Math.pow(o,2))/t.width}function zf(r){if(!r.order)return{x:[0,1],y:[0,1]};var e=1/0,t=-1/0,n=1/0,i=-1/0;return r.forEachNode(function(o,a){var s=a.x,u=a.y;s<e&&(e=s),s>t&&(t=s),u<n&&(n=u),u>i&&(i=u)}),{x:[e,t],y:[n,i]}}function Hf(r){if(!zc(r))throw new Error("Sigma: invalid graph instance.");r.forEachNode(function(e,t){if(!Number.isFinite(t.x)||!Number.isFinite(t.y))throw new Error("Sigma: Coordinates of node ".concat(e," are invalid. A node must have a numeric 'x' and 'y' attribute."))})}function jf(r,e,t){var n=document.createElement(r);if(e)for(var i in e)n.style[i]=e[i];if(t)for(var o in t)n.setAttribute(o,t[o]);return n}function ua(){return typeof window.devicePixelRatio<"u"?window.devicePixelRatio:1}function la(r,e,t){return t.sort(function(n,i){var o=e(n)||0,a=e(i)||0;return o<a?-1:o>a?1:0})}function ha(r){var e=dr(r.x,2),t=e[0],n=e[1],i=dr(r.y,2),o=i[0],a=i[1],s=Math.max(n-t,a-o),u=(n+t)/2,l=(a+o)/2;(s===0||Math.abs(s)===1/0||isNaN(s))&&(s=1),isNaN(u)&&(u=0),isNaN(l)&&(l=0);var h=function(d){return{x:.5+(d.x-u)/s,y:.5+(d.y-l)/s}};return h.applyTo=function(c){c.x=.5+(c.x-u)/s,c.y=.5+(c.y-l)/s},h.inverse=function(c){return{x:u+s*(c.x-.5),y:l+s*(c.y-.5)}},h.ratio=s,h}function Oi(r){"@babel/helpers - typeof";return Oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oi(r)}function ca(r,e){var t=e.size;if(t!==0){var n=r.length;r.length+=t;var i=0;e.forEach(function(o){r[n+i]=o,i++})}}function ui(r){r=r||{};for(var e=0,t=arguments.length<=1?0:arguments.length-1;e<t;e++){var n=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];n&&Object.assign(r,n)}return r}var wo={hideEdgesOnMove:!1,hideLabelsOnMove:!1,renderLabels:!0,renderEdgeLabels:!1,enableEdgeEvents:!1,defaultNodeColor:"#999",defaultNodeType:"circle",defaultEdgeColor:"#ccc",defaultEdgeType:"line",labelFont:"Arial",labelSize:14,labelWeight:"normal",labelColor:{color:"#000"},edgeLabelFont:"Arial",edgeLabelSize:14,edgeLabelWeight:"normal",edgeLabelColor:{attribute:"color"},stagePadding:30,defaultDrawEdgeLabel:sf,defaultDrawNodeLabel:fu,defaultDrawNodeHover:uf,minEdgeThickness:1.7,antiAliasingFeather:1,dragTimeout:100,draggedEventsTolerance:3,inertiaDuration:200,inertiaRatio:3,zoomDuration:250,zoomingRatio:1.7,doubleClickTimeout:300,doubleClickZoomingRatio:2.2,doubleClickZoomingDuration:200,tapMoveTolerance:10,zoomToSizeRatioFunction:Math.sqrt,itemSizesReference:"screen",autoRescale:!0,autoCenter:!0,labelDensity:1,labelGridCellSize:100,labelRenderedSizeThreshold:6,nodeReducer:null,edgeReducer:null,zIndex:!1,minCameraRatio:null,maxCameraRatio:null,enableCameraZooming:!0,enableCameraPanning:!0,enableCameraRotation:!0,cameraPanBoundaries:null,allowInvalidContainer:!1,nodeProgramClasses:{},nodeHoverProgramClasses:{},edgeProgramClasses:{}},Wf={circle:jn},Vf={arrow:Tf,line:Df};function li(r){if(typeof r.labelDensity!="number"||r.labelDensity<0)throw new Error("Settings: invalid `labelDensity`. Expecting a positive number.");var e=r.minCameraRatio,t=r.maxCameraRatio;if(typeof e=="number"&&typeof t=="number"&&t<e)throw new Error("Settings: invalid camera ratio boundaries. Expecting `maxCameraRatio` to be greater than `minCameraRatio`.")}function Kf(r){var e=ui({},wo,r);return e.nodeProgramClasses=ui({},Wf,e.nodeProgramClasses),e.edgeProgramClasses=ui({},Vf,e.edgeProgramClasses),e}var un=1.5,da=function(r){function e(){var t;return ye(this,e),t=Ue(this,e),w(t,"x",.5),w(t,"y",.5),w(t,"angle",0),w(t,"ratio",1),w(t,"minRatio",null),w(t,"maxRatio",null),w(t,"enabledZooming",!0),w(t,"enabledPanning",!0),w(t,"enabledRotation",!0),w(t,"clean",null),w(t,"nextFrame",null),w(t,"previousState",null),w(t,"enabled",!0),t.previousState=t.getState(),t}return Be(e,r),be(e,[{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"getState",value:function(){return{x:this.x,y:this.y,angle:this.angle,ratio:this.ratio}}},{key:"hasState",value:function(n){return this.x===n.x&&this.y===n.y&&this.ratio===n.ratio&&this.angle===n.angle}},{key:"getPreviousState",value:function(){var n=this.previousState;return n?{x:n.x,y:n.y,angle:n.angle,ratio:n.ratio}:null}},{key:"getBoundedRatio",value:function(n){var i=n;return typeof this.minRatio=="number"&&(i=Math.max(i,this.minRatio)),typeof this.maxRatio=="number"&&(i=Math.min(i,this.maxRatio)),i}},{key:"validateState",value:function(n){var i={};return this.enabledPanning&&typeof n.x=="number"&&(i.x=n.x),this.enabledPanning&&typeof n.y=="number"&&(i.y=n.y),this.enabledZooming&&typeof n.ratio=="number"&&(i.ratio=this.getBoundedRatio(n.ratio)),this.enabledRotation&&typeof n.angle=="number"&&(i.angle=n.angle),this.clean?this.clean(L(L({},this.getState()),i)):i}},{key:"isAnimated",value:function(){return!!this.nextFrame}},{key:"setState",value:function(n){if(!this.enabled)return this;this.previousState=this.getState();var i=this.validateState(n);return typeof i.x=="number"&&(this.x=i.x),typeof i.y=="number"&&(this.y=i.y),typeof i.ratio=="number"&&(this.ratio=i.ratio),typeof i.angle=="number"&&(this.angle=i.angle),this.hasState(this.previousState)||this.emit("updated",this.getState()),this}},{key:"updateState",value:function(n){return this.setState(n(this.getState())),this}},{key:"animate",value:function(n){var i=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;if(!a)return new Promise(function(f){return i.animate(n,o,f)});if(this.enabled){var s=L(L({},Of),o),u=this.validateState(n),l=typeof s.easing=="function"?s.easing:$f[s.easing],h=Date.now(),c=this.getState(),d=function(){var g=(Date.now()-h)/s.duration;if(g>=1){i.nextFrame=null,i.setState(u),i.animationCallback&&(i.animationCallback.call(null),i.animationCallback=void 0);return}var p=l(g),v={};typeof u.x=="number"&&(v.x=c.x+(u.x-c.x)*p),typeof u.y=="number"&&(v.y=c.y+(u.y-c.y)*p),i.enabledRotation&&typeof u.angle=="number"&&(v.angle=c.angle+(u.angle-c.angle)*p),typeof u.ratio=="number"&&(v.ratio=c.ratio+(u.ratio-c.ratio)*p),i.setState(v),i.nextFrame=requestAnimationFrame(d)};this.nextFrame?(cancelAnimationFrame(this.nextFrame),this.animationCallback&&this.animationCallback.call(null),this.nextFrame=requestAnimationFrame(d)):d(),this.animationCallback=a}}},{key:"animatedZoom",value:function(n){return n?typeof n=="number"?this.animate({ratio:this.ratio/n}):this.animate({ratio:this.ratio/(n.factor||un)},n):this.animate({ratio:this.ratio/un})}},{key:"animatedUnzoom",value:function(n){return n?typeof n=="number"?this.animate({ratio:this.ratio*n}):this.animate({ratio:this.ratio*(n.factor||un)},n):this.animate({ratio:this.ratio*un})}},{key:"animatedReset",value:function(n){return this.animate({x:.5,y:.5,ratio:1,angle:0},n)}},{key:"copy",value:function(){return e.from(this.getState())}}],[{key:"from",value:function(n){var i=new e;return i.setState(n)}}])}(_o);function Ke(r,e){var t=e.getBoundingClientRect();return{x:r.clientX-t.left,y:r.clientY-t.top}}function lt(r,e){var t=L(L({},Ke(r,e)),{},{sigmaDefaultPrevented:!1,preventSigmaDefault:function(){t.sigmaDefaultPrevented=!0},original:r});return t}function Lr(r){var e="x"in r?r:L(L({},r.touches[0]||r.previousTouches[0]),{},{original:r.original,sigmaDefaultPrevented:r.sigmaDefaultPrevented,preventSigmaDefault:function(){r.sigmaDefaultPrevented=!0,e.sigmaDefaultPrevented=!0}});return e}function Yf(r,e){return L(L({},lt(r,e)),{},{delta:Eu(r)})}var qf=2;function cn(r){for(var e=[],t=0,n=Math.min(r.length,qf);t<n;t++)e.push(r[t]);return e}function Nr(r,e,t){var n={touches:cn(r.touches).map(function(i){return Ke(i,t)}),previousTouches:e.map(function(i){return Ke(i,t)}),sigmaDefaultPrevented:!1,preventSigmaDefault:function(){n.sigmaDefaultPrevented=!0},original:r};return n}function Eu(r){if(typeof r.deltaY<"u")return r.deltaY*-3/360;if(typeof r.detail<"u")return r.detail/-9;throw new Error("Captor: could not extract delta from event.")}var Au=function(r){function e(t,n){var i;return ye(this,e),i=Ue(this,e),i.container=t,i.renderer=n,i}return Be(e,r),be(e)}(_o),Xf=["doubleClickTimeout","doubleClickZoomingDuration","doubleClickZoomingRatio","dragTimeout","draggedEventsTolerance","inertiaDuration","inertiaRatio","zoomDuration","zoomingRatio"],Zf=Xf.reduce(function(r,e){return L(L({},r),{},w({},e,wo[e]))},{}),Jf=function(r){function e(t,n){var i;return ye(this,e),i=Ue(this,e,[t,n]),w(i,"enabled",!0),w(i,"draggedEvents",0),w(i,"downStartTime",null),w(i,"lastMouseX",null),w(i,"lastMouseY",null),w(i,"isMouseDown",!1),w(i,"isMoving",!1),w(i,"movingTimeout",null),w(i,"startCameraState",null),w(i,"clicks",0),w(i,"doubleClickTimeout",null),w(i,"currentWheelDirection",0),w(i,"settings",Zf),i.handleClick=i.handleClick.bind(i),i.handleRightClick=i.handleRightClick.bind(i),i.handleDown=i.handleDown.bind(i),i.handleUp=i.handleUp.bind(i),i.handleMove=i.handleMove.bind(i),i.handleWheel=i.handleWheel.bind(i),i.handleLeave=i.handleLeave.bind(i),i.handleEnter=i.handleEnter.bind(i),t.addEventListener("click",i.handleClick,{capture:!1}),t.addEventListener("contextmenu",i.handleRightClick,{capture:!1}),t.addEventListener("mousedown",i.handleDown,{capture:!1}),t.addEventListener("wheel",i.handleWheel,{capture:!1}),t.addEventListener("mouseleave",i.handleLeave,{capture:!1}),t.addEventListener("mouseenter",i.handleEnter,{capture:!1}),document.addEventListener("mousemove",i.handleMove,{capture:!1}),document.addEventListener("mouseup",i.handleUp,{capture:!1}),i}return Be(e,r),be(e,[{key:"kill",value:function(){var n=this.container;n.removeEventListener("click",this.handleClick),n.removeEventListener("contextmenu",this.handleRightClick),n.removeEventListener("mousedown",this.handleDown),n.removeEventListener("wheel",this.handleWheel),n.removeEventListener("mouseleave",this.handleLeave),n.removeEventListener("mouseenter",this.handleEnter),document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)}},{key:"handleClick",value:function(n){var i=this;if(this.enabled){if(this.clicks++,this.clicks===2)return this.clicks=0,typeof this.doubleClickTimeout=="number"&&(clearTimeout(this.doubleClickTimeout),this.doubleClickTimeout=null),this.handleDoubleClick(n);setTimeout(function(){i.clicks=0,i.doubleClickTimeout=null},this.settings.doubleClickTimeout),this.draggedEvents<this.settings.draggedEventsTolerance&&this.emit("click",lt(n,this.container))}}},{key:"handleRightClick",value:function(n){this.enabled&&this.emit("rightClick",lt(n,this.container))}},{key:"handleDoubleClick",value:function(n){if(this.enabled){n.preventDefault(),n.stopPropagation();var i=lt(n,this.container);if(this.emit("doubleClick",i),!i.sigmaDefaultPrevented){var o=this.renderer.getCamera(),a=o.getBoundedRatio(o.getState().ratio/this.settings.doubleClickZoomingRatio);o.animate(this.renderer.getViewportZoomedState(Ke(n,this.container),a),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}}},{key:"handleDown",value:function(n){if(this.enabled){if(n.button===0){this.startCameraState=this.renderer.getCamera().getState();var i=Ke(n,this.container),o=i.x,a=i.y;this.lastMouseX=o,this.lastMouseY=a,this.draggedEvents=0,this.downStartTime=Date.now(),this.isMouseDown=!0}this.emit("mousedown",lt(n,this.container))}}},{key:"handleUp",value:function(n){var i=this;if(!(!this.enabled||!this.isMouseDown)){var o=this.renderer.getCamera();this.isMouseDown=!1,typeof this.movingTimeout=="number"&&(clearTimeout(this.movingTimeout),this.movingTimeout=null);var a=Ke(n,this.container),s=a.x,u=a.y,l=o.getState(),h=o.getPreviousState()||{x:0,y:0};this.isMoving?o.animate({x:l.x+this.settings.inertiaRatio*(l.x-h.x),y:l.y+this.settings.inertiaRatio*(l.y-h.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"}):(this.lastMouseX!==s||this.lastMouseY!==u)&&o.setState({x:l.x,y:l.y}),this.isMoving=!1,setTimeout(function(){var c=i.draggedEvents>0;i.draggedEvents=0,c&&i.renderer.getSetting("hideEdgesOnMove")&&i.renderer.refresh()},0),this.emit("mouseup",lt(n,this.container))}}},{key:"handleMove",value:function(n){var i=this;if(this.enabled){var o=lt(n,this.container);if(this.emit("mousemovebody",o),(n.target===this.container||n.composedPath()[0]===this.container)&&this.emit("mousemove",o),!o.sigmaDefaultPrevented&&this.isMouseDown){this.isMoving=!0,this.draggedEvents++,typeof this.movingTimeout=="number"&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){i.movingTimeout=null,i.isMoving=!1},this.settings.dragTimeout);var a=this.renderer.getCamera(),s=Ke(n,this.container),u=s.x,l=s.y,h=this.renderer.viewportToFramedGraph({x:this.lastMouseX,y:this.lastMouseY}),c=this.renderer.viewportToFramedGraph({x:u,y:l}),d=h.x-c.x,f=h.y-c.y,g=a.getState(),p=g.x+d,v=g.y+f;a.setState({x:p,y:v}),this.lastMouseX=u,this.lastMouseY=l,n.preventDefault(),n.stopPropagation()}}}},{key:"handleLeave",value:function(n){this.emit("mouseleave",lt(n,this.container))}},{key:"handleEnter",value:function(n){this.emit("mouseenter",lt(n,this.container))}},{key:"handleWheel",value:function(n){var i=this,o=this.renderer.getCamera();if(!(!this.enabled||!o.enabledZooming)){var a=Eu(n);if(a){var s=Yf(n,this.container);if(this.emit("wheel",s),s.sigmaDefaultPrevented){n.preventDefault(),n.stopPropagation();return}var u=o.getState().ratio,l=a>0?1/this.settings.zoomingRatio:this.settings.zoomingRatio,h=o.getBoundedRatio(u*l),c=a>0?1:-1,d=Date.now();u!==h&&(n.preventDefault(),n.stopPropagation(),!(this.currentWheelDirection===c&&this.lastWheelTriggerTime&&d-this.lastWheelTriggerTime<this.settings.zoomDuration/5)&&(o.animate(this.renderer.getViewportZoomedState(Ke(n,this.container),h),{easing:"quadraticOut",duration:this.settings.zoomDuration},function(){i.currentWheelDirection=0}),this.currentWheelDirection=c,this.lastWheelTriggerTime=d))}}}},{key:"setSettings",value:function(n){this.settings=n}}])}(Au),Qf=["dragTimeout","inertiaDuration","inertiaRatio","doubleClickTimeout","doubleClickZoomingRatio","doubleClickZoomingDuration","tapMoveTolerance"],eg=Qf.reduce(function(r,e){return L(L({},r),{},w({},e,wo[e]))},{}),tg=function(r){function e(t,n){var i;return ye(this,e),i=Ue(this,e,[t,n]),w(i,"enabled",!0),w(i,"isMoving",!1),w(i,"hasMoved",!1),w(i,"touchMode",0),w(i,"startTouchesPositions",[]),w(i,"lastTouches",[]),w(i,"lastTap",null),w(i,"settings",eg),i.handleStart=i.handleStart.bind(i),i.handleLeave=i.handleLeave.bind(i),i.handleMove=i.handleMove.bind(i),t.addEventListener("touchstart",i.handleStart,{capture:!1}),t.addEventListener("touchcancel",i.handleLeave,{capture:!1}),document.addEventListener("touchend",i.handleLeave,{capture:!1,passive:!1}),document.addEventListener("touchmove",i.handleMove,{capture:!1,passive:!1}),i}return Be(e,r),be(e,[{key:"kill",value:function(){var n=this.container;n.removeEventListener("touchstart",this.handleStart),n.removeEventListener("touchcancel",this.handleLeave),document.removeEventListener("touchend",this.handleLeave),document.removeEventListener("touchmove",this.handleMove)}},{key:"getDimensions",value:function(){return{width:this.container.offsetWidth,height:this.container.offsetHeight}}},{key:"handleStart",value:function(n){var i=this;if(this.enabled){n.preventDefault();var o=cn(n.touches);if(this.touchMode=o.length,this.startCameraState=this.renderer.getCamera().getState(),this.startTouchesPositions=o.map(function(f){return Ke(f,i.container)}),this.touchMode===2){var a=dr(this.startTouchesPositions,2),s=a[0],u=s.x,l=s.y,h=a[1],c=h.x,d=h.y;this.startTouchesAngle=Math.atan2(d-l,c-u),this.startTouchesDistance=Math.sqrt(Math.pow(c-u,2)+Math.pow(d-l,2))}this.emit("touchdown",Nr(n,this.lastTouches,this.container)),this.lastTouches=o,this.lastTouchesPositions=this.startTouchesPositions}}},{key:"handleLeave",value:function(n){if(!(!this.enabled||!this.startTouchesPositions.length)){switch(n.cancelable&&n.preventDefault(),this.movingTimeout&&(this.isMoving=!1,clearTimeout(this.movingTimeout)),this.touchMode){case 2:if(n.touches.length===1){this.handleStart(n),n.preventDefault();break}case 1:if(this.isMoving){var i=this.renderer.getCamera(),o=i.getState(),a=i.getPreviousState()||{x:0,y:0};i.animate({x:o.x+this.settings.inertiaRatio*(o.x-a.x),y:o.y+this.settings.inertiaRatio*(o.y-a.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"})}this.hasMoved=!1,this.isMoving=!1,this.touchMode=0;break}if(this.emit("touchup",Nr(n,this.lastTouches,this.container)),!n.touches.length){var s=Ke(this.lastTouches[0],this.container),u=this.startTouchesPositions[0],l=Math.pow(s.x-u.x,2)+Math.pow(s.y-u.y,2);if(!n.touches.length&&l<Math.pow(this.settings.tapMoveTolerance,2))if(this.lastTap&&Date.now()-this.lastTap.time<this.settings.doubleClickTimeout){var h=Nr(n,this.lastTouches,this.container);if(this.emit("doubletap",h),this.lastTap=null,!h.sigmaDefaultPrevented){var c=this.renderer.getCamera(),d=c.getBoundedRatio(c.getState().ratio/this.settings.doubleClickZoomingRatio);c.animate(this.renderer.getViewportZoomedState(s,d),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}else{var f=Nr(n,this.lastTouches,this.container);this.emit("tap",f),this.lastTap={time:Date.now(),position:f.touches[0]||f.previousTouches[0]}}}this.lastTouches=cn(n.touches),this.startTouchesPositions=[]}}},{key:"handleMove",value:function(n){var i=this;if(!(!this.enabled||!this.startTouchesPositions.length)){n.preventDefault();var o=cn(n.touches),a=o.map(function(ne){return Ke(ne,i.container)}),s=this.lastTouches;this.lastTouches=o,this.lastTouchesPositions=a;var u=Nr(n,s,this.container);if(this.emit("touchmove",u),!u.sigmaDefaultPrevented&&(this.hasMoved||(this.hasMoved=a.some(function(ne,ge){var se=i.startTouchesPositions[ge];return se&&(ne.x!==se.x||ne.y!==se.y)})),!!this.hasMoved)){this.isMoving=!0,this.movingTimeout&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){i.isMoving=!1},this.settings.dragTimeout);var l=this.renderer.getCamera(),h=this.startCameraState,c=this.renderer.getSetting("stagePadding");switch(this.touchMode){case 1:{var d=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0]),f=d.x,g=d.y,p=this.renderer.viewportToFramedGraph(a[0]),v=p.x,y=p.y;l.setState({x:h.x+f-v,y:h.y+g-y});break}case 2:{var m={x:.5,y:.5,angle:0,ratio:1},b=a[0],_=b.x,T=b.y,A=a[1],E=A.x,G=A.y,R=Math.atan2(G-T,E-_)-this.startTouchesAngle,I=Math.hypot(G-T,E-_)/this.startTouchesDistance,k=l.getBoundedRatio(h.ratio/I);m.ratio=k,m.angle=h.angle+R;var C=this.getDimensions(),U=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0],{cameraState:h}),N=Math.min(C.width,C.height)-2*c,B=N/C.width,j=N/C.height,ue=k/N,re=_-N/2/B,J=T-N/2/j,Q=[re*Math.cos(-m.angle)-J*Math.sin(-m.angle),J*Math.cos(-m.angle)+re*Math.sin(-m.angle)];re=Q[0],J=Q[1],m.x=U.x-re*ue,m.y=U.y+J*ue,l.setState(m);break}}}}}},{key:"setSettings",value:function(n){this.settings=n}}])}(Au);function rg(r){if(Array.isArray(r))return Mi(r)}function ng(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function ig(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fa(r){return rg(r)||ng(r)||au(r)||ig()}function og(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}function hi(r,e){if(r==null)return{};var t,n,i=og(r,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(n=0;n<o.length;n++)t=o[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}var ga=function(){function r(e,t){ye(this,r),this.key=e,this.size=t}return be(r,null,[{key:"compare",value:function(t,n){return t.size>n.size?-1:t.size<n.size||t.key>n.key?1:-1}}])}(),pa=function(){function r(){ye(this,r),w(this,"width",0),w(this,"height",0),w(this,"cellSize",0),w(this,"columns",0),w(this,"rows",0),w(this,"cells",{})}return be(r,[{key:"resizeAndClear",value:function(t,n){this.width=t.width,this.height=t.height,this.cellSize=n,this.columns=Math.ceil(t.width/n),this.rows=Math.ceil(t.height/n),this.cells={}}},{key:"getIndex",value:function(t){var n=Math.floor(t.x/this.cellSize),i=Math.floor(t.y/this.cellSize);return i*this.columns+n}},{key:"add",value:function(t,n,i){var o=new ga(t,n),a=this.getIndex(i),s=this.cells[a];s||(s=[],this.cells[a]=s),s.push(o)}},{key:"organize",value:function(){for(var t in this.cells){var n=this.cells[t];n.sort(ga.compare)}}},{key:"getLabelsToDisplay",value:function(t,n){var i=this.cellSize*this.cellSize,o=i/t/t,a=o*n/i,s=Math.ceil(a),u=[];for(var l in this.cells)for(var h=this.cells[l],c=0;c<Math.min(s,h.length);c++)u.push(h[c].key);return u}}])}();function ag(r){var e=r.graph,t=r.hoveredNode,n=r.highlightedNodes,i=r.displayedNodeLabels,o=[];return e.forEachEdge(function(a,s,u,l){(u===t||l===t||n.has(u)||n.has(l)||i.has(u)&&i.has(l))&&o.push(a)}),o}var va=150,ma=50,ht=Object.prototype.hasOwnProperty;function sg(r,e,t){if(!ht.call(t,"x")||!ht.call(t,"y"))throw new Error('Sigma: could not find a valid position (x, y) for node "'.concat(e,'". All your nodes must have a number "x" and "y". Maybe your forgot to apply a layout or your "nodeReducer" is not returning the correct data?'));return t.color||(t.color=r.defaultNodeColor),!t.label&&t.label!==""&&(t.label=null),t.label!==void 0&&t.label!==null?t.label=""+t.label:t.label=null,t.size||(t.size=2),ht.call(t,"hidden")||(t.hidden=!1),ht.call(t,"highlighted")||(t.highlighted=!1),ht.call(t,"forceLabel")||(t.forceLabel=!1),(!t.type||t.type==="")&&(t.type=r.defaultNodeType),t.zIndex||(t.zIndex=0),t}function ug(r,e,t){return t.color||(t.color=r.defaultEdgeColor),t.label||(t.label=""),t.size||(t.size=.5),ht.call(t,"hidden")||(t.hidden=!1),ht.call(t,"forceLabel")||(t.forceLabel=!1),(!t.type||t.type==="")&&(t.type=r.defaultEdgeType),t.zIndex||(t.zIndex=0),t}var lg=function(r){function e(t,n){var i,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(ye(this,e),i=Ue(this,e),w(i,"elements",{}),w(i,"canvasContexts",{}),w(i,"webGLContexts",{}),w(i,"pickingLayers",new Set),w(i,"textures",{}),w(i,"frameBuffers",{}),w(i,"activeListeners",{}),w(i,"labelGrid",new pa),w(i,"nodeDataCache",{}),w(i,"edgeDataCache",{}),w(i,"nodeProgramIndex",{}),w(i,"edgeProgramIndex",{}),w(i,"nodesWithForcedLabels",new Set),w(i,"edgesWithForcedLabels",new Set),w(i,"nodeExtent",{x:[0,1],y:[0,1]}),w(i,"nodeZExtent",[1/0,-1/0]),w(i,"edgeZExtent",[1/0,-1/0]),w(i,"matrix",We()),w(i,"invMatrix",We()),w(i,"correctionRatio",1),w(i,"customBBox",null),w(i,"normalizationFunction",ha({x:[0,1],y:[0,1]})),w(i,"graphToViewportRatio",1),w(i,"itemIDsIndex",{}),w(i,"nodeIndices",{}),w(i,"edgeIndices",{}),w(i,"width",0),w(i,"height",0),w(i,"pixelRatio",ua()),w(i,"pickingDownSizingRatio",2*i.pixelRatio),w(i,"displayedNodeLabels",new Set),w(i,"displayedEdgeLabels",new Set),w(i,"highlightedNodes",new Set),w(i,"hoveredNode",null),w(i,"hoveredEdge",null),w(i,"renderFrame",null),w(i,"renderHighlightedNodesFrame",null),w(i,"needToProcess",!1),w(i,"checkEdgesEventsFrame",null),w(i,"nodePrograms",{}),w(i,"nodeHoverPrograms",{}),w(i,"edgePrograms",{}),i.settings=Kf(o),li(i.settings),Hf(t),!(n instanceof HTMLElement))throw new Error("Sigma: container should be an html element.");i.graph=t,i.container=n,i.createWebGLContext("edges",{picking:o.enableEdgeEvents}),i.createCanvasContext("edgeLabels"),i.createWebGLContext("nodes",{picking:!0}),i.createCanvasContext("labels"),i.createCanvasContext("hovers"),i.createWebGLContext("hoverNodes"),i.createCanvasContext("mouse",{style:{touchAction:"none",userSelect:"none"}}),i.resize();for(var a in i.settings.nodeProgramClasses)i.registerNodeProgram(a,i.settings.nodeProgramClasses[a],i.settings.nodeHoverProgramClasses[a]);for(var s in i.settings.edgeProgramClasses)i.registerEdgeProgram(s,i.settings.edgeProgramClasses[s]);return i.camera=new da,i.bindCameraHandlers(),i.mouseCaptor=new Jf(i.elements.mouse,i),i.mouseCaptor.setSettings(i.settings),i.touchCaptor=new tg(i.elements.mouse,i),i.touchCaptor.setSettings(i.settings),i.bindEventHandlers(),i.bindGraphHandlers(),i.handleSettingsUpdate(),i.refresh(),i}return Be(e,r),be(e,[{key:"registerNodeProgram",value:function(n,i,o){return this.nodePrograms[n]&&this.nodePrograms[n].kill(),this.nodeHoverPrograms[n]&&this.nodeHoverPrograms[n].kill(),this.nodePrograms[n]=new i(this.webGLContexts.nodes,this.frameBuffers.nodes,this),this.nodeHoverPrograms[n]=new(o||i)(this.webGLContexts.hoverNodes,null,this),this}},{key:"registerEdgeProgram",value:function(n,i){return this.edgePrograms[n]&&this.edgePrograms[n].kill(),this.edgePrograms[n]=new i(this.webGLContexts.edges,this.frameBuffers.edges,this),this}},{key:"unregisterNodeProgram",value:function(n){if(this.nodePrograms[n]){var i=this.nodePrograms,o=i[n],a=hi(i,[n].map(Pr));o.kill(),this.nodePrograms=a}if(this.nodeHoverPrograms[n]){var s=this.nodeHoverPrograms,u=s[n],l=hi(s,[n].map(Pr));u.kill(),this.nodePrograms=l}return this}},{key:"unregisterEdgeProgram",value:function(n){if(this.edgePrograms[n]){var i=this.edgePrograms,o=i[n],a=hi(i,[n].map(Pr));o.kill(),this.edgePrograms=a}return this}},{key:"resetWebGLTexture",value:function(n){var i=this.webGLContexts[n],o=this.frameBuffers[n],a=this.textures[n];a&&i.deleteTexture(a);var s=i.createTexture();return i.bindFramebuffer(i.FRAMEBUFFER,o),i.bindTexture(i.TEXTURE_2D,s),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.width,this.height,0,i.RGBA,i.UNSIGNED_BYTE,null),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,s,0),this.textures[n]=s,this}},{key:"bindCameraHandlers",value:function(){var n=this;return this.activeListeners.camera=function(){n.scheduleRender()},this.camera.on("updated",this.activeListeners.camera),this}},{key:"unbindCameraHandlers",value:function(){return this.camera.removeListener("updated",this.activeListeners.camera),this}},{key:"getNodeAtPosition",value:function(n){var i=n.x,o=n.y,a=Jo(this.webGLContexts.nodes,this.frameBuffers.nodes,i,o,this.pixelRatio,this.pickingDownSizingRatio),s=Zo.apply(void 0,fa(a)),u=this.itemIDsIndex[s];return u&&u.type==="node"?u.id:null}},{key:"bindEventHandlers",value:function(){var n=this;this.activeListeners.handleResize=function(){n.scheduleRefresh()},window.addEventListener("resize",this.activeListeners.handleResize),this.activeListeners.handleMove=function(o){var a=Lr(o),s={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}},u=n.getNodeAtPosition(a);if(u&&n.hoveredNode!==u&&!n.nodeDataCache[u].hidden){n.hoveredNode&&n.emit("leaveNode",L(L({},s),{},{node:n.hoveredNode})),n.hoveredNode=u,n.emit("enterNode",L(L({},s),{},{node:u})),n.scheduleHighlightedNodesRender();return}if(n.hoveredNode&&n.getNodeAtPosition(a)!==n.hoveredNode){var l=n.hoveredNode;n.hoveredNode=null,n.emit("leaveNode",L(L({},s),{},{node:l})),n.scheduleHighlightedNodesRender();return}if(n.settings.enableEdgeEvents){var h=n.hoveredNode?null:n.getEdgeAtPoint(s.event.x,s.event.y);h!==n.hoveredEdge&&(n.hoveredEdge&&n.emit("leaveEdge",L(L({},s),{},{edge:n.hoveredEdge})),h&&n.emit("enterEdge",L(L({},s),{},{edge:h})),n.hoveredEdge=h)}},this.activeListeners.handleMoveBody=function(o){var a=Lr(o);n.emit("moveBody",{event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}})},this.activeListeners.handleLeave=function(o){var a=Lr(o),s={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}};n.hoveredNode&&(n.emit("leaveNode",L(L({},s),{},{node:n.hoveredNode})),n.scheduleHighlightedNodesRender()),n.settings.enableEdgeEvents&&n.hoveredEdge&&(n.emit("leaveEdge",L(L({},s),{},{edge:n.hoveredEdge})),n.scheduleHighlightedNodesRender()),n.emit("leaveStage",L({},s))},this.activeListeners.handleEnter=function(o){var a=Lr(o),s={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}};n.emit("enterStage",L({},s))};var i=function(a){return function(s){var u=Lr(s),l={event:u,preventSigmaDefault:function(){u.preventSigmaDefault()}},h=n.getNodeAtPosition(u);if(h)return n.emit("".concat(a,"Node"),L(L({},l),{},{node:h}));if(n.settings.enableEdgeEvents){var c=n.getEdgeAtPoint(u.x,u.y);if(c)return n.emit("".concat(a,"Edge"),L(L({},l),{},{edge:c}))}return n.emit("".concat(a,"Stage"),l)}};return this.activeListeners.handleClick=i("click"),this.activeListeners.handleRightClick=i("rightClick"),this.activeListeners.handleDoubleClick=i("doubleClick"),this.activeListeners.handleWheel=i("wheel"),this.activeListeners.handleDown=i("down"),this.activeListeners.handleUp=i("up"),this.mouseCaptor.on("mousemove",this.activeListeners.handleMove),this.mouseCaptor.on("mousemovebody",this.activeListeners.handleMoveBody),this.mouseCaptor.on("click",this.activeListeners.handleClick),this.mouseCaptor.on("rightClick",this.activeListeners.handleRightClick),this.mouseCaptor.on("doubleClick",this.activeListeners.handleDoubleClick),this.mouseCaptor.on("wheel",this.activeListeners.handleWheel),this.mouseCaptor.on("mousedown",this.activeListeners.handleDown),this.mouseCaptor.on("mouseup",this.activeListeners.handleUp),this.mouseCaptor.on("mouseleave",this.activeListeners.handleLeave),this.mouseCaptor.on("mouseenter",this.activeListeners.handleEnter),this.touchCaptor.on("touchdown",this.activeListeners.handleDown),this.touchCaptor.on("touchdown",this.activeListeners.handleMove),this.touchCaptor.on("touchup",this.activeListeners.handleUp),this.touchCaptor.on("touchmove",this.activeListeners.handleMove),this.touchCaptor.on("tap",this.activeListeners.handleClick),this.touchCaptor.on("doubletap",this.activeListeners.handleDoubleClick),this.touchCaptor.on("touchmove",this.activeListeners.handleMoveBody),this}},{key:"bindGraphHandlers",value:function(){var n=this,i=this.graph,o=new Set(["x","y","zIndex","type"]);return this.activeListeners.eachNodeAttributesUpdatedGraphUpdate=function(a){var s,u=(s=a.hints)===null||s===void 0?void 0:s.attributes;n.graph.forEachNode(function(h){return n.updateNode(h)});var l=!u||u.some(function(h){return o.has(h)});n.refresh({partialGraph:{nodes:i.nodes()},skipIndexation:!l,schedule:!0})},this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate=function(a){var s,u=(s=a.hints)===null||s===void 0?void 0:s.attributes;n.graph.forEachEdge(function(h){return n.updateEdge(h)});var l=u&&["zIndex","type"].some(function(h){return u==null?void 0:u.includes(h)});n.refresh({partialGraph:{edges:i.edges()},skipIndexation:!l,schedule:!0})},this.activeListeners.addNodeGraphUpdate=function(a){var s=a.key;n.addNode(s),n.refresh({partialGraph:{nodes:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.updateNodeGraphUpdate=function(a){var s=a.key;n.refresh({partialGraph:{nodes:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropNodeGraphUpdate=function(a){var s=a.key;n.removeNode(s),n.refresh({schedule:!0})},this.activeListeners.addEdgeGraphUpdate=function(a){var s=a.key;n.addEdge(s),n.refresh({partialGraph:{edges:[s]},schedule:!0})},this.activeListeners.updateEdgeGraphUpdate=function(a){var s=a.key;n.refresh({partialGraph:{edges:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropEdgeGraphUpdate=function(a){var s=a.key;n.removeEdge(s),n.refresh({schedule:!0})},this.activeListeners.clearEdgesGraphUpdate=function(){n.clearEdgeState(),n.clearEdgeIndices(),n.refresh({schedule:!0})},this.activeListeners.clearGraphUpdate=function(){n.clearEdgeState(),n.clearNodeState(),n.clearEdgeIndices(),n.clearNodeIndices(),n.refresh({schedule:!0})},i.on("nodeAdded",this.activeListeners.addNodeGraphUpdate),i.on("nodeDropped",this.activeListeners.dropNodeGraphUpdate),i.on("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),i.on("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),i.on("edgeAdded",this.activeListeners.addEdgeGraphUpdate),i.on("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),i.on("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),i.on("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),i.on("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),i.on("cleared",this.activeListeners.clearGraphUpdate),this}},{key:"unbindGraphHandlers",value:function(){var n=this.graph;n.removeListener("nodeAdded",this.activeListeners.addNodeGraphUpdate),n.removeListener("nodeDropped",this.activeListeners.dropNodeGraphUpdate),n.removeListener("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),n.removeListener("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),n.removeListener("edgeAdded",this.activeListeners.addEdgeGraphUpdate),n.removeListener("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),n.removeListener("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),n.removeListener("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),n.removeListener("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),n.removeListener("cleared",this.activeListeners.clearGraphUpdate)}},{key:"getEdgeAtPoint",value:function(n,i){var o=Jo(this.webGLContexts.edges,this.frameBuffers.edges,n,i,this.pixelRatio,this.pickingDownSizingRatio),a=Zo.apply(void 0,fa(o)),s=this.itemIDsIndex[a];return s&&s.type==="edge"?s.id:null}},{key:"process",value:function(){var n=this;this.emit("beforeProcess");var i=this.graph,o=this.settings,a=this.getDimensions();if(this.nodeExtent=zf(this.graph),!this.settings.autoRescale){var s=a.width,u=a.height,l=this.nodeExtent,h=l.x,c=l.y;this.nodeExtent={x:[(h[0]+h[1])/2-s/2,(h[0]+h[1])/2+s/2],y:[(c[0]+c[1])/2-u/2,(c[0]+c[1])/2+u/2]}}this.normalizationFunction=ha(this.customBBox||this.nodeExtent);var d=new da,f=Dr(d.getState(),a,this.getGraphDimensions(),this.getStagePadding());this.labelGrid.resizeAndClear(a,o.labelGridCellSize);for(var g={},p={},v={},y={},m=1,b=i.nodes(),_=0,T=b.length;_<T;_++){var A=b[_],E=this.nodeDataCache[A],G=i.getNodeAttributes(A);E.x=G.x,E.y=G.y,this.normalizationFunction.applyTo(E),typeof E.label=="string"&&!E.hidden&&this.labelGrid.add(A,E.size,this.framedGraphToViewport(E,{matrix:f})),g[E.type]=(g[E.type]||0)+1}this.labelGrid.organize();for(var R in this.nodePrograms){if(!ht.call(this.nodePrograms,R))throw new Error('Sigma: could not find a suitable program for node type "'.concat(R,'"!'));this.nodePrograms[R].reallocate(g[R]||0),g[R]=0}this.settings.zIndex&&this.nodeZExtent[0]!==this.nodeZExtent[1]&&(b=la(this.nodeZExtent,function(qe){return n.nodeDataCache[qe].zIndex},b));for(var I=0,k=b.length;I<k;I++){var C=b[I];p[C]=m,y[p[C]]={type:"node",id:C},m++;var U=this.nodeDataCache[C];this.addNodeToProgram(C,p[C],g[U.type]++)}for(var N={},B=i.edges(),j=0,ue=B.length;j<ue;j++){var re=B[j],J=this.edgeDataCache[re];N[J.type]=(N[J.type]||0)+1}this.settings.zIndex&&this.edgeZExtent[0]!==this.edgeZExtent[1]&&(B=la(this.edgeZExtent,function(qe){return n.edgeDataCache[qe].zIndex},B));for(var Q in this.edgePrograms){if(!ht.call(this.edgePrograms,Q))throw new Error('Sigma: could not find a suitable program for edge type "'.concat(Q,'"!'));this.edgePrograms[Q].reallocate(N[Q]||0),N[Q]=0}for(var ne=0,ge=B.length;ne<ge;ne++){var se=B[ne];v[se]=m,y[v[se]]={type:"edge",id:se},m++;var Wt=this.edgeDataCache[se];this.addEdgeToProgram(se,v[se],N[Wt.type]++)}return this.itemIDsIndex=y,this.nodeIndices=p,this.edgeIndices=v,this.emit("afterProcess"),this}},{key:"handleSettingsUpdate",value:function(n){var i=this,o=this.settings;if(this.camera.minRatio=o.minCameraRatio,this.camera.maxRatio=o.maxCameraRatio,this.camera.enabledZooming=o.enableCameraZooming,this.camera.enabledPanning=o.enableCameraPanning,this.camera.enabledRotation=o.enableCameraRotation,o.cameraPanBoundaries?this.camera.clean=function(h){return i.cleanCameraState(h,o.cameraPanBoundaries&&Oi(o.cameraPanBoundaries)==="object"?o.cameraPanBoundaries:{})}:this.camera.clean=null,this.camera.setState(this.camera.validateState(this.camera.getState())),n){if(n.edgeProgramClasses!==o.edgeProgramClasses){for(var a in o.edgeProgramClasses)o.edgeProgramClasses[a]!==n.edgeProgramClasses[a]&&this.registerEdgeProgram(a,o.edgeProgramClasses[a]);for(var s in n.edgeProgramClasses)o.edgeProgramClasses[s]||this.unregisterEdgeProgram(s)}if(n.nodeProgramClasses!==o.nodeProgramClasses||n.nodeHoverProgramClasses!==o.nodeHoverProgramClasses){for(var u in o.nodeProgramClasses)(o.nodeProgramClasses[u]!==n.nodeProgramClasses[u]||o.nodeHoverProgramClasses[u]!==n.nodeHoverProgramClasses[u])&&this.registerNodeProgram(u,o.nodeProgramClasses[u],o.nodeHoverProgramClasses[u]);for(var l in n.nodeProgramClasses)o.nodeProgramClasses[l]||this.unregisterNodeProgram(l)}}return this.mouseCaptor.setSettings(this.settings),this.touchCaptor.setSettings(this.settings),this}},{key:"cleanCameraState",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.tolerance,a=o===void 0?0:o,s=i.boundaries,u=L({},n),l=s||this.nodeExtent,h=dr(l.x,2),c=h[0],d=h[1],f=dr(l.y,2),g=f[0],p=f[1],v=[this.graphToViewport({x:c,y:g},{cameraState:n}),this.graphToViewport({x:d,y:g},{cameraState:n}),this.graphToViewport({x:c,y:p},{cameraState:n}),this.graphToViewport({x:d,y:p},{cameraState:n})],y=1/0,m=-1/0,b=1/0,_=-1/0;v.forEach(function(N){var B=N.x,j=N.y;y=Math.min(y,B),m=Math.max(m,B),b=Math.min(b,j),_=Math.max(_,j)});var T=m-y,A=_-b,E=this.getDimensions(),G=E.width,R=E.height,I=0,k=0;if(T>=G?m<G-a?I=m-(G-a):y>a&&(I=y-a):m>G+a?I=m-(G+a):y<-a&&(I=y+a),A>=R?_<R-a?k=_-(R-a):b>a&&(k=b-a):_>R+a?k=_-(R+a):b<-a&&(k=b+a),I||k){var C=this.viewportToFramedGraph({x:0,y:0},{cameraState:n}),U=this.viewportToFramedGraph({x:I,y:k},{cameraState:n});I=U.x-C.x,k=U.y-C.y,u.x+=I,u.y+=k}return u}},{key:"renderLabels",value:function(){if(!this.settings.renderLabels)return this;var n=this.camera.getState(),i=this.labelGrid.getLabelsToDisplay(n.ratio,this.settings.labelDensity);ca(i,this.nodesWithForcedLabels),this.displayedNodeLabels=new Set;for(var o=this.canvasContexts.labels,a=0,s=i.length;a<s;a++){var u=i[a],l=this.nodeDataCache[u];if(!this.displayedNodeLabels.has(u)&&!l.hidden){var h=this.framedGraphToViewport(l),c=h.x,d=h.y,f=this.scaleSize(l.size);if(!(!l.forceLabel&&f<this.settings.labelRenderedSizeThreshold)&&!(c<-va||c>this.width+va||d<-ma||d>this.height+ma)){this.displayedNodeLabels.add(u);var g=this.settings.defaultDrawNodeLabel,p=this.nodePrograms[l.type],v=(p==null?void 0:p.drawLabel)||g;v(o,L(L({key:u},l),{},{size:f,x:c,y:d}),this.settings)}}}return this}},{key:"renderEdgeLabels",value:function(){if(!this.settings.renderEdgeLabels)return this;var n=this.canvasContexts.edgeLabels;n.clearRect(0,0,this.width,this.height);var i=ag({graph:this.graph,hoveredNode:this.hoveredNode,displayedNodeLabels:this.displayedNodeLabels,highlightedNodes:this.highlightedNodes});ca(i,this.edgesWithForcedLabels);for(var o=new Set,a=0,s=i.length;a<s;a++){var u=i[a],l=this.graph.extremities(u),h=this.nodeDataCache[l[0]],c=this.nodeDataCache[l[1]],d=this.edgeDataCache[u];if(!o.has(u)&&!(d.hidden||h.hidden||c.hidden)){var f=this.settings.defaultDrawEdgeLabel,g=this.edgePrograms[d.type],p=(g==null?void 0:g.drawLabel)||f;p(n,L(L({key:u},d),{},{size:this.scaleSize(d.size)}),L(L(L({key:l[0]},h),this.framedGraphToViewport(h)),{},{size:this.scaleSize(h.size)}),L(L(L({key:l[1]},c),this.framedGraphToViewport(c)),{},{size:this.scaleSize(c.size)}),this.settings),o.add(u)}}return this.displayedEdgeLabels=o,this}},{key:"renderHighlightedNodes",value:function(){var n=this,i=this.canvasContexts.hovers;i.clearRect(0,0,this.width,this.height);var o=function(f){var g=n.nodeDataCache[f],p=n.framedGraphToViewport(g),v=p.x,y=p.y,m=n.scaleSize(g.size),b=n.settings.defaultDrawNodeHover,_=n.nodePrograms[g.type],T=(_==null?void 0:_.drawHover)||b;T(i,L(L({key:f},g),{},{size:m,x:v,y}),n.settings)},a=[];this.hoveredNode&&!this.nodeDataCache[this.hoveredNode].hidden&&a.push(this.hoveredNode),this.highlightedNodes.forEach(function(d){d!==n.hoveredNode&&a.push(d)}),a.forEach(function(d){return o(d)});var s={};a.forEach(function(d){var f=n.nodeDataCache[d].type;s[f]=(s[f]||0)+1});for(var u in this.nodeHoverPrograms)this.nodeHoverPrograms[u].reallocate(s[u]||0),s[u]=0;a.forEach(function(d){var f=n.nodeDataCache[d];n.nodeHoverPrograms[f.type].process(0,s[f.type]++,f)}),this.webGLContexts.hoverNodes.clear(this.webGLContexts.hoverNodes.COLOR_BUFFER_BIT);var l=this.getRenderParams();for(var h in this.nodeHoverPrograms){var c=this.nodeHoverPrograms[h];c.render(l)}}},{key:"scheduleHighlightedNodesRender",value:function(){var n=this;this.renderHighlightedNodesFrame||this.renderFrame||(this.renderHighlightedNodesFrame=requestAnimationFrame(function(){n.renderHighlightedNodesFrame=null,n.renderHighlightedNodes(),n.renderEdgeLabels()}))}},{key:"render",value:function(){var n=this;this.emit("beforeRender");var i=function(){return n.emit("afterRender"),n};if(this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.resize(),this.needToProcess&&this.process(),this.needToProcess=!1,this.clear(),this.pickingLayers.forEach(function(v){return n.resetWebGLTexture(v)}),!this.graph.order)return i();var o=this.mouseCaptor,a=this.camera.isAnimated()||o.isMoving||o.draggedEvents||o.currentWheelDirection,s=this.camera.getState(),u=this.getDimensions(),l=this.getGraphDimensions(),h=this.getStagePadding();this.matrix=Dr(s,u,l,h),this.invMatrix=Dr(s,u,l,h,!0),this.correctionRatio=Bf(this.matrix,s,u),this.graphToViewportRatio=this.getGraphToViewportRatio();var c=this.getRenderParams();for(var d in this.nodePrograms){var f=this.nodePrograms[d];f.render(c)}if(!this.settings.hideEdgesOnMove||!a)for(var g in this.edgePrograms){var p=this.edgePrograms[g];p.render(c)}return this.settings.hideLabelsOnMove&&a||(this.renderLabels(),this.renderEdgeLabels(),this.renderHighlightedNodes()),i()}},{key:"addNode",value:function(n){var i=Object.assign({},this.graph.getNodeAttributes(n));this.settings.nodeReducer&&(i=this.settings.nodeReducer(n,i));var o=sg(this.settings,n,i);this.nodeDataCache[n]=o,this.nodesWithForcedLabels.delete(n),o.forceLabel&&!o.hidden&&this.nodesWithForcedLabels.add(n),this.highlightedNodes.delete(n),o.highlighted&&!o.hidden&&this.highlightedNodes.add(n),this.settings.zIndex&&(o.zIndex<this.nodeZExtent[0]&&(this.nodeZExtent[0]=o.zIndex),o.zIndex>this.nodeZExtent[1]&&(this.nodeZExtent[1]=o.zIndex))}},{key:"updateNode",value:function(n){this.addNode(n);var i=this.nodeDataCache[n];this.normalizationFunction.applyTo(i)}},{key:"removeNode",value:function(n){delete this.nodeDataCache[n],delete this.nodeProgramIndex[n],this.highlightedNodes.delete(n),this.hoveredNode===n&&(this.hoveredNode=null),this.nodesWithForcedLabels.delete(n)}},{key:"addEdge",value:function(n){var i=Object.assign({},this.graph.getEdgeAttributes(n));this.settings.edgeReducer&&(i=this.settings.edgeReducer(n,i));var o=ug(this.settings,n,i);this.edgeDataCache[n]=o,this.edgesWithForcedLabels.delete(n),o.forceLabel&&!o.hidden&&this.edgesWithForcedLabels.add(n),this.settings.zIndex&&(o.zIndex<this.edgeZExtent[0]&&(this.edgeZExtent[0]=o.zIndex),o.zIndex>this.edgeZExtent[1]&&(this.edgeZExtent[1]=o.zIndex))}},{key:"updateEdge",value:function(n){this.addEdge(n)}},{key:"removeEdge",value:function(n){delete this.edgeDataCache[n],delete this.edgeProgramIndex[n],this.hoveredEdge===n&&(this.hoveredEdge=null),this.edgesWithForcedLabels.delete(n)}},{key:"clearNodeIndices",value:function(){this.labelGrid=new pa,this.nodeExtent={x:[0,1],y:[0,1]},this.nodeDataCache={},this.edgeProgramIndex={},this.nodesWithForcedLabels=new Set,this.nodeZExtent=[1/0,-1/0],this.highlightedNodes=new Set}},{key:"clearEdgeIndices",value:function(){this.edgeDataCache={},this.edgeProgramIndex={},this.edgesWithForcedLabels=new Set,this.edgeZExtent=[1/0,-1/0]}},{key:"clearIndices",value:function(){this.clearEdgeIndices(),this.clearNodeIndices()}},{key:"clearNodeState",value:function(){this.displayedNodeLabels=new Set,this.highlightedNodes=new Set,this.hoveredNode=null}},{key:"clearEdgeState",value:function(){this.displayedEdgeLabels=new Set,this.highlightedNodes=new Set,this.hoveredEdge=null}},{key:"clearState",value:function(){this.clearEdgeState(),this.clearNodeState()}},{key:"addNodeToProgram",value:function(n,i,o){var a=this.nodeDataCache[n],s=this.nodePrograms[a.type];if(!s)throw new Error('Sigma: could not find a suitable program for node type "'.concat(a.type,'"!'));s.process(i,o,a),this.nodeProgramIndex[n]=o}},{key:"addEdgeToProgram",value:function(n,i,o){var a=this.edgeDataCache[n],s=this.edgePrograms[a.type];if(!s)throw new Error('Sigma: could not find a suitable program for edge type "'.concat(a.type,'"!'));var u=this.graph.extremities(n),l=this.nodeDataCache[u[0]],h=this.nodeDataCache[u[1]];s.process(i,o,l,h,a),this.edgeProgramIndex[n]=o}},{key:"getRenderParams",value:function(){return{matrix:this.matrix,invMatrix:this.invMatrix,width:this.width,height:this.height,pixelRatio:this.pixelRatio,zoomRatio:this.camera.ratio,cameraAngle:this.camera.angle,sizeRatio:1/this.scaleSize(),correctionRatio:this.correctionRatio,downSizingRatio:this.pickingDownSizingRatio,minEdgeThickness:this.settings.minEdgeThickness,antiAliasingFeather:this.settings.antiAliasingFeather}}},{key:"getStagePadding",value:function(){var n=this.settings,i=n.stagePadding,o=n.autoRescale;return o&&i||0}},{key:"createLayer",value:function(n,i){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.elements[n])throw new Error('Sigma: a layer named "'.concat(n,'" already exists'));var a=jf(i,{position:"absolute"},{class:"sigma-".concat(n)});return o.style&&Object.assign(a.style,o.style),this.elements[n]=a,"beforeLayer"in o&&o.beforeLayer?this.elements[o.beforeLayer].before(a):"afterLayer"in o&&o.afterLayer?this.elements[o.afterLayer].after(a):this.container.appendChild(a),a}},{key:"createCanvas",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.createLayer(n,"canvas",i)}},{key:"createCanvasContext",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.createCanvas(n,i),a={preserveDrawingBuffer:!1,antialias:!1};return this.canvasContexts[n]=o.getContext("2d",a),this}},{key:"createWebGLContext",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=(i==null?void 0:i.canvas)||this.createCanvas(n,i);i.hidden&&o.remove();var a=L({preserveDrawingBuffer:!1,antialias:!1},i),s;s=o.getContext("webgl2",a),s||(s=o.getContext("webgl",a)),s||(s=o.getContext("experimental-webgl",a));var u=s;if(this.webGLContexts[n]=u,u.blendFunc(u.ONE,u.ONE_MINUS_SRC_ALPHA),i.picking){this.pickingLayers.add(n);var l=u.createFramebuffer();if(!l)throw new Error("Sigma: cannot create a new frame buffer for layer ".concat(n));this.frameBuffers[n]=l}return u}},{key:"killLayer",value:function(n){var i=this.elements[n];if(!i)throw new Error("Sigma: cannot kill layer ".concat(n,", which does not exist"));if(this.webGLContexts[n]){var o,a=this.webGLContexts[n];(o=a.getExtension("WEBGL_lose_context"))===null||o===void 0||o.loseContext(),delete this.webGLContexts[n]}else this.canvasContexts[n]&&delete this.canvasContexts[n];return i.remove(),delete this.elements[n],this}},{key:"getCamera",value:function(){return this.camera}},{key:"setCamera",value:function(n){this.unbindCameraHandlers(),this.camera=n,this.bindCameraHandlers()}},{key:"getContainer",value:function(){return this.container}},{key:"getGraph",value:function(){return this.graph}},{key:"setGraph",value:function(n){n!==this.graph&&(this.hoveredNode&&!n.hasNode(this.hoveredNode)&&(this.hoveredNode=null),this.hoveredEdge&&!n.hasEdge(this.hoveredEdge)&&(this.hoveredEdge=null),this.unbindGraphHandlers(),this.checkEdgesEventsFrame!==null&&(cancelAnimationFrame(this.checkEdgesEventsFrame),this.checkEdgesEventsFrame=null),this.graph=n,this.bindGraphHandlers(),this.refresh())}},{key:"getMouseCaptor",value:function(){return this.mouseCaptor}},{key:"getTouchCaptor",value:function(){return this.touchCaptor}},{key:"getDimensions",value:function(){return{width:this.width,height:this.height}}},{key:"getGraphDimensions",value:function(){var n=this.customBBox||this.nodeExtent;return{width:n.x[1]-n.x[0]||1,height:n.y[1]-n.y[0]||1}}},{key:"getNodeDisplayData",value:function(n){var i=this.nodeDataCache[n];return i?Object.assign({},i):void 0}},{key:"getEdgeDisplayData",value:function(n){var i=this.edgeDataCache[n];return i?Object.assign({},i):void 0}},{key:"getNodeDisplayedLabels",value:function(){return new Set(this.displayedNodeLabels)}},{key:"getEdgeDisplayedLabels",value:function(){return new Set(this.displayedEdgeLabels)}},{key:"getSettings",value:function(){return L({},this.settings)}},{key:"getSetting",value:function(n){return this.settings[n]}},{key:"setSetting",value:function(n,i){var o=L({},this.settings);return this.settings[n]=i,li(this.settings),this.handleSettingsUpdate(o),this.scheduleRefresh(),this}},{key:"updateSetting",value:function(n,i){return this.setSetting(n,i(this.settings[n])),this}},{key:"setSettings",value:function(n){var i=L({},this.settings);return this.settings=L(L({},this.settings),n),li(this.settings),this.handleSettingsUpdate(i),this.scheduleRefresh(),this}},{key:"resize",value:function(n){var i=this.width,o=this.height;if(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.pixelRatio=ua(),this.width===0)if(this.settings.allowInvalidContainer)this.width=1;else throw new Error("Sigma: Container has no width. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(this.height===0)if(this.settings.allowInvalidContainer)this.height=1;else throw new Error("Sigma: Container has no height. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(!n&&i===this.width&&o===this.height)return this;for(var a in this.elements){var s=this.elements[a];s.style.width=this.width+"px",s.style.height=this.height+"px"}for(var u in this.canvasContexts)this.elements[u].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[u].setAttribute("height",this.height*this.pixelRatio+"px"),this.pixelRatio!==1&&this.canvasContexts[u].scale(this.pixelRatio,this.pixelRatio);for(var l in this.webGLContexts){this.elements[l].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[l].setAttribute("height",this.height*this.pixelRatio+"px");var h=this.webGLContexts[l];if(h.viewport(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio),this.pickingLayers.has(l)){var c=this.textures[l];c&&h.deleteTexture(c)}}return this.emit("resize"),this}},{key:"clear",value:function(){return this.emit("beforeClear"),this.webGLContexts.nodes.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.nodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.edges.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.edges.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.hoverNodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.canvasContexts.labels.clearRect(0,0,this.width,this.height),this.canvasContexts.hovers.clearRect(0,0,this.width,this.height),this.canvasContexts.edgeLabels.clearRect(0,0,this.width,this.height),this.emit("afterClear"),this}},{key:"refresh",value:function(n){var i=this,o=(n==null?void 0:n.skipIndexation)!==void 0?n==null?void 0:n.skipIndexation:!1,a=(n==null?void 0:n.schedule)!==void 0?n.schedule:!1,s=!n||!n.partialGraph;if(s)this.clearEdgeIndices(),this.clearNodeIndices(),this.graph.forEachNode(function(_){return i.addNode(_)}),this.graph.forEachEdge(function(_){return i.addEdge(_)});else{for(var u,l,h=((u=n.partialGraph)===null||u===void 0?void 0:u.nodes)||[],c=0,d=(h==null?void 0:h.length)||0;c<d;c++){var f=h[c];if(this.updateNode(f),o){var g=this.nodeProgramIndex[f];if(g===void 0)throw new Error('Sigma: node "'.concat(f,`" can't be repaint`));this.addNodeToProgram(f,this.nodeIndices[f],g)}}for(var p=(n==null||(l=n.partialGraph)===null||l===void 0?void 0:l.edges)||[],v=0,y=p.length;v<y;v++){var m=p[v];if(this.updateEdge(m),o){var b=this.edgeProgramIndex[m];if(b===void 0)throw new Error('Sigma: edge "'.concat(m,`" can't be repaint`));this.addEdgeToProgram(m,this.edgeIndices[m],b)}}}return(s||!o)&&(this.needToProcess=!0),a?this.scheduleRender():this.render(),this}},{key:"scheduleRender",value:function(){var n=this;return this.renderFrame||(this.renderFrame=requestAnimationFrame(function(){n.render()})),this}},{key:"scheduleRefresh",value:function(n){return this.refresh(L(L({},n),{},{schedule:!0}))}},{key:"getViewportZoomedState",value:function(n,i){var o=this.camera.getState(),a=o.ratio,s=o.angle,u=o.x,l=o.y,h=this.settings,c=h.minCameraRatio,d=h.maxCameraRatio;typeof d=="number"&&(i=Math.min(i,d)),typeof c=="number"&&(i=Math.max(i,c));var f=i/a,g={x:this.width/2,y:this.height/2},p=this.viewportToFramedGraph(n),v=this.viewportToFramedGraph(g);return{angle:s,x:(p.x-v.x)*(1-f)+u,y:(p.y-v.y)*(1-f)+l,ratio:i}}},{key:"viewRectangle",value:function(){var n=this.viewportToFramedGraph({x:0,y:0}),i=this.viewportToFramedGraph({x:this.width,y:0}),o=this.viewportToFramedGraph({x:0,y:this.height});return{x1:n.x,y1:n.y,x2:i.x,y2:i.y,height:i.y-o.y}}},{key:"framedGraphToViewport",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=!!i.cameraState||!!i.viewportDimensions||!!i.graphDimensions,a=i.matrix?i.matrix:o?Dr(i.cameraState||this.camera.getState(),i.viewportDimensions||this.getDimensions(),i.graphDimensions||this.getGraphDimensions(),i.padding||this.getStagePadding()):this.matrix,s=$i(a,n);return{x:(1+s.x)*this.width/2,y:(1-s.y)*this.height/2}}},{key:"viewportToFramedGraph",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=!!i.cameraState||!!i.viewportDimensions||!i.graphDimensions,a=i.matrix?i.matrix:o?Dr(i.cameraState||this.camera.getState(),i.viewportDimensions||this.getDimensions(),i.graphDimensions||this.getGraphDimensions(),i.padding||this.getStagePadding(),!0):this.invMatrix,s=$i(a,{x:n.x/this.width*2-1,y:1-n.y/this.height*2});return isNaN(s.x)&&(s.x=0),isNaN(s.y)&&(s.y=0),s}},{key:"viewportToGraph",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.normalizationFunction.inverse(this.viewportToFramedGraph(n,i))}},{key:"graphToViewport",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.framedGraphToViewport(this.normalizationFunction(n),i)}},{key:"getGraphToViewportRatio",value:function(){var n={x:0,y:0},i={x:1,y:1},o=Math.sqrt(Math.pow(n.x-i.x,2)+Math.pow(n.y-i.y,2)),a=this.graphToViewport(n),s=this.graphToViewport(i),u=Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2));return u/o}},{key:"getBBox",value:function(){return this.nodeExtent}},{key:"getCustomBBox",value:function(){return this.customBBox}},{key:"setCustomBBox",value:function(n){return this.customBBox=n,this.scheduleRender(),this}},{key:"kill",value:function(){this.emit("kill"),this.removeAllListeners(),this.unbindCameraHandlers(),window.removeEventListener("resize",this.activeListeners.handleResize),this.mouseCaptor.kill(),this.touchCaptor.kill(),this.unbindGraphHandlers(),this.clearIndices(),this.clearState(),this.nodeDataCache={},this.edgeDataCache={},this.highlightedNodes.clear(),this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.renderHighlightedNodesFrame&&(cancelAnimationFrame(this.renderHighlightedNodesFrame),this.renderHighlightedNodesFrame=null);for(var n=this.container;n.firstChild;)n.removeChild(n.firstChild);for(var i in this.nodePrograms)this.nodePrograms[i].kill();for(var o in this.nodeHoverPrograms)this.nodeHoverPrograms[o].kill();for(var a in this.edgePrograms)this.edgePrograms[a].kill();this.nodePrograms={},this.nodeHoverPrograms={},this.edgePrograms={};for(var s in this.elements)this.killLayer(s);this.canvasContexts={},this.webGLContexts={},this.elements={}}},{key:"scaleSize",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.camera.ratio;return n/this.settings.zoomToSizeRatioFunction(i)*(this.getSetting("itemSizesReference")==="positions"?i*this.graphToViewportRatio:1)}},{key:"getCanvases",value:function(){var n={};for(var i in this.elements)this.elements[i]instanceof HTMLCanvasElement&&(n[i]=this.elements[i]);return n}}])}(_o),hg=lg,cg=X('<div style="width:100%;height:600px;border-radius:12px;border:1px solid #e2e8f0"></div>');function dg(r,e){pr(e,!1);const t=()=>K(nu,"$neighborIds",c),n=()=>K(Pd,"$neighborEdgeIds",c),i=()=>K(Bt,"$shortestPath",c),o=()=>K(Od,"$pathEdgeIds",c),a=()=>K(Ud,"$metricSizes",c),s=()=>K(Bd,"$metricColors",c),u=()=>K(ru,"$searchResults",c),l=()=>K(Rt,"$selectedNodeId",c),h=()=>K(Ut,"$selectedEdgeId",c),[c,d]=_r();let f=jl(e,"data",8,null),g=$t(),p=$t(null);Zi(()=>{if(!f())return;const y=new Y({type:"undirected",allowSelfLoops:!0});f().nodes.forEach(m=>{var b;y.addNode(m.id,{label:((b=m.properties)==null?void 0:b.name)??m.id,x:m.x??Math.random()*10,y:m.y??Math.random()*10,size:m.size,color:"#334155",raw:m})}),f().edges.forEach(m=>{y.hasNode(m.source)&&y.hasNode(m.target)&&y.addEdgeWithKey(m.id,m.source,m.target,{label:m.type,color:"#94a3b8",raw:m})}),Ae(p,new hg(y,x(g),{renderLabels:!0})),x(p).on("clickNode",m=>{Rt.set(m.node),Ut.set(null)}),x(p).on("clickEdge",m=>{Ut.set(m.edge)})}),Dl(()=>{var y;(y=x(p))==null||y.kill(),Ae(p,null)}),mi(()=>(x(p),is(f()),t(),n(),i(),o(),a(),s(),u(),l(),h()),()=>{if(x(p)&&f()){const y=x(p).getGraph(),m=t(),b=n(),_=new Set(i()),T=o(),A=a(),E=s(),G=new Set(u().map(R=>R.id));y.forEachNode(R=>{const I=y.getNodeAttribute(R,"color");let k=E.get(R)??I,C=A.get(R)??y.getNodeAttribute(R,"size");G.size>0&&(k=G.has(R)?"#60a5fa":"#cbd5f5"),m.has(R)&&(k="#34d399",C=C+.9),_.has(R)&&(k="#facc15",C=C+1.1),l()&&R===l()&&(k="#f97316",C=C+1.3),y.setNodeAttribute(R,"color",k),y.setNodeAttribute(R,"size",C)}),y.forEachEdge(R=>{let k=y.getEdgeAttribute(R,"color"),C=y.getEdgeAttribute(R,"size")??1;b.has(R)&&(k="#34d399",C=Math.max(C,1.75)),T.has(R)&&(k="#facc15",C=Math.max(C,2)),h()&&R===h()&&(k="#f97316",C=Math.max(C,2.25)),y.setEdgeAttribute(R,"color",k),y.setEdgeAttribute(R,"size",C)})}}),Wa(),br();var v=cg();Bl(v,y=>Ae(g,y),()=>x(g)),z(r,v),vr(),d()}var fg=X('<li><label><input type="checkbox"/> </label></li>'),gg=X('<li><label><input type="checkbox"/> </label></li>'),pg=X('<li><label><input type="checkbox"/> </label></li>'),vg=X("<option> </option>"),mg=X('<aside style="background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:1rem;display:grid;gap:1rem"><section><h2>Search</h2> <input data-testid="search" placeholder="Search nodes..." type="search" style="width:100%;padding:0.45rem;border:1px solid #cbd5f5;border-radius:8px"/></section> <section><h2>Node Labels</h2> <ul></ul></section> <section><h2>Archetypes</h2> <ul></ul></section> <section><h2>Relationships</h2> <ul></ul></section> <section><h2>Mechanic Filter</h2> <select><option>All mechanics</option><!></select></section></aside>');function yg(r,e){pr(e,!1);const t=()=>K(Li,"$searchTerm",h),n=()=>K(Dd,"$labelOptions",h),i=()=>K(Ni,"$activeLabels",h),o=()=>K(Ld,"$archetypeOptions",h),a=()=>K(Fi,"$activeArchetypes",h),s=()=>K(Gi,"$relationshipFilters",h),u=()=>K(Qt,"$mechanicFilter",h),l=()=>K(Nd,"$mechanicOptions",h),[h,c]=_r(),d=["STRONG_AGAINST","WEAK_AGAINST","EVEN_AGAINST"];br();var f=mg(),g=F(f),p=M(F(g),2),v=M(g,2),y=M(F(v),2);Te(y,5,n,Se,(I,k)=>{var C=fg(),U=F(C),N=F(U),B=M(N);te(j=>{qn(N,j),ee(B,` ${x(k)??""}`)},[()=>i().has(x(k))]),xe("change",N,()=>ri(Ni,x(k))),z(I,C)});var m=M(v,2),b=M(F(m),2);Te(b,5,o,Se,(I,k)=>{var C=gg(),U=F(C),N=F(U),B=M(N);te(j=>{qn(N,j),ee(B,` ${x(k)??""}`)},[()=>a().has(x(k))]),xe("change",N,()=>ri(Fi,x(k))),z(I,C)});var _=M(m,2),T=M(F(_),2);Te(T,5,()=>d,Se,(I,k)=>{var C=pg(),U=F(C),N=F(U),B=M(N);te((j,ue)=>{qn(N,j),ee(B,` ${ue??""}`)},[()=>s().has(x(k)),()=>x(k).replace("_"," ")]),xe("change",N,()=>ri(Gi,x(k))),z(I,C)});var A=M(_,2),E=M(F(A),2);te(()=>{u(),yi(()=>{l()})});var G=F(E);G.value=G.__value="";var R=M(G);Te(R,1,l,Se,(I,k)=>{var C=vg(),U=F(C),N={};te(()=>{ee(U,x(k)),N!==(N=x(k))&&(C.value=(C.__value=x(k))??"")}),z(I,C)}),Ul(p,t,I=>wn(Li,I)),wi(E,u,I=>wn(Qt,I)),xe("change",E,I=>Qt.set(I.target.value||null)),z(r,f),vr(),c()}var bg=X("<option> </option>"),_g=X("<optgroup></optgroup>"),wg=X("<option> </option>"),Eg=X("<optgroup></optgroup>"),Ag=X('<p class="muted">No connection found between the chosen nodes.</p>'),xg=X('<section style="display:grid;gap:0.5rem"><h2>Path Tools</h2> <label class="muted" for="start">Start node</label> <select id="start"><option>Select start…</option><!></select> <label class="muted" for="end">End node</label> <select id="end"><option>Select end…</option><!></select> <div style="display:flex;gap:0.5rem;flex-wrap:wrap"><button>Use selection as start</button> <button>Use selection as end</button> <button>Clear path</button></div> <!></section>');function Sg(r,e){pr(e,!1);const t=()=>K(fe,"$graphData",s),n=()=>K(lr,"$pathStart",s),i=()=>K(hr,"$pathEnd",s),o=()=>K(Rt,"$selectedNodeId",s),a=()=>K(Bt,"$shortestPath",s),[s,u]=_r();function l(f){const g={};return f.nodes.forEach(p=>{var v;(g[v=p.label]??(g[v]=[])).push(p)}),Object.keys(g).forEach(p=>g[p].sort((v,y)=>{var m,b;return(((m=v.properties)==null?void 0:m.name)??v.id).localeCompare(((b=y.properties)==null?void 0:b.name)??y.id)})),g}br();var h=Yt(),c=Et(h);{var d=f=>{var g=xg(),p=M(F(g),4);te(()=>{n(),yi(()=>{t()})});var v=F(p);v.value=v.__value="";var y=M(v);Te(y,1,()=>Object.entries(l(t())),Se,(k,C)=>{var U=Co(()=>Ao(x(C),2));let N=()=>x(U)[0],B=()=>x(U)[1];var j=_g();Te(j,5,B,Se,(ue,re)=>{var J=bg(),Q=F(J),ne={};te(()=>{var ge;ee(Q,`${((ge=x(re).properties)==null?void 0:ge.name)??x(re).id??""} (${N()??""})`),ne!==(ne=x(re).id)&&(J.value=(J.__value=x(re).id)??"")}),z(ue,J)}),te(()=>Ei(j,"label",N())),z(k,j)});var m=M(p,4);te(()=>{i(),yi(()=>{t()})});var b=F(m);b.value=b.__value="";var _=M(b);Te(_,1,()=>Object.entries(l(t())),Se,(k,C)=>{var U=Co(()=>Ao(x(C),2));let N=()=>x(U)[0],B=()=>x(U)[1];var j=Eg();Te(j,5,B,Se,(ue,re)=>{var J=wg(),Q=F(J),ne={};te(()=>{var ge;ee(Q,`${((ge=x(re).properties)==null?void 0:ge.name)??x(re).id??""} (${N()??""})`),ne!==(ne=x(re).id)&&(J.value=(J.__value=x(re).id)??"")}),z(ue,J)}),te(()=>Ei(j,"label",N())),z(k,j)});var T=M(m,2),A=F(T),E=M(A,2),G=M(E,2),R=M(T,2);{var I=k=>{var C=Ag();z(k,C)};Ze(R,k=>{n()&&i()&&a().length===0&&k(I)})}te(()=>{A.disabled=!o(),E.disabled=!o()}),wi(p,n,k=>wn(lr,k)),xe("change",p,k=>Yo(k.target.value||null)),wi(m,i,k=>wn(hr,k)),xe("change",m,k=>qo(k.target.value||null)),xe("click",A,()=>o()&&Yo(o())),xe("click",E,()=>o()&&qo(o())),xe("click",G,()=>$d()),z(f,g)};Ze(c,f=>{t()&&f(d)})}z(r,h),vr(),u()}var Tg=X('<span class="muted"> </span>'),Cg=X("<li><button> <!></button></li>"),Rg=X('<div class="relationship-group"><p class="muted"> </p> <ul></ul></div>'),kg=X("<p> </p>"),Dg=X('<p class="muted">No narrative reason provided.</p>'),Lg=X("<dt>Evidence Count</dt><dd> </dd>",1),Ng=X('<div class="edge-summary"><div class="edge-summary__header"><h3>Relationship Detail</h3><button>Clear</button></div> <p class="muted"> </p> <!> <dl class="edge-meta"><dt>Source</dt><dd> </dd> <dt>Target</dt><dd> </dd> <!></dl></div>'),Fg=X('<section class="relationship-summary"><h3>Matchup Relationships</h3> <!> <!></section>'),Gg=X('<p class="muted">Click a node to view relationships.</p>');function Ig(r,e){pr(e,!1);const t=()=>K(fe,"$graphData",o),n=()=>K(Rt,"$selectedNodeId",o),i=()=>K(Ut,"$selectedEdgeId",o),[o,a]=_r(),s=["STRONG_AGAINST","WEAK_AGAINST","EVEN_AGAINST"];function u(p,v){const y={STRONG_AGAINST:[],WEAK_AGAINST:[],EVEN_AGAINST:[]};return!p||!v||(p.edges.forEach(m=>{s.includes(m.type)&&(m.source===v||m.target===v)&&y[m.type].push(m)}),Object.keys(y).forEach(m=>y[m].sort((b,_)=>{const T=b.source===v?b.target:b.source,A=_.source===v?_.target:_.source,E=l(p,T),G=l(p,A);return E.localeCompare(G)}))),y}function l(p,v){var m;const y=p.nodes.find(b=>b.id===v);return((m=y==null?void 0:y.properties)==null?void 0:m.name)??v}function h(p){var v;return((v=p.properties)==null?void 0:v.reason)??""}function c(p){var y;const v=(y=p.properties)==null?void 0:y.evidence;return typeof v=="number"?v:Number(v??0)}br();var d=Yt(),f=Et(d);{var g=p=>{var v=Yt(),y=Et(v);{var m=_=>{var T=Fg(),A=M(F(T),2);Te(A,1,()=>s,Se,(R,I)=>{var k=Yt(),C=Et(k);{var U=N=>{var B=Rg(),j=F(B),ue=F(j),re=M(j,2);Te(re,5,()=>u(t(),n())[x(I)],Se,(J,Q)=>{var ne=Yt(),ge=Et(ne);Nl(ge,()=>x(Q).id,se=>{var Wt=Cg(),qe=F(Wt);let Jr;var Qr=F(qe),Wn=M(Qr);{var De=_e=>{var bt=Tg(),Dt=F(bt);te(Tr=>ee(Dt,`• ${Tr??""}`),[()=>c(x(Q))]),z(_e,bt)};Ze(Wn,_e=>{c(x(Q))!==0&&_e(De)})}te(_e=>{Jr=us(qe,1,"link-button relationship",null,Jr,{active:i()===x(Q).id}),ee(Qr,`${_e??""} `)},[()=>(x(Q).source===n()?"→ ":"← ")+l(t(),x(Q).source===n()?x(Q).target:x(Q).source)]),xe("click",qe,()=>Ut.set(x(Q).id)),z(se,Wt)}),z(J,ne)}),te(J=>ee(ue,J),[()=>x(I).replace("_"," ")]),z(N,B)};Ze(C,N=>{u(t(),n())[x(I)].length&&N(U)})}z(R,k)});var E=M(A,2);{var G=R=>{var I=Yt(),k=Et(I);Te(k,1,()=>t().edges.filter(C=>C.id===i()),Se,(C,U)=>{var N=Ng(),B=F(N),j=M(F(B)),ue=M(B,2),re=F(ue),J=M(ue,2);{var Q=De=>{var _e=kg(),bt=F(_e);te(Dt=>ee(bt,Dt),[()=>h(x(U))]),z(De,_e)},ne=De=>{var _e=Dg();z(De,_e)};Ze(J,De=>{h(x(U))?De(Q):De(ne,!1)})}var ge=M(J,2),se=M(F(ge)),Wt=F(se),qe=M(se,3),Jr=F(qe),Qr=M(qe,2);{var Wn=De=>{var _e=Lg(),bt=M(Et(_e)),Dt=F(bt);te(Tr=>ee(Dt,Tr),[()=>c(x(U))]),z(De,_e)};Ze(Qr,De=>{c(x(U))!==0&&De(Wn)})}te((De,_e,bt,Dt,Tr)=>{ee(re,`${De??""} • ${_e??""} → ${bt??""}`),ee(Wt,Dt),ee(Jr,Tr)},[()=>x(U).type.replace("_"," "),()=>l(t(),x(U).source),()=>l(t(),x(U).target),()=>l(t(),x(U).source),()=>l(t(),x(U).target)]),xe("click",j,()=>Ut.set(null)),z(C,N)}),z(R,I)};Ze(E,R=>{i()&&R(G)})}z(_,T)},b=_=>{var T=Gg();z(_,T)};Ze(y,_=>{n()?_(m):_(b,!1)})}z(p,v)};Ze(f,p=>{t()&&p(g)})}z(r,d),vr(),a()}var Mg=X("<button> </button>"),Pg=X('<li><div class="metric-row"><button class="link-button"> </button> <span class="metric-value"> </span></div></li>'),$g=X('<li><div class="metric-row"><button class="link-button"> </button> <span class="metric-value"> </span></div></li>'),Og=X('<li><div class="metric-row"><button class="link-button"> </button> <span class="metric-value"> </span></div> <p class="metric-caption"> </p></li>'),Ug=X('<section class="analytics-panel"><div class="analytics-header"><h3>Analytics</h3> <div class="metric-toggle"></div></div> <p class="muted small"> </p> <div class="analytics-grid"><div class="analytics-card"><h4>Top Out-Degree</h4> <ol></ol></div> <div class="analytics-card"><h4>Top Strong Matchups</h4> <ol></ol></div> <div class="analytics-card"><h4>Mechanic Usage</h4> <ol></ol></div></div></section>');function Bg(r,e){pr(e,!1);const t=()=>K(Cn,"$metricMode",o),n=()=>K(mo,"$characterRankings",o),i=()=>K(yo,"$mechanicUsageRanking",o),[o,a]=_r(),s=[{value:"default",label:"Default",desc:"Static layout sizes; label-based colors."},{value:"outDegree",label:"Out-Degree",desc:"Highlights nodes with many outgoing edges."},{value:"strongCount",label:"Strong Matchups",desc:"Emphasizes characters that counter many opponents."},{value:"mechanicUsage",label:"Mechanic Usage",desc:"Rescales mechanics by usage."}];function u(T){Cn.set(T)}br();var l=Ug(),h=F(l),c=M(F(h),2);Te(c,5,()=>s,Se,(T,A)=>{var E=Mg();let G;var R=F(E);te(()=>{G=us(E,1,"toggle-button",null,G,{active:t()===x(A).value}),Ei(E,"aria-pressed",t()===x(A).value),ee(R,x(A).label)}),xe("click",E,()=>u(x(A).value)),z(T,E)});var d=M(h,2),f=F(d),g=M(d,2),p=F(g),v=M(F(p),2);Te(v,5,()=>n().outDegree.slice(0,10),Se,(T,A)=>{var E=Pg(),G=F(E),R=F(G),I=F(R),k=M(R,2),C=F(k);te(()=>{ee(I,x(A).id),ee(C,x(A).value)}),xe("click",R,()=>Rt.set(x(A).id)),z(T,E)});var y=M(p,2),m=M(F(y),2);Te(m,5,()=>n().strongCount.slice(0,10),Se,(T,A)=>{var E=$g(),G=F(E),R=F(G),I=F(R),k=M(R,2),C=F(k);te(()=>{ee(I,x(A).id),ee(C,x(A).value)}),xe("click",R,()=>Rt.set(x(A).id)),z(T,E)});var b=M(y,2),_=M(F(b),2);Te(_,5,()=>i().slice(0,10),Se,(T,A)=>{var E=Og(),G=F(E),R=F(G),I=F(R),k=M(R,2),C=F(k),U=M(G,2),N=F(U);te(()=>{ee(I,x(A).name),ee(C,x(A).usage),ee(N,`Counters: ${x(A).counter??""}`)}),xe("click",R,()=>Qt.set(x(A).name)),z(T,E)}),te(T=>ee(f,T),[()=>{var T;return(T=s.find(A=>A.value===t()))==null?void 0:T.desc}]),z(r,l),vr(),a()}var zg=X("<p>Loading graph data…</p>"),Hg=X('<p> </p> <div style="display:grid;grid-template-columns:320px 1fr;gap:1rem"><!> <section><!> <div class="details" style="background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:1rem;margin-top:1rem"><!> <!> <!></div></section></div>',1),jg=X('<div class="app"><h1>Deadlock Graph Explorer (Svelte)</h1> <!></div>');function Wg(r,e){pr(e,!1);const t=()=>K(fe,"$graphData",i),n=()=>K(ru,"$searchResults",i),[i,o]=_r(),a=$t(),s=$t();let u=$t(null);Zi(async()=>{const g=await(await fetch("graph.json",{cache:"no-store"})).json();kd(g),Ae(u,g),window.__GRAPH_DATA__=g}),mi(()=>t(),()=>{Ae(a,t())}),mi(()=>n(),()=>{Ae(s,n())}),Wa(),br();var l=jg(),h=M(F(l),2);{var c=f=>{var g=zg();z(f,g)},d=f=>{var g=Hg(),p=Et(g),v=F(p),y=M(p,2),m=F(y);yg(m,{});var b=M(m,2),_=F(b);dg(_,{get data(){return x(u)}});var T=M(_,2),A=F(T);Sg(A,{});var E=M(A,2);Ig(E,{});var G=M(E,2);Bg(G,{}),te(R=>ee(v,`Generated: ${R??""} • Nodes: ${x(a),Ye(()=>x(a).meta.node_count)??""} • Edges: ${x(a),Ye(()=>x(a).meta.edge_count)??""}`),[()=>(x(a),Ye(()=>new Date(x(a).meta.generated_at).toLocaleString()))]),z(f,g)};Ze(h,f=>{x(a)?f(d,!1):f(c)})}z(r,l),vr(),o()}new Wg({target:document.getElementById("app")});
